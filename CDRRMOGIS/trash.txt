
<?php
session_start();
include('library/form/connection.php');
include('library/function/functions.php');
$db = new db();


?>

<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="th3515">
    <meta name="author" content="@pablongbuhaymo">

    <title>Overview | City Disaster Risk Management</title>    
    <link rel="icon" href="img/favicon.ico">

    <!-- Bootstrap Core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="css/app.css" rel="stylesheet">

   <link rel="stylesheet" href="https://unpkg.com/leaflet@1.0.3/dist/leaflet.css"
    integrity="sha512-07I2e+7D8p6he1SIM+1twR5TIrhUQn9+I6yjqD53JQjFiMf8EtC93ty0/5vJTZGF8aAocvHYNEDJajGdNx1IsQ=="
   crossorigin=""/>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>

<!-- The #page-top ID is part of the scrolling feature - the data-spy and data-target are part of the built-in Bootstrap scrollspy function -->

<body id="page-top" data-spy="scroll" data-target=".navbar-fixed-top">

<?php 
include('library/html/navbar.php');
include('library/html/loginmodal.php');
    ?>


 <!--Content starts here-->

<div class="container fluid">
   
    <div class="page-header">
        <div style="margin: auto; text-align: center;" class="pull-right">
            <div class="btn-group" role="group" aria-label="...">
                <a href="#" class="btn btn-basic active">Barangays</a>
                <a href="evac.php" class="btn btn-basic">Evacuation Centers</a>   
            </div>
        </div>
        <h3>Map Overview <small>of Iloilo City</small></h3>
        </div>

            <div class="row no-pad">
                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                    <div id="map" style="height: 70vh; width: 100%;" tabindex="0"> </div>
                </div>

             
            </div>
        
    </div>
<br>
<!--FOOTER HERE-->
<?php include('library/html/footer.php'); ?>

<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
<script src="js/1.11.3_jquery.min.js"></script>
<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="js/bootstrap.min.js"></script>
<script src="js/app/mylibrary.js"></script>
<script src="js/app/loginscript.js"></script>
<script src="js/jquery.easing.min.js"></script>
<script src="https://unpkg.com/leaflet@1.0.3/dist/leaflet.js"
   integrity="sha512-A7vV8IFfih/D732iSSKi20u/ooOfj/AGehOKq0f4vLT1Zr2Y+RX7C+w8A1gaSasGtRUZpF/NZgzSAu4/Gc41Lg=="
   crossorigin=""></script>
  
</body>

</html>
<script>
 
   var map = L.map('map').setView([10.7199, 122.55417], 13);

    L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw', {
        maxZoom: 18,
        attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, ' +
            '<a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' +
            'Imagery © <a href="http://mapbox.com">Mapbox</a>',
        id: 'mapbox.light'
    }).addTo(map);

      
            barangay = L.polygon([
            [10.71965, 122.54846],
            [10.71425, 122.55481],
            [10.71543, 122.54022]
        ]).addTo(map);

          

 var info = L.control({position: 'bottomright'});

    info.onAdd = function (map) {
        this._div = L.DomUtil.create('div', 'info');
        this.update();
        return this._div;
    };

    info.update = function (props) {
        this._div.innerHTML = 
         '<button class="btn btn-primary" onclick="goToBarangay()">'+
            '<span class="glyphicon glyphicon-menu-right"></span> Barangay Details</button>';
             
    };


    info.addTo(map);

    function goToBarangay()
    {
        window.location.href  = "barangays.php";
    }

</script>





<?php
session_start();
include('library/form/connection.php');
include('library/function/functions.php');
$db = new db();

$search = isset($_GET['search']) ? $_GET['search'] : '';
$limit = 8;

$total_sql = 'SELECT 
barangay.ID, 
barangay.NAME,
district.NAME AS DISTRICT, 
city.NAME AS CITY, 
barangay_info.MEN AS MEN, 
barangay_info.WOMEN AS WOMEN
FROM (SELECT * FROM barangay WHERE barangay.NAME LIKE "%'.$search.'%") AS barangay
LEFT JOIN district ON barangay.DISTRICT = district.ID
LEFT JOIN city ON district.CITY = city.ID
LEFT JOIN barangay_info ON barangay.ID = barangay_info.BARANGAY
GROUP BY barangay.ID';

$total_result = $db->connection->query($total_sql);
$total_count = mysqli_num_rows($total_result);
$total_page = ceil($total_count/$limit);

$page = isset($_GET['page']) && $_GET['page'] > 0 && $_GET['page'] <= $total_page ? $_GET['page'] : '1';
$offset = ($page * $limit) - $limit;

if($page < 2) {
    $disable_previous = 'disabled';
    $disable_previous2 = 'pointer-events: none;';
    $bottom_page = 'display:none';
}
else {
    $disable_previous = '';
    $disable_previous2 = '';
    $bottom_page = '';
}
if($total_page < 2) {
    $top_page = 'display:none';
}
else {
    $top_page = '';
}
if($total_page == $page || $total_page < 1) {
    $disable_next = 'disabled';
    $disable_next2 = 'pointer-events: none;';
    $top_page = 'display:none';
}
else {
    $disable_next = '';
    $disable_next2 = '';
    $top_page = '';
}
?>

<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="th3515">
    <meta name="author" content="@pablongbuhaymo">

    <title>Archive | City Disaster Risk Management</title>    
    <link rel="icon" href="img/favicon.ico">

    <!-- Bootstrap Core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="css/app.css" rel="stylesheet">

   <link rel="stylesheet" href="https://unpkg.com/leaflet@1.0.3/dist/leaflet.css"
    integrity="sha512-07I2e+7D8p6he1SIM+1twR5TIrhUQn9+I6yjqD53JQjFiMf8EtC93ty0/5vJTZGF8aAocvHYNEDJajGdNx1IsQ=="
   crossorigin=""/>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>

<!-- The #page-top ID is part of the scrolling feature - the data-spy and data-target are part of the built-in Bootstrap scrollspy function -->

<body id="page-top" data-spy="scroll" data-target=".navbar-fixed-top">

<?php include('library/html/navbar.php');
       include('library/html/loginmodal.php');
    ?>

    <!--Content starts here-->

    <div class="container fluid"> 
    
    <div class = "row no-pad">
        <div class="page-header">
            <div style="margin: auto; text-align: center;" class="pull-right">
                <div class="btn-group" role="group" aria-label="...">
                    <a href="#" class="btn btn-basic active">Disaster Archive</a>
                    <a href="#" class="btn btn-basic">Disaster Prone Areas</a>  
                </div>
            </div>
            <h3>Disaster Archive <small>of Iloilo City</small></h3>
         </div>

                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                    <div id="map" style="height: 70vh; width: 100%;" tabindex="0"> </div>
                </div>

      </div>
      </div>

<br>

  

<?php include('library/html/footer.php'); ?>

    <!-- jQuery -->
    <script src="js/jquery.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="js/bootstrap.min.js"></script>
    <script src="js/jquery.easing.min.js"></script>
    <script src="js/app/mylibrary.js"></script>
    <script src="js/app/loginscript.js"></script>

    <script src="js/chart.bundle.min.js"></script>
    <script src="https://unpkg.com/leaflet@1.0.3/dist/leaflet.js"
   integrity="sha512-A7vV8IFfih/D732iSSKi20u/ooOfj/AGehOKq0f4vLT1Zr2Y+RX7C+w8A1gaSasGtRUZpF/NZgzSAu4/Gc41Lg=="
   crossorigin=""></script>
   <script type="text/javascript" src="city.js"></script>
    
</body>

</html>


<script>

   var map = L.map('map').setView([10.719950067615137, 122.554175308317468], 13);

    L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw', {
        maxZoom: 18,
        attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, ' +
            '<a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' +
            'Imagery © <a href="http://mapbox.com">Mapbox</a>',
        id: 'mapbox.light'
    }).addTo(map);

    var geojson = L.geoJson(statesData).addTo(map);


function highlightFeature(e) {
    var layer = e.target;

    layer.setStyle({
        weight: 5,
        color: '#666',
        dashArray: '',
        fillOpacity: 0.7
    });

    if (!L.Browser.ie && !L.Browser.opera && !L.Browser.edge) {
        layer.bringToFront();
    }
}

    var info = L.control();

    info.onAdd = function (map) {
        this._div = L.DomUtil.create('div', 'info');
        this.update();
        return this._div;
    };

    info.update = function (props) {
        this._div.innerHTML = '<h5> Disaster Types: '
                            <?php
                                $sql = 'SELECT * FROM disaster_type';
                                $result = $db->connection->query($sql);
                                while ($row = $result->fetch_assoc()){
                                    ?>
                                    +'<a href = "#" class="glyphicon glyphicon-stop " title = " <?php echo $row['NAME']; ?>" style="color: <?php echo $row['COLOR']; ?>; text-decoration: none;"></a>'
                                    <?php
                                }
                                +'</h5>'?>;
    };

    info.addTo(map);


    // get color depending on population density value
    function getColor(d) {
        return '#696969';
    }

    function style(feature) {
        return {
            weight: 2,
            opacity: 1,
            color: 'white',
            dashArray: '3',
            fillOpacity: 0.8,
            fillColor: getColor(feature.properties.density)
        };
    }

    function highlightFeature(e) {
        var layer = e.target;

        layer.setStyle({
            weight: 5,
            color: '#666',
            dashArray: '',
            fillOpacity: 0.7
        });

        if (!L.Browser.ie && !L.Browser.opera && !L.Browser.edge) {
            layer.bringToFront();
        }

        info.update(layer.feature.properties);
    }

    var geojson;

    function resetHighlight(e) {
        geojson.resetStyle(e.target);
        info.update();
    }

    function zoomToFeature(e) {
        map.fitBounds(e.target.getBounds());
    }

    function onEachFeature(feature, layer) {
        layer.on({
            mouseover: highlightFeature,
            mouseout: resetHighlight,
            click: zoomToFeature
        });
    }

    geojson = L.geoJson(statesData, {
        style: style,
        onEachFeature: onEachFeature
    }).addTo(map);



</script>


****************************

<?php
session_start();
include('library/form/connection.php');
include('library/function/functions.php');
$db = new db();

$search = isset($_GET['search']) ? $_GET['search'] : '';
$limit = 8;

$total_sql = 'SELECT 
barangay.ID, 
barangay.NAME,
district.NAME AS DISTRICT, 
city.NAME AS CITY, 
barangay_info.MEN AS MEN, 
barangay_info.WOMEN AS WOMEN
FROM (SELECT * FROM barangay WHERE barangay.NAME LIKE "%'.$search.'%") AS barangay
LEFT JOIN district ON barangay.DISTRICT = district.ID
LEFT JOIN city ON district.CITY = city.ID
LEFT JOIN barangay_info ON barangay.ID = barangay_info.BARANGAY
GROUP BY barangay.ID';

$total_result = $db->connection->query($total_sql);
$total_count = mysqli_num_rows($total_result);
$total_page = ceil($total_count/$limit);

$page = isset($_GET['page']) && $_GET['page'] > 0 && $_GET['page'] <= $total_page ? $_GET['page'] : '1';
$offset = ($page * $limit) - $limit;

if($page < 2) {
    $disable_previous = 'disabled';
    $disable_previous2 = 'pointer-events: none;';
    $bottom_page = 'display:none';
}
else {
    $disable_previous = '';
    $disable_previous2 = '';
    $bottom_page = '';
}
if($total_page < 2) {
    $top_page = 'display:none';
}
else {
    $top_page = '';
}
if($total_page == $page || $total_page < 1) {
    $disable_next = 'disabled';
    $disable_next2 = 'pointer-events: none;';
    $top_page = 'display:none';
}
else {
    $disable_next = '';
    $disable_next2 = '';
    $top_page = '';
}
?>

<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="th3515">
    <meta name="author" content="@pablongbuhaymo">

    <title>Overview | City Disaster Risk Management</title>    
    <link rel="icon" href="img/favicon.ico">

    <!-- Bootstrap Core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="css/app.css" rel="stylesheet">

   <link rel="stylesheet" href="https://unpkg.com/leaflet@1.0.3/dist/leaflet.css"
    integrity="sha512-07I2e+7D8p6he1SIM+1twR5TIrhUQn9+I6yjqD53JQjFiMf8EtC93ty0/5vJTZGF8aAocvHYNEDJajGdNx1IsQ=="
   crossorigin=""/>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>

<!-- The #page-top ID is part of the scrolling feature - the data-spy and data-target are part of the built-in Bootstrap scrollspy function -->

<body id="page-top" data-spy="scroll" data-target=".navbar-fixed-top">

<?php 
include('library/html/navbar.php');
include('library/html/loginmodal.php');
    ?>

<!-- Barangay Modal View -->

<!--Edit Evacuation Modal-->
<div class="modal fade" id="BrgyModalView" tabindex="-1" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title">Barangay Modal View</h4>
            </div>
            <form id="EditEvacForm" method="post" action="library/form/CdrrmoEvacEdit.php">
                <div class="modal-body">
                    <div id="EE_msgbox" tabindex="0"></div>

                    <!-- ID -->
                    <input id="EditEvacForm_ID" name="ID" type="hidden" class="form-control">

                    <!-- Evacuation Name -->
                    <div class="input-group input-group">
                        <span class="input-group-addon">Evacuation Name</span>
                        <input id="EditEvacForm_NAME" name="NAME" type="text" class="form-control">
                    </div>
                    <br />
                    
                    <!-- Barangay -->
                    <div class="input-group">
                        <span class="input-group-addon">Barangay: </span>
                        <select id="EditEvacForm_STATUS" name="BARANGAY" class="form-control">
                        </select>
                    </div>
                    <br />

                    <!-- Complete Address -->
                    <div class="input-group input-group">
                        <span class="input-group-addon">Complete Address</span>
                        <input id="EditEvacForm_ADDRESS1" name="ADDRESS1" type="text" class="form-control">
                    </div>
                    <br />

                </div>

                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                    <button type="submit" id="EditEvacForm_SUBMIT" data-loading-text="Editing Evacuation..." class="btn btn-primary">Edit</button>
                </div>

            </form>
        </div>
    </div>
</div>


 <!--Content starts here-->

<div class="container fluid">
   
    <div class="page-header">
        <div style="margin: auto; text-align: center;" class="pull-right">
            <div class="btn-group" role="group" aria-label="...">
                <a href="#" class="btn btn-basic active">Barangays</a>
                <a href="evac.php" class="btn btn-basic">Evacuation Centers</a>   
            </div>
        </div>
        <h3>Map Overview <small>of Iloilo City</small></h3>
        </div>

            <div class="row no-pad">
                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                    <div id="map" style="height: 70vh; width: 100%;" tabindex="0"> </div>
                </div>

             
            </div>
        
    </div>
<br>
<!--FOOTER HERE-->
<?php include('library/html/footer.php'); ?>

<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
<script src="js/1.11.3_jquery.min.js"></script>
<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="js/bootstrap.min.js"></script>
<script src="js/app/mylibrary.js"></script>
<script src="js/app/loginscript.js"></script>
<script src="js/jquery.easing.min.js"></script>
<script src="https://unpkg.com/leaflet@1.0.3/dist/leaflet.js"
   integrity="sha512-A7vV8IFfih/D732iSSKi20u/ooOfj/AGehOKq0f4vLT1Zr2Y+RX7C+w8A1gaSasGtRUZpF/NZgzSAu4/Gc41Lg=="
   crossorigin=""></script>
    
<script type="text/javascript" src="city.js"></script>


<script>

 

    <?php

    $list_sql='SELECT 
    barangay.ID, 
    barangay.NAME,
    district.NAME AS DISTRICT, 
    city.NAME AS CITY, 
    barangay_info.MEN AS MEN, 
    barangay_info.WOMEN AS WOMEN,
    barangay_info.AREA AS AREA,
    barangay_info.MINORS AS MINORS,
    barangay_info.ADULTS AS ADULTS,
    barangay_info.PWD AS PWD,
    barangay_info.T_HOUSES AS T_HOUSES,
    barangay_info.C_HOUSES AS C_HOUSES,
    barangay_info.L_HOUSES AS L_HOUSES,
    barangay_info.CL_HOUSES AS CL_HOUSES
    FROM (SELECT * FROM barangay WHERE barangay.NAME LIKE "%'.$search.'%") AS barangay
    LEFT JOIN barangay_info ON barangay_info.BARANGAY = barangay.ID
    LEFT JOIN district ON barangay.DISTRICT = district.ID 
    LEFT JOIN city ON district.CITY = city.ID
    GROUP BY barangay.ID
    ORDER BY barangay.NAME
    LIMIT '.$limit.' OFFSET '.$offset;
    
    $list_result = $db->connection->query($list_sql);
    $list_count = mysqli_num_rows($list_result);
    
    if($list_count < 1) {
        echo 'createmessage(4, "No results found.", false);';
    }
    else {
        while ($list_row = $list_result->fetch_assoc()) {
            $result_ID = htmlspecialchars($list_row['ID']);
            $result_NAME = htmlspecialchars($list_row['NAME']);
            $result_DISTRICT = htmlspecialchars($list_row['DISTRICT']);
            $result_CITY = htmlspecialchars($list_row['CITY']);
            $result_MEN = htmlspecialchars($list_row['MEN']);
            $result_WOMEN = htmlspecialchars($list_row['WOMEN']);
            $result_POPULATION = $result_MEN + $result_WOMEN;
            $result_AREA = htmlspecialchars($list_row['AREA']);
            $result_MINORS = htmlspecialchars($list_row['MINORS']);
            $result_ADULTS = htmlspecialchars($list_row['ADULTS']);
            $result_PWD = htmlspecialchars($list_row['PWD']);
            $result_T_HOUSES = htmlspecialchars($list_row['T_HOUSES']);
            $result_C_HOUSES = htmlspecialchars($list_row['C_HOUSES']);
            $result_L_HOUSES = htmlspecialchars($list_row['L_HOUSES']);
            $result_CL_HOUSES = htmlspecialchars($list_row['CL_HOUSES']);

        }
    }
    ?>



    var map = L.map('map').setView([10.719950067615137, 122.554175308317468], 13);

    L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw', {
        maxZoom: 18,
        attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, ' +
            '<a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' +
            'Imagery © <a href="http://mapbox.com">Mapbox</a>',
        id: 'mapbox.light'
    }).addTo(map);

    var geojson = L.geoJson(statesData).addTo(map);


function highlightFeature(e) {
    var layer = e.target;

    layer.setStyle({
        weight: 5,
        color: '#666',
        dashArray: '',
        fillOpacity: 0.7
    });

    if (!L.Browser.ie && !L.Browser.opera && !L.Browser.edge) {
        layer.bringToFront();
    }
}

    var info = L.control();

    info.onAdd = function (map) {
        this._div = L.DomUtil.create('div', 'info');
        this.update();
        return this._div;
    };

    info.update = function (props) {
        this._div.innerHTML = '<h4>Barangays in the City of Iloilo</h4>' +  (props ?
            '<b>'+ <?php

                    $sql = 'SELECT NAME FROM barangay WHERE ID = 1';
                    $result = $db->connection->query($sql);
                    $count = mysqli_num_rows($result);
                    while ($row = $result->fetch_assoc()) 
                    {
                        echo $row['NAME'];
                    }


            ?> +'</b>'
            : 'Barangay is displayed upon hover');
    };

    info.addTo(map);


    // get color depending on population density value
    function getColor(d) {
        return '#696969';
    }

    function style(feature) {
        return {
            weight: 2,
            opacity: 1,
            color: 'white',
            dashArray: '3',
            fillOpacity: 0.8,
            fillColor: getColor(feature.properties.density)
        };
    }

    function highlightFeature(e) {
        var layer = e.target;

        layer.setStyle({
            weight: 5,
            color: '#666',
            dashArray: '',
            fillOpacity: 0.7
        });

        if (!L.Browser.ie && !L.Browser.opera && !L.Browser.edge) {
            layer.bringToFront();
        }

        info.update(layer.feature.properties);
    }

    var geojson;

    function resetHighlight(e) {
        geojson.resetStyle(e.target);
        info.update();
    }

    function zoomToFeature(e) {
        map.fitBounds(e.target.getBounds());
    }

    function onEachFeature(feature, layer) {
        layer.on({
            mouseover: highlightFeature,
            mouseout: resetHighlight,
            click: zoomToFeature
        });
    }

    geojson = L.geoJson(statesData, {
        style: style,
        onEachFeature: onEachFeature
    }).addTo(map);

  var evacInfo = L.control({position: 'bottomright'});

evacInfo.onAdd = function (map) {

        var div = L.DomUtil.create('div', 'info evacInfo'),
        grades = [0, 10, 20, 50, 100, 200, 500, 1000],
        labels = [];

    // loop through our density intervals and generate a label with a colored square for each interval
      div.innerHTML +=
            '<center><h5><strong>Barangay Info</strong></h5></center>' +
            'Name: sdasdsada <br>'+
            'Area: 121212sqm <br><br>'+
            '<strong>Demographics</strong><br>Total Population: <br> Men: <br>Women: <br> Minors: <br> Adults: <br> PWD: '
            ;
    
    return div;
};


evacInfo.addTo(map);


</script>

</body>
</html>


*********************************************************

<?php
session_start();
include('library/form/connection.php');
include('library/function/functions.php');
$db = new db();

$search = isset($_GET['search']) ? $_GET['search'] : '';
$limit = 8;

$total_sql = 'SELECT 
barangay.ID, 
barangay.NAME,
district.NAME AS DISTRICT, 
city.NAME AS CITY, 
barangay_info.MEN AS MEN, 
barangay_info.WOMEN AS WOMEN
FROM (SELECT * FROM barangay WHERE barangay.NAME LIKE "%'.$search.'%") AS barangay
LEFT JOIN district ON barangay.DISTRICT = district.ID
LEFT JOIN city ON district.CITY = city.ID
LEFT JOIN barangay_info ON barangay.ID = barangay_info.BARANGAY
GROUP BY barangay.ID';

$total_result = $db->connection->query($total_sql);
$total_count = mysqli_num_rows($total_result);
$total_page = ceil($total_count/$limit);

$page = isset($_GET['page']) && $_GET['page'] > 0 && $_GET['page'] <= $total_page ? $_GET['page'] : '1';
$offset = ($page * $limit) - $limit;

if($page < 2) {
    $disable_previous = 'disabled';
    $disable_previous2 = 'pointer-events: none;';
    $bottom_page = 'display:none';
}
else {
    $disable_previous = '';
    $disable_previous2 = '';
    $bottom_page = '';
}
if($total_page < 2) {
    $top_page = 'display:none';
}
else {
    $top_page = '';
}
if($total_page == $page || $total_page < 1) {
    $disable_next = 'disabled';
    $disable_next2 = 'pointer-events: none;';
    $top_page = 'display:none';
}
else {
    $disable_next = '';
    $disable_next2 = '';
    $top_page = '';
}
?>

<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="th3515">
    <meta name="author" content="@pablongbuhaymo">

    <title>Overview | City Disaster Risk Management</title>    
    <link rel="icon" href="img/favicon.ico">

    <!-- Bootstrap Core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="css/app.css" rel="stylesheet">

   <link rel="stylesheet" href="https://unpkg.com/leaflet@1.0.3/dist/leaflet.css"
    integrity="sha512-07I2e+7D8p6he1SIM+1twR5TIrhUQn9+I6yjqD53JQjFiMf8EtC93ty0/5vJTZGF8aAocvHYNEDJajGdNx1IsQ=="
   crossorigin=""/>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>

<!-- The #page-top ID is part of the scrolling feature - the data-spy and data-target are part of the built-in Bootstrap scrollspy function -->

<body id="page-top" data-spy="scroll" data-target=".navbar-fixed-top">

<?php 
include('library/html/navbar.php');
include('library/html/loginmodal.php');
    ?>

<!-- Barangay Modal View -->

<!--Edit Evacuation Modal-->
<div class="modal fade" id="BrgyModalView" tabindex="-1" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title">Barangay Modal View</h4>
            </div>
            <form id="EditEvacForm" method="post" action="library/form/CdrrmoEvacEdit.php">
                <div class="modal-body">
                    <div id="EE_msgbox" tabindex="0"></div>

                    <!-- ID -->
                    <input id="EditEvacForm_ID" name="ID" type="hidden" class="form-control">

                    <!-- Evacuation Name -->
                    <div class="input-group input-group">
                        <span class="input-group-addon">Evacuation Name</span>
                        <input id="EditEvacForm_NAME" name="NAME" type="text" class="form-control">
                    </div>
                    <br />
                    
                    <!-- Barangay -->
                    <div class="input-group">
                        <span class="input-group-addon">Barangay: </span>
                        <select id="EditEvacForm_STATUS" name="BARANGAY" class="form-control">
                        </select>
                    </div>
                    <br />

                    <!-- Complete Address -->
                    <div class="input-group input-group">
                        <span class="input-group-addon">Complete Address</span>
                        <input id="EditEvacForm_ADDRESS1" name="ADDRESS1" type="text" class="form-control">
                    </div>
                    <br />

                </div>

                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                    <button type="submit" id="EditEvacForm_SUBMIT" data-loading-text="Editing Evacuation..." class="btn btn-primary">Edit</button>
                </div>

            </form>
        </div>
    </div>
</div>


 <!--Content starts here-->

<div class="container fluid">
   
    <div class="page-header">
        <div style="margin: auto; text-align: center;" class="pull-right">
            <div class="btn-group" role="group" aria-label="...">
                <a href="#" class="btn btn-basic active">Barangays</a>
                <a href="evac.php" class="btn btn-basic">Evacuation Centers</a>   
            </div>
        </div>
        <h3>Map Overview <small>of Iloilo City</small></h3>
        </div>

            <div class="row no-pad">
                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                    <div id="map" style="height: 70vh; width: 100%;" tabindex="0"> </div>
                </div>

             
            </div>
        
    </div>
<br>
<!--FOOTER HERE-->
<?php include('library/html/footer.php'); ?>

<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
<script src="js/1.11.3_jquery.min.js"></script>
<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="js/bootstrap.min.js"></script>
<script src="js/app/mylibrary.js"></script>
<script src="js/app/loginscript.js"></script>
<script src="js/jquery.easing.min.js"></script>
<script src="https://unpkg.com/leaflet@1.0.3/dist/leaflet.js"
   integrity="sha512-A7vV8IFfih/D732iSSKi20u/ooOfj/AGehOKq0f4vLT1Zr2Y+RX7C+w8A1gaSasGtRUZpF/NZgzSAu4/Gc41Lg=="
   crossorigin=""></script>
    
<script type="text/javascript" src="city.js"></script>


<script>

 

    <?php

    $list_sql='SELECT 
    barangay.ID, 
    barangay.NAME,
    district.NAME AS DISTRICT, 
    city.NAME AS CITY, 
    barangay_info.MEN AS MEN, 
    barangay_info.WOMEN AS WOMEN,
    barangay_info.AREA AS AREA,
    barangay_info.MINORS AS MINORS,
    barangay_info.ADULTS AS ADULTS,
    barangay_info.PWD AS PWD,
    barangay_info.T_HOUSES AS T_HOUSES,
    barangay_info.C_HOUSES AS C_HOUSES,
    barangay_info.L_HOUSES AS L_HOUSES,
    barangay_info.CL_HOUSES AS CL_HOUSES
    FROM (SELECT * FROM barangay WHERE barangay.NAME LIKE "%'.$search.'%") AS barangay
    LEFT JOIN barangay_info ON barangay_info.BARANGAY = barangay.ID
    LEFT JOIN district ON barangay.DISTRICT = district.ID 
    LEFT JOIN city ON district.CITY = city.ID
    GROUP BY barangay.ID
    ORDER BY barangay.NAME
    LIMIT '.$limit.' OFFSET '.$offset;
    
    $list_result = $db->connection->query($list_sql);
    $list_count = mysqli_num_rows($list_result);
    
    if($list_count < 1) {
        echo 'createmessage(4, "No results found.", false);';
    }
    else {
        while ($list_row = $list_result->fetch_assoc()) {
            $result_ID = htmlspecialchars($list_row['ID']);
            $result_NAME = htmlspecialchars($list_row['NAME']);
            $result_DISTRICT = htmlspecialchars($list_row['DISTRICT']);
            $result_CITY = htmlspecialchars($list_row['CITY']);
            $result_MEN = htmlspecialchars($list_row['MEN']);
            $result_WOMEN = htmlspecialchars($list_row['WOMEN']);
            $result_POPULATION = $result_MEN + $result_WOMEN;
            $result_AREA = htmlspecialchars($list_row['AREA']);
            $result_MINORS = htmlspecialchars($list_row['MINORS']);
            $result_ADULTS = htmlspecialchars($list_row['ADULTS']);
            $result_PWD = htmlspecialchars($list_row['PWD']);
            $result_T_HOUSES = htmlspecialchars($list_row['T_HOUSES']);
            $result_C_HOUSES = htmlspecialchars($list_row['C_HOUSES']);
            $result_L_HOUSES = htmlspecialchars($list_row['L_HOUSES']);
            $result_CL_HOUSES = htmlspecialchars($list_row['CL_HOUSES']);

        }
    }
    ?>



    var map = L.map('map').setView([10.719950067615137, 122.554175308317468], 13);

    L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw', {
        maxZoom: 18,
        attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, ' +
            '<a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' +
            'Imagery © <a href="http://mapbox.com">Mapbox</a>',
        id: 'mapbox.light'
    }).addTo(map);

    var geojson = L.geoJson(statesData).addTo(map);


function highlightFeature(e) {
    var layer = e.target;

    layer.setStyle({
        weight: 5,
        color: '#666',
        dashArray: '',
        fillOpacity: 0.7
    });

    if (!L.Browser.ie && !L.Browser.opera && !L.Browser.edge) {
        layer.bringToFront();
    }
}

    var info = L.control();

    info.onAdd = function (map) {
        this._div = L.DomUtil.create('div', 'info');
        this.update();
        return this._div;
    };

    info.update = function (props) {
        this._div.innerHTML = '<h4>Barangays in the City of Iloilo</h4>' +  (props ?
            '<b>' + props.NAME_3 + '</b>'
            : 'Barangay is displayed upon hover');
    };

    info.addTo(map);


    // get color depending on population density value
    function getColor(d) {
        return '#696969';
    }

    function style(feature) {
        return {
            weight: 2,
            opacity: 1,
            color: 'white',
            dashArray: '3',
            fillOpacity: 0.8,
            fillColor: getColor(feature.properties.density)
        };
    }

    function highlightFeature(e) {
        var layer = e.target;

        layer.setStyle({
            weight: 5,
            color: '#666',
            dashArray: '',
            fillOpacity: 0.7
        });

        if (!L.Browser.ie && !L.Browser.opera && !L.Browser.edge) {
            layer.bringToFront();
        }

        info.update(layer.feature.properties);
    }

    var geojson;

    function resetHighlight(e) {
        geojson.resetStyle(e.target);
        info.update();
    }

    function zoomToFeature(e) {
        map.fitBounds(e.target.getBounds());
    }

    function onEachFeature(feature, layer) {
        layer.on({
            mouseover: highlightFeature,
            mouseout: resetHighlight,
            click: zoomToFeature
        });
    }

    geojson = L.geoJson(statesData, {
        style: style,
        onEachFeature: onEachFeature
    }).addTo(map);

  var evacInfo = L.control({position: 'bottomright'});

evacInfo.onAdd = function (map) {

        var div = L.DomUtil.create('div', 'info evacInfo'),
        grades = [0, 10, 20, 50, 100, 200, 500, 1000],
        labels = [];

    // loop through our density intervals and generate a label with a colored square for each interval
      div.innerHTML +=
            '<center><h5><strong>Barangay Info</strong></h5></center>' +
            'Name: sdasdsada <br>'+
            'Area: 121212sqm <br><br>'+
            '<strong>Demographics</strong><br>Total Population: <br> Men: <br>Women: <br> Minors: <br> Adults: <br> PWD: '
            ;
    
    return div;
};


evacInfo.addTo(map);


</script>

</body>
</html>


**********************************************

<!-- pass not updated. area probably still returns value @ php -->
<!-- i added only location reload == lazy -->

<?php
session_start();
include ('library/form/AdminOnly.php');
include('library/form/connection.php');
include('library/function/functions.php');
$db = new db();

$search = isset($_GET['search']) ? $_GET['search'] : '';
$limit = 10;

$total_sql = 'SELECT 
barangay.ID, 
barangay.NAME,
district.NAME AS DISTRICT, 
city.NAME AS CITY, 
barangay_info.AREA AS AREA
FROM (SELECT * FROM barangay WHERE barangay.NAME LIKE "%'.$search.'%") AS barangay
LEFT JOIN district ON barangay.DISTRICT = district.ID
LEFT JOIN city ON district.CITY = city.ID
LEFT JOIN barangay_info ON barangay.ID = barangay_info.BARANGAY
GROUP BY barangay.ID';

$total_result = $db->connection->query($total_sql);
$total_count = mysqli_num_rows($total_result);
$total_page = ceil($total_count/$limit);

$page = isset($_GET['page']) && $_GET['page'] > 0 && $_GET['page'] <= $total_page ? $_GET['page'] : '1';
$offset = ($page * $limit) - $limit;

if($page < 2) {
    $disable_previous = 'disabled';
    $disable_previous2 = 'pointer-events: none;';
    $bottom_page = 'display:none';
}
else {
    $disable_previous = '';
    $disable_previous2 = '';
    $bottom_page = '';
}
if($total_page < 2) {
    $top_page = 'display:none';
}
else {
    $top_page = '';
}
if($total_page == $page || $total_page < 1) {
    $disable_next = 'disabled';
    $disable_next2 = 'pointer-events: none;';
    $top_page = 'display:none';
}
else {
    $disable_next = '';
    $disable_next2 = '';
    $top_page = '';
}
?>

<html lang="en">
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="th3515">
    <meta name="author" content="@pablongbuhaymo">

    <title>Manage Barangays | City Disaster Risk Management</title>    
    <link rel="icon" href="img/favicon.ico">

    <!-- Bootstrap Core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="css/app.css" rel="stylesheet">

   <link rel="stylesheet" href="https://unpkg.com/leaflet@1.0.3/dist/leaflet.css"
    integrity="sha512-07I2e+7D8p6he1SIM+1twR5TIrhUQn9+I6yjqD53JQjFiMf8EtC93ty0/5vJTZGF8aAocvHYNEDJajGdNx1IsQ=="
   crossorigin=""/>



    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>
<body role="document">

<!-- Modals -->

<!-- Add Barangay Modal -->
<div class="modal fade" id="AddBarangayModal" tabindex="-1" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title">Enable a Barangay</h4>
            </div>
            
            <!-- Add Barangay Form -->
            <form id="AddBarangayForm" method="post" action="library/form/AddBarangayForm.php">
                <div class="modal-body">
                    <div id="AB_msgbox" tabindex="0"></div>
                    
                    <!-- MAP SOON HERE-->
                    
                    
                    <!-- Infomation -->
                    <div class="panel panel-default">
                        <div class="panel-heading">Information</div>
                        <div class="panel-body">
                            
                            <!-- NAME -->
                            <div class="input-group">
                                <span class="input-group-addon" id="sizing-addon1">Barangay: </span>
                                <select class="form-control" id="AddBarangayForm_NAME" name="NAME">
                                    <?php
                                    $barangay_sql = "SELECT * FROM barangay ORDER BY NAME";
                                    $barangay_result = $db->connection->query($barangay_sql);
                                    while($barangay_row = $barangay_result->fetch_assoc()) {
                                        ?>
                                        <option value="<?php echo $barangay_row["ID"]; ?>" id="add_district_<?php echo $district_row["ID"]; ?>"><?php echo $barangay_row["NAME"]; ?></option>
                                        <?php
                                    }
                                    ?>
                                </select>
                            </div>
                            <br />

                            
                            <!-- District -->
                            <div class="input-group">
                                <span class="input-group-addon" id="sizing-addon1">District: </span>
                                <select class="form-control" id="AddBarangayForm_DISTRICT" name="DISTRICT">
                                    <?php
                                    $district_sql = "SELECT * FROM district ORDER BY NAME";
                                    $district_result = $db->connection->query($district_sql);
                                    while($district_row = $district_result->fetch_assoc()) {
                                        ?>
                                        <option value="<?php echo $district_row["ID"]; ?>" id="add_district_<?php echo $district_row["ID"]; ?>"><?php echo $district_row["NAME"]; ?></option>
                                        <?php
                                    }
                                    ?>
                                </select>
                            </div>
                            <br />

                            <!-- City -->
                            <div class="input-group">
                                <span class="input-group-addon" id="sizing-addon1">City: </span>
                                <select class="form-control" id="AddBarangayForm_CITY" name="CITY">
                                    <?php
                                    $city_sql = "SELECT * FROM city ORDER BY NAME";
                                    $city_result = $db->connection->query($city_sql);
                                    while($city_row = $city_result->fetch_assoc()) {
                                        ?>
                                        <option value="<?php echo $city_row["ID"]; ?>" id="add_district_<?php echo $district_row["ID"]; ?>"><?php echo $city_row["NAME"]; ?></option>
                                        <?php
                                    }
                                    ?>
                                </select>
                            </div>
                            <br />
                            
                        </div>

                    </div>


                     <div class="panel panel-default">
                        <div class="panel-heading">Location</div>
                        <div class="panel-body">
                                    
                    <div class="input-group">
                        <span class="input-group-addon" id="basicasdsaasdon1"><span class="glyphicon glyphicon-pushpin"></span></span>
                        <div class="form-control" style="width: 100%; height:300px;">
                            <div id="map"></div>
                        </div>
                    </div>

                        </div>
                    </div>


                    <small> *Demographics are provided after enabling the barangay </small>
                    
                </div>
                
                <!-- Submission -->
                <div class="modal-footer">
                    <button type="submit" id="AddBarangayForm_SUBMIT" data-loading-text="Adding Barangay..." class="btn btn-primary">Add Barangay</button>
                    <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                </div>
                
            </form>
            
        </div>
    </div>
</div>

<!-- Update Barrangay Modal -->
<div class="modal fade" id="UpdateBarangayModal" tabindex="-1" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title">Update Barangay</h4>
            </div>

            <!-- Update Barangay Form -->
            <form id="UpdateBarangayForm" method="post" action="library/form/UpdateBarangayForm.php">
                <div class="modal-body">
                    <div id="UB_msgbox" tabindex="0"></div>
                    
                    <input type="hidden" id="UpdateBarangayForm_ID" name="ID" required />
                    <!-- Infomation -->
                    <div class="panel panel-default">
                        <div class="panel-heading">Information</div>
                        <div class="panel-body">
                        
                            <!-- Name -->
                            <div class="input-group">
                                <span class="input-group-addon" id="sizing-addon1">Name: </span>
                                <input type="text" id="UpdateBarangayForm_NAME" name="NAME" maxlength="50" class="form-control" required />
                            </div>
                            <br />
                            
                            <!-- District -->
                            <div class="input-group">
                                <span class="input-group-addon" id="sizing-addon1">District: </span>
                                <select class="form-control" id="UpdateBarangayForm_DISTRICT" name="DISTRICT">
                                    <?php
                                    $district_sql = "SELECT * FROM district ORDER BY NAME";
                                    $district_result = $db->connection->query($district_sql);
                                    while($district_row = $district_result->fetch_assoc()) {
                                        ?>
                                        <option value="<?php echo $district_row["ID"]; ?>" id="add_district_<?php echo $district_row["ID"]; ?>"><?php echo $district_row["NAME"]; ?></option>
                                        <?php
                                    }
                                    ?>
                                </select>
                            </div>
                            <br />
                        </div>
                    </div>
                        
                </div>
                    
                <!-- Submission -->
                <div class="modal-footer">
                    <button type="submit" id="UpdateBarangayForm_SUBMIT" data-loading-text="Updating Barangay..." class="btn btn-primary">Update Barangay</button>
                    <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Update Barrangay Info Modal -->
<div class="modal fade" id="UpdateBarangayModal2" tabindex="-1" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title">Update Barangay Information</h4>
            </div>
                
            <!-- Update Barangay Form 2-->
            <form id="UpdateBarangayForm2" method="post" action="library/form/UpdateBarangayForm2.php">
                <div class="modal-body">
                    <div id="UB_msgbox2" tabindex="0"></div>
                    
                    <!-- ID -->
                    <input type="hidden" id="UpdateBarangayForm2_ID" name="ID" required />                  
                    
                    <!-- Men -->
                    <div class="input-group">
                        <span class="input-group-addon" id="sizing-addon1">Men: </span>
                        <input type="number" id="UpdateBarangayForm_MEN" name="MEN" value=0 maxlength="5" class="form-control" />
                    </div>
                    <br />
                    
                    <!-- Women -->
                    <div class="input-group">
                        <span class="input-group-addon" id="sizing-addon1">Women: </span>
                        <input type="number" id="UpdateBarangayForm_WOMEN" name="WOMEN" value=0 maxlength="5" class="form-control" />
                    </div>
                    <br />
                    
                    <!-- Minors -->
                    <div class="input-group">
                        <span class="input-group-addon" id="sizing-addon1">Minors: </span>
                        <input type="number" id="UpdateBarangayForm_MINORS" name="MINORS" value=0 maxlength="5" class="form-control" />
                    </div>
                    <br />
                    
                    <!-- Adults -->
                    <div class="input-group">
                        <span class="input-group-addon" id="sizing-addon1">Adults: </span>
                        <input type="number" id="UpdateBarangayForm_ADULTS" name="ADULTS" value=0 maxlength="5" class="form-control" />
                    </div>
                    <br />
                
                    <!-- PWD -->
                    <div class="input-group">
                        <span class="input-group-addon" id="sizing-addon1">PWDs: </span>
                        <input type="number" id="UpdateBarangayForm_PWD" name="PWD" value=0 maxlength="5" class="form-control" />
                    </div>
                    <br />
                            
                    <!-- Concrete Houses -->
                    <div class="input-group">
                        <span class="input-group-addon" id="sizing-addon1">Concrete: </span>
                        <input type="number" id="UpdateBarangayForm_CONCRETE" name="CONCRETE" value=0 maxlength="5" class="form-control" />
                    </div>
                    <br />

                    <!-- Light Houses -->
                    <div class="input-group">
                        <span class="input-group-addon" id="sizing-addon1">Light: </span>
                        <input type="number" id="UpdateBarangayForm_LIGHT" name="LIGHT" value=0 maxlength="5" class="form-control" />
                    </div>
                    <br />

                    <!-- Both Houses -->
                    <div class="input-group">
                        <span class="input-group-addon" id="sizing-addon1">Both: </span>
                        <input type="number" id="UpdateBarangayForm_BOTH" name="BOTH" value=0 maxlength="5" class="form-control" />
                    </div>
                    <br />

                    <!-- Area -->
                    <div class="input-group">
                        <span class="input-group-addon" id="sizing-addon1">Area: </span>
                        <input type="double" id="UpdateBarangayForm_AREA" name="AREA" value=0 maxlength="30"  class="form-control" />
                    </div>
                    <br />
                </div>
                
                <!-- Submission -->
                <div class="modal-footer">
                    <button type="submit" id="UpdateBarangayForm_SUBMIT2" data-loading-text="Updating Barangay..." class="btn btn-primary">Update Barangay</button>
                    <a href="#" class="btn btn-default" id="UpdateBarangayForm_INFO">View Data</a>
                    <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                </div>
            
            </form>
        </div>
    </div>
</div>


<!-- Delete Barangay Modal -->

<div class="modal fade" id="deleteBarangayModal" tabindex="-1" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
                <h4 class="modal-title">Delete Barangay</h4>
            </div>
            <form id="deleteBarangayForm" method="post" action="library/form/deleteBarangay.php">
                <div class="modal-body">
                    <div id="deleteBarangayForm_msgbox" tabindex="0"></div>
                    <div><input type="text" id="deleteBarangayForm_ID" name="ID" style="display: none;"></div>
                    <h3 id = "deleteBarangayFormDetails"></h3>
                    <hr>
                    <a href="#" class="btn btn-default" id="deleteBarangayForm_VIEWDATA"><span class="glyphicon glyphicon-new-window"></span> View Data</a>
                </div>
                <div class="modal-footer">
                    <button type="submit" id="deleteBarangayForm_submit" class="btn btn-danger" data-loading-text="Deleting..."><span class="glyphicon glyphicon-trash"></span> Delete</button>
                    <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- MAP MODAL -->

<div class="modal fade" id="mapModal" tabindex="-1" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
                <h4 class="modal-title">Delete Barangay</h4>
            </div>
            <form id="deleteBarangayForm" method="post" action="library/form/deleteBarangay.php">
                <div class="modal-body">
                    <div id="deleteBarangayForm_msgbox" tabindex="0"></div>
                    <div><input type="text" id="deleteBarangayForm_ID" name="ID" style="display: none;"></div>
                    <h3 id = "deleteBarangayFormDetails"></h3>
                    <hr>
                    <a href="#" class="btn btn-default" id="deleteBarangayForm_VIEWDATA"><span class="glyphicon glyphicon-new-window"></span> View Data</a>
                </div>
                <div class="modal-footer">
                    <button type="submit" id="deleteBarangayForm_submit" class="btn btn-danger" data-loading-text="Deleting..."><span class="glyphicon glyphicon-trash"></span> Delete</button>
                    <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                </div>
            </form>
        </div>
    </div>
</div>




<!-- Content starts here -->
<?php include('library/html/navbar.php'); ?>

<div class="container">
    <div class="page-header">
    <span class = "pull-right">
              <button class="btn btn-success dbSync"><span class="glyphicon glyphicon-download-alt"></span> &nbsp; Run Database Sync</button>
              <button class="btn btn-basic" onclick="location.href='AddBarangay.php'"><span class="glyphicon glyphicon-plus"></span> &nbsp; Add new Barangay</button>
        </span>
        <h3>Barangay Management</h3>
    </div>
    
    <!-- Barangay Search Bar -->
    <div class="row">
        <div class="col-md-6 col-md-offset-3">
            <form id="SearchForm" method="get">
                <div class="input-group">
                    <input id="SearchInput" name="search" type="text" class="form-control" placeholder="Search.." value="<?php echo $search; ?>" />
                    <span class="input-group-btn">
                        <button id="SearchSubmit" class="btn btn-secondary" type="submit"><span class="glyphicon glyphicon-search"></span>&nbsp Search</button>
                    </span>
                </div>
            </form>
        </div>
    </div>
    
    <!-- Barangay List -->
    <table class="table table-striped table-hover">
        <thead>
        <tr>
            <th>Name</th>
            <th>District</th>
            <th>City</th>
            <th>View Data</th>
            <th>Actions</th>
        </tr>
        </thead>
        <tbody id="PageComponent_BRLIST">
        </tbody>
    </table>
    <div id="pagemessagebox" tabindex="0"></div>
    
    <!-- Pagination -->
    <ul class="pager">
        <li style="<?php echo $bottom_page; ?>">
            <a href="BarangayManagement.php?search=<?php echo $search; ?>&page=1" style=""><span class="glyphicon glyphicon-menu-left"></span>&nbsp 1</a>
        </li>
        <li class="<?php echo $disable_previous; ?>">
            <a href="BarangayManagement.php?search=<?php echo $search; ?>&page=<?php echo $page - 1; ?>" style="<?php echo $disable_previous2; ?>"><span class="glyphicon glyphicon-menu-left"></span>&nbsp Previous</a>
        </li>
        <li class="disabled">
            <span><h4 style="margin-top: 0.3rem; margin-bottom: 0.3rem;">Page <?php echo $page; ?></h4></span>
        </li>
        <li class="<?php echo $disable_next; ?>">
            <a href="BarangayManagement.php?search=<?php echo $search; ?>&page=<?php echo $page + 1; ?>" style="<?php echo $disable_next2; ?>">Next&nbsp <span class="glyphicon glyphicon-menu-right"></span></a>
        </li>
        <li style="<?php echo $top_page; ?>">
            <a href="BarangayManagement.php?search=<?php echo $search; ?>&page=<?php echo $total_page; ?>" style=""><?php echo $total_page; ?>&nbsp <span class="glyphicon glyphicon-menu-right"></span></a>
        </li>
    </ul>
</div>


<?php include('library/html/footer.php'); ?>

<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
<script src="js/1.11.3_jquery.min.js"></script>
<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="js/bootstrap.min.js"></script>
<script src="js/app/mylibrary.js"></script>
<script src="js/app/messagealert.js"></script>
<script src="js/jquery.datetimepicker.full.min.js"></script>
<script src="js/jquery.form.min.js"></script>
<script src="js/chart.bundle.min.js"></script>
<script src="https://unpkg.com/leaflet@1.0.3/dist/leaflet.js"
   integrity="sha512-A7vV8IFfih/D732iSSKi20u/ooOfj/AGehOKq0f4vLT1Zr2Y+RX7C+w8A1gaSasGtRUZpF/NZgzSAu4/Gc41Lg=="
   crossorigin=""></script>

<script type="text/javascript" src="city.js"></script>

<script>

    $(".dbSync").click(function(){
       var response = confirm("Are you sure you want to run a Database Sync?!");
       if(response == true){

        $.ajax({url: "library/form/BrgyInfoUpdate.php", success: function(result){
            alert('Succesfly sync from Barangay Database');
            location.reload();
            }});
        }
        else
        {
            alert('Database sync Canceled');
        }
        });

</script>


<!-- Page Script -->
<script>
    var PageComponent = {
        brlist: document.getElementById('PageComponent_BRLIST')
    };
    
    var ABForm = { 
        form: document.getElementById('AddBarangayForm'),
        name: document.getElementById('AddBarangayForm_NAME'),
        district: document.getElementById('AddBarangayForm_DISTRICT'),
        men: document.getElementById('AddBarangayForm_MEN'),
        women: document.getElementById('AddBarangayForm_WOMEN'),
        minors: document.getElementById('AddBarangayForm_MINORS'),
        adults: document.getElementById('AddBarangayForm_ADULTS'),
        pwd: document.getElementById('AddBarangayForm_PWD'),
        light: document.getElementById('AddBarangayForm_LIGHT'),
        concrete: document.getElementById('AddBarangayForm_CONCRETE'),
        both: document.getElementById('AddBarangayForm_BOTH'),
        area: document.getElementById('AddBarangayForm_AREA'),
        submit : '#AddBarangayForm_SUBMIT',
        modal: '#AddBarangayModal',
        msgbox: 'AB_msgbox'
    };
        
    function ResetABForm() {
        ABForm.name.value = '';
        ABForm.district.selectedIndex = 0;
        ABForm.men.value = 0;
        ABForm.women.value = 0;
        ABForm.minors.value = 0;
        ABForm.adults.value = 0;
        ABForm.pwd.value = 0;
    }

    //Async New Barangay Submit 
    ABForm.form.onsubmit = function(e) {
        e.preventDefault();
        $(this).ajaxSubmit({
            beforeSend:function()
            {
                $(ABForm.submit).button('loading');
            },
            uploadProgress:function(event,position,total,percentCompelete)
            {

            },
            success:function(data)
            {
                $(ABForm.submit).button('reset');
                var server_message = data.trim();
                
                if(!isWhitespace(GetSuccessMsg(server_message)))
                {
                    createmessagein(1, 'Successfully added barangay!', ABForm.msgbox);
                    
                    location.reload();
                    ResetABForm();

                }
                else if(!isWhitespace(GetWarningMsg(server_message)))
                {
                    createmessagein(2, GetWarningMsg(server_message), ABForm.msgbox);
                }
                else if(!isWhitespace(GetErrorMsg(server_message)))
                {
                    createmessagein(3, GetErrorMsg(server_message), ABForm.msgbox);
                }
                else if(!isWhitespace(GetServerMsg(server_message)))
                {
                    createmessagein(4, GetServerMsg(server_message), ABForm.msgbox);
                }
                else
                {
                    createmessagein(3, '<b>Oh Snap!</b> There is a problem with the server or your connection.', ABForm.msgbox);
                }
            }
        });
    };


    
    //Add barangay to list. 

    function AddBarangay(id, name, district, city, men, women, population, minors, adults, pwd, t_houses, c_houses, l_houses, cl_houses, area) {
        PageComponent.brlist.innerHTML = PageComponent.brlist.innerHTML +
            '<tr>' +
            '   <td id="Barangay_name_' + id + '">' + name + '</td>'+
            '   <td id="Barangay_district_' + id + '">' + district + '</td>'+
            '   <td id="Barangay_city_' + id + '">' + city + '</td>'+
            '   <td class = "hidden" id="Barangay_men_' + id + '">' + men + '</td>'+
            '   <td class = "hidden" id="Barangay_women_' + id + '">' + women + '</td>'+
            '   <td class = "hidden" id="Barangay_population_' + id + '">' + population + '</td>'+
            '   <td class = "hidden" id="Barangay_minors_' + id + '">' + minors + '</td>'+
            '   <td class = "hidden" id="Barangay_adults_' + id + '">' + adults + '</td>'+
            '   <td class = "hidden" id="Barangay_pwd_' + id + '">' + pwd + '</td>'+
            '   <td class = "hidden" id="Barangay_t_houses_' + id + '">' + t_houses + '</td>'+
            '   <td class = "hidden" id="Barangay_c_houses_' + id + '">' + c_houses + '</td>'+
            '   <td class = "hidden" id="Barangay_l_houses_' + id + '">' + l_houses + '</td>'+
            '   <td class = "hidden" id="Barangay_cl_houses_' + id + '">' + cl_houses + '</td>'+            
            '   <td class = "hidden" id="Barangay_area_' + id + '" value="' + id + '">' + area +'</td>'+
            '   <td><div class="btn-group"><button id="Barangay_BTN_' + id + '" value="' + id + '" class="btn btn-default" onclick="viewData(\'' + id + '\')"><span class="glyphicon glyphicon glyphicon-new-window"></span>&nbspView</button><input type="hidden" class="btn" /></div></td>'+
            '   <td><div class="btn-group"><button id="Barangay_BTN_' + id + '" value="' + id + '" class="btn btn-default" data-toggle="modal" data-target="#UpdateBarangayModal" onclick="UpdateFill(\'' + id + '\')"><span class="glyphicon glyphicon-pencil"></span>&nbspEdit</button><input type="hidden" class="btn" /></div>'+
            '   <form style="margin:0px" class="btn-group" id="UpdateBarangayMapForm" method="post" action="#"><input type="hidden" class="btn" name="BARANGAY" value="'+id+'" /><button type="submit" value="'+id+'" id="UpdateBarangayMapForm_SUBMIT" class="btn btn-default"><span class="glyphicon glyphicon-map-marker"></span>&nbspUpdate Map</button></form>'+
            '   <div class="btn-group"><input type="hidden" class="btn" /><button id="Barangay_BTN_' + id + '2" value="' + id + '" class="btn btn-basic" data-toggle="modal" data-target="#deleteBarangayModal" onclick="deleteFill(\'' + id + '\')"><span class="glyphicon glyphicon-trash"></span>&nbspDisable</button><input type="hidden" class="btn" /></div>'+
            '</tr>';
    }

    
        
    //Fill disaster type table
    <?php
    $list_sql='SELECT 
    barangay.ID, 
    barangay.NAME,
    district.NAME AS DISTRICT, 
    city.NAME AS CITY, 
    barangay_info.MEN AS MEN, 
    barangay_info.WOMEN AS WOMEN,
    barangay_info.AREA AS AREA,
    barangay_info.MINORS AS MINORS,
    barangay_info.ADULTS AS ADULTS,
    barangay_info.PWD AS PWD,
    barangay_info.T_HOUSES AS T_HOUSES,
    barangay_info.C_HOUSES AS C_HOUSES,
    barangay_info.L_HOUSES AS L_HOUSES,
    barangay_info.CL_HOUSES AS CL_HOUSES
    FROM (SELECT * FROM barangay WHERE barangay.NAME LIKE "%'.$search.'%") AS barangay
    LEFT JOIN barangay_info ON barangay_info.BARANGAY = barangay.ID
    LEFT JOIN district ON barangay.DISTRICT = district.ID 
    LEFT JOIN city ON district.CITY = city.ID
    GROUP BY barangay.ID
    ORDER BY barangay.NAME
    LIMIT '.$limit.' OFFSET '.$offset;
    
    $list_result = $db->connection->query($list_sql);
    $list_count = mysqli_num_rows($list_result);
    
    if($list_count < 1) {
        echo 'createmessage(4, "No results found.", false);';
    }
    else {
        while ($list_row = $list_result->fetch_assoc()) {
            $result_ID = htmlspecialchars($list_row['ID']);
            $result_NAME = htmlspecialchars($list_row['NAME']);
            $result_DISTRICT = htmlspecialchars($list_row['DISTRICT']);
            $result_CITY = htmlspecialchars($list_row['CITY']);
            $result_MEN = htmlspecialchars($list_row['MEN']);
            $result_WOMEN = htmlspecialchars($list_row['WOMEN']);
            $result_POPULATION = $result_MEN + $result_WOMEN;
            $result_AREA = htmlspecialchars($list_row['AREA']);
            $result_MINORS = htmlspecialchars($list_row['MINORS']);
            $result_ADULTS = htmlspecialchars($list_row['ADULTS']);
            $result_PWD = htmlspecialchars($list_row['PWD']);
            $result_T_HOUSES = htmlspecialchars($list_row['T_HOUSES']);
            $result_C_HOUSES = htmlspecialchars($list_row['C_HOUSES']);
            $result_L_HOUSES = htmlspecialchars($list_row['L_HOUSES']);
            $result_CL_HOUSES = htmlspecialchars($list_row['CL_HOUSES']);
    ?>
    AddBarangay(<?php echo $result_ID; ?>, '<?php echo $result_NAME; ?>', '<?php echo $result_DISTRICT; ?>', '<?php echo $result_CITY; ?>', '<?php echo $result_MEN; ?>', '<?php echo $result_WOMEN; ?>', '<?php echo $result_POPULATION; ?>', '<?php echo $result_MINORS; ?>', '<?php echo $result_ADULTS; ?>', '<?php echo $result_PWD; ?>', '<?php echo $result_T_HOUSES; ?>', '<?php echo $result_C_HOUSES; ?>', '<?php echo $result_L_HOUSES; ?>', '<?php echo $result_CL_HOUSES; ?>', <?php echo $result_AREA; ?>);
    <?php
        }
    }
    ?>

</script>

<!-- MAP SCRIPTS -->

<script>



</script>



<!-- UPDATE BARANGAY -->

<script>

    var UBForm = {
        form: document.getElementById('UpdateBarangayForm'),
        id: document.getElementById('UpdateBarangayForm_ID'),
        name: document.getElementById('UpdateBarangayForm_NAME'),
        district: document.getElementById('UpdateBarangayForm_DISTRICT'),
        submit : '#UpdateBarangayForm_SUBMIT',
        modal: '#UpdateBarangayModal',
        msgbox: 'UB_msgbox'
    };

    var UBForm2 = {
        form: document.getElementById('UpdateBarangayForm2'),
        id: document.getElementById('UpdateBarangayForm2_ID'),
        men: document.getElementById('UpdateBarangayForm_MEN'),
        women: document.getElementById('UpdateBarangayForm_WOMEN'),
        minors: document.getElementById('UpdateBarangayForm_MINORS'),
        adults: document.getElementById('UpdateBarangayForm_ADULTS'),
        pwd: document.getElementById('UpdateBarangayForm_PWD'),
        light: document.getElementById('UpdateBarangayForm_LIGHT'),
        concrete: document.getElementById('UpdateBarangayForm_CONCRETE'),
        both: document.getElementById('UpdateBarangayForm_BOTH'),
        area: document.getElementById('UpdateBarangayForm_AREA'),
        infoBtn: document.getElementById('UpdateBarangayForm_INFO'),
        submit : '#UpdateBarangayForm_SUBMIT2',
        modal: '#UpdateBarangayModal2',
        msgbox: 'UB_msgbox2'
    };



    function UpdateBarangay(id, name, district) {
        document.getElementById('Barangay_name_' + id).innerHTML = name;
        document.getElementById('Barangay_district_' + id).innerHTML = district;
    }



    //Fills forms when edit buttons are clicked
    function UpdateFill(id) {
        var name = document.getElementById('Barangay_name_' + id).innerHTML;
        var district = document.getElementById('Barangay_district_' + id).innerHTML;
        for(var i = 0; i < UBForm.district.options.length; i++) {
            if(UBForm.district.options[i].text == district) {
                UBForm.district.selectedIndex = i;
            }
        }
        UBForm.name.value = name;
        UBForm.id.value = id;
    }


    function UpdateFill2(id) {
        var currentBarangay = document.getElementById('Barangay_name_' + id).innerHTML;
        var currentDistrict = document.getElementById('Barangay_district_' + id).innerHTML;
        var currentCity = document.getElementById('Barangay_city_' + id).innerHTML;
        var currentMen = document.getElementById('Barangay_men_' + id).innerHTML;
        var currentWomen = document.getElementById('Barangay_women_' + id).innerHTML;
        var currentArea = document.getElementById('Barangay_area_' + id).innerHTML;
        var currentPopulation = document.getElementById('Barangay_population_' + id).innerHTML;
        var currentMinors = document.getElementById('Barangay_minors_' + id).innerHTML;
        var currentAdults = document.getElementById('Barangay_adults_' + id).innerHTML;
        var currentPWD = document.getElementById('Barangay_pwd_' + id).innerHTML;
        var currentT_houses = document.getElementById('Barangay_t_houses_' + id).innerHTML;
        var currentC_houses = document.getElementById('Barangay_c_houses_' + id).innerHTML;
        var currentL_houses = document.getElementById('Barangay_l_houses_' + id).innerHTML;
        var currentCL_houses = document.getElementById('Barangay_cl_houses_' + id).innerHTML;

        UBForm2.men.value = currentMen;
        UBForm2.women.value = currentWomen;
        UBForm2.minors.value = currentMinors;
        UBForm2.adults.value = currentAdults;
        UBForm2.pwd.value = currentPWD;
        UBForm2.light.value = currentL_houses;
        UBForm2.concrete.value = currentC_houses;
        UBForm2.both.value = currentCL_houses;
        UBForm2.area.value = currentArea;
        UBForm2.id.value = id;
        UBForm2.infoBtn.href = "brgyinfo.php?b=" + id;
    }


        //Async Update Barangay Submit 
    UBForm.form.onsubmit = function(e) {
        e.preventDefault();
        
        $(this).ajaxSubmit({
            beforeSend:function()
            {
                $(UBForm.submit).button('loading');
            },
            uploadProgress:function(event,position,total,percentCompelete)
            {

            },
            success:function(data)
            {
                $(UBForm.submit).button('reset');
                var server_message = data.trim();
                
                if(!isWhitespace(server_message == "success")
                {
                    createmessagein(1, 'Successfully updated barangay!', UBForm.msgbox);
                    
                    UpdateBarangay(GetSuccessMsg(server_message), UBForm.name.value, UBForm.district.options[UBForm.district.selectedIndex].text);
                }
                else if(!isWhitespace(GetWarningMsg(server_message)))
                {
                    createmessagein(2, GetWarningMsg(server_message), UBForm.msgbox);
                }
                else if(!isWhitespace(GetErrorMsg(server_message)))
                {
                    createmessagein(3, GetErrorMsg(server_message), UBForm.msgbox);
                }
                else if(!isWhitespace(GetServerMsg(server_message)))
                {
                    createmessagein(4, GetServerMsg(server_message), UBForm.msgbox);
                }
                else
                {
                    createmessagein(3, '<b>Oh Snap!</b> There is a problem with the server or your connection.', UBForm.msgbox);
                }
            }
        });
    };

    //Async Update Barangay 2 Submit 
    UBForm2.form.onsubmit = function(e) {
        e.preventDefault();
        
        $(this).ajaxSubmit({
            beforeSend:function()
            {
                $(UBForm2.submit).button('loading');
            },
            uploadProgress:function(event,position,total,percentCompelete)
            {

            },
            success:function(data)
            {
                $(UBForm2.submit).button('reset');
                var server_message = data.trim();
                
                if(!isWhitespace(GetSuccessMsg(server_message)))
                {
                    createmessagein(1, 'Successfully updated barangay info!', UBForm2.msgbox);
                }
                else if(!isWhitespace(GetWarningMsg(server_message)))
                {
                    createmessagein(2, GetWarningMsg(server_message), UBForm2.msgbox);
                }
                else if(!isWhitespace(GetErrorMsg(server_message)))
                {
                    createmessagein(3, GetErrorMsg(server_message), UBForm2.msgbox);
                }
                else if(!isWhitespace(GetServerMsg(server_message)))
                {
                    createmessagein(4, GetServerMsg(server_message), UBForm2.msgbox);
                }
                else
                {
                    createmessagein(3, '<b>Oh Snap!</b> There is a problem with the server or your connection.', UBForm2.msgbox);
                }
            }
        });
    };


    function viewData(id){

        location.href='brgyinfo.php?b='+id;
    };
    
    


</script>



<!-- DELETE BARANGAY -->
<script>

var dbForm = {
        form: document.getElementById('deleteBarangayForm'),
        modal: document.getElementById('deleteBarangayModal'),
        id: document.getElementById('deleteBarangayForm_ID'),
        details: document.getElementById('deleteBarangayFormDetails'),
        deleteViewData: document.getElementById('deleteBarangayForm_VIEWDATA'),
        msgbox: 'deleteBarangayForm_msgbox',
        submit: document.getElementById('deleteBarangayForm_submit')
    };

function deleteFill(id) {
        var name = document.getElementById('Barangay_name_' + id).innerHTML;
        var city = document.getElementById('Barangay_city_' + id).innerHTML;
        var district = document.getElementById('Barangay_district_'+id).innerHTML;
        dbForm.deleteViewData.href = "brgyinfo.php?b=" + id;
        document.getElementById("deleteBarangayFormDetails").innerHTML = city + ', <small>' + district +' '+city+'</small>';
        dbForm.id.value = id;
        }



 $(dbForm.form).on('submit', function (e) {
        var id = dbForm.id.value;

        e.preventDefault();
        $(this).ajaxSubmit({
            beforeSend:function()
            {
                $(dbForm.submit).button('loading');
            },
            uploadProgress:function(event,position,total,percentCompelete)
            {

            },
            success:function(data)
            {
                $(dbForm.submit).button('reset');
                DisplayMsg(data, dbForm.msgbox, function (SuccessMsg) {
                    location.reload();
                    dbForm.form.reset();
                    $(dbForm.modal).modal('hide');
                });
            }
        });
    });



</script>
</body>
</html>





******************************************************************************

<?php
session_start();
include ('library/form/CdrrmoOnly.php');
include('library/form/connection.php');
include('library/function/functions.php');
$db = new db();

$search = isset($_GET['search']) ? $_GET['search'] : '';
$limit = 5;

$total_sql = 'SELECT * FROM evacuation_list WHERE EVACNAME LIKE "%'.$search.'%"';
$total_result = $db->connection->query($total_sql);
$total_count = mysqli_num_rows($total_result);
$total_page = ceil($total_count/$limit);

$page = isset($_GET['page']) && $_GET['page'] > 0 && $_GET['page'] <= $total_page ? $_GET['page'] : '1';
$offset = ($page * $limit) - $limit;

if($page < 2) {
    $disable_previous = 'disabled';
    $disable_previous2 = 'pointer-events: none;';
    $bottom_page = 'display:none';
}
else {
    $disable_previous = '';
    $disable_previous2 = '';
    $bottom_page = '';
}
if($total_page < 2) {
    $top_page = 'display:none';
}
else {
    $top_page = '';
}
if($total_page == $page || $total_page < 1) {
    $disable_next = 'disabled';
    $disable_next2 = 'pointer-events: none;';
    $top_page = 'display:none';
}
else {
    $disable_next = '';
    $disable_next2 = '';
    $top_page = '';
}

?>

<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="th3515">
    <meta name="author" content="@pablongbuhaymo">

    <title>Manage Evacuation Center | City Disaster Risk Management</title>    
    <link rel="icon" href="img/favicon.ico">

    <!-- Bootstrap Core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="css/app.css" rel="stylesheet">

   <link rel="stylesheet" href="https://unpkg.com/leaflet@1.0.3/dist/leaflet.css"
    integrity="sha512-07I2e+7D8p6he1SIM+1twR5TIrhUQn9+I6yjqD53JQjFiMf8EtC93ty0/5vJTZGF8aAocvHYNEDJajGdNx1IsQ=="
   crossorigin=""/>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>
<body id="page-top" data-spy="scroll" data-target=".navbar-fixed-top">

<!-- Modals -->


<!-- Map Modal (Updating) -->
<div class="modal fade" id="MapModal" tabindex="-1" role="dialog">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="UpdateEvac_Title">Evacuation Center</h4>
            </div>
            <div class="modal-body">
                <div id="UL_msgbox" tabindex="0"></div>
                
                       <div id="mapid" style="height: 70vh; width: 100%;" tabindex="0"> </div>

            </div>
            <div class ="modal-footer">
                <form id="UpdateEvacForm" method="post" action="library/form/CdrrmoEvacLocUpdate.php">
                    <input type="hidden" name="U_ID" id="UpdateEvac_ID" />
                    <input type="hidden" name="U_LAT" id="UpdateEvac_LAT" />
                    <input type="hidden" name="U_LNG" id="UpdateEvac_LNG" />
                    <button type="submit" id="UpdateEvac_SUBMIT" data-loading-text="Updating Location..." class="btn btn-primary" disabled>Update</button>
                    <button type="button" class="btn btn-success" data-dismiss="modal">View Overall</button>
                    <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                </form>
            </div>
        </div>
    </div>
</div>

<!--Edit Evacuation Modal-->
<div class="modal fade" id="EditEvacuationModal" tabindex="-1" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title">Edit Evacuation Center</h4>
            </div>
            <form id="EditEvacForm" method="post" action="library/form/EditEvacForm.php">
                <div class="modal-body">
                    <div id="EE_msgbox" tabindex="0"></div>

                    <!-- ID -->
                    <input id="EditEvacForm_ID" name="ID" type="hidden" class="form-control">

                    <!-- Evacuation Name -->
                    <div class="input-group input-group">
                        <span class="input-group-addon">Evacuation Name</span>
                        <input id="EditEvacForm_NAME" name="NAME" type="text" class="form-control">
                    </div>
                    <br />
                    
                    <!-- Barangay -->
                    <div class="input-group">
                        <span class="input-group-addon">Barangay: </span>
                        <select id="EditEvacForm_STATUS" name="BARANGAY" class="form-control">
                            <?php
                            $sql = "SELECT * FROM barangay ORDER BY NAME DESC";
                            $result = $db->connection->query($sql);
                            while($row = $result->fetch_assoc()) {
                                ?>
                                <option value="<?php echo $row["ID"]; ?>" id="barangay_<?php echo $row["ID"]; ?>"><?php echo $row["NAME"]; ?></option>
                                <?php
                            }
                            ?>
                        </select>
                    </div>
                    <br />

                    <!-- Capacity  -->
                    <div class="input-group input-group">
                        <span class="input-group-addon">Capacity</span>
                        <input type = "number" id="EditEvacForm_CAPACITY" name="CAPACITY" class="form-control">
                    </div>
                    <br />

                    <!-- Complete Address -->
                    <div class="input-group input-group">
                        <span class="input-group-addon">Complete Address</span>
                        <input id="EditEvacForm_ADDRESS1" name="ADDRESS1" type="text" class="form-control">
                    </div>
                    <br />

                </div>

                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                    <button type="submit" id="EditEvacForm_SUBMIT" data-loading-text="Editing Evacuation..." class="btn btn-primary">Edit</button>
                </div>

            </form>
        </div>
    </div>
</div>

<!--Add Evacuation Modal-->
<div class="modal fade" id="AddEvacuationModal" tabindex="-1" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title">Add Evacuation Center</h4>
            </div>
            <form id="AddEvacuationForm" method="post" action="library/form/addEvacForm.php">
                <div class="modal-body">
                    <div id="AE_msgbox" tabindex="0"></div>
                    
                    <!-- Evacuation Name -->
                    <div class="input-group input-group">
                        <span class="input-group-addon">Evacuation Name</span>
                        <input id="AddEvacuationForm_NAME" name="NAME" type="text" class="form-control">
                    </div>
                    <br />

                        <!-- Barangay -->
                    <div class="input-group">
                        <span class="input-group-addon">Barangay: </span>
                        <select id="AddEvacuationForm_STATUS" name="BARANGAY" class="form-control">
                            <?php
                            $sql = "SELECT * FROM barangay ORDER BY NAME DESC";
                            $result = $db->connection->query($sql);
                            while($row = $result->fetch_assoc()) {
                                ?>
                                <option value="<?php echo $row["ID"]; ?>" id="barangay_<?php echo $row["ID"]; ?>"><?php echo $row["NAME"]; ?></option>
                                <?php
                            }
                            ?>
                        </select>
                    </div>
                    <br />

                     <!-- Capacity  -->
                    <div class="input-group input-group">
                        <span class="input-group-addon">Capacity</span>
                        <input type = "number" id="AddEvacuationForm_CAPACITY" name="CAPACITY" class="form-control">
                    </div>
                    <br />

                    <!-- Complete Address -->
                    <div class="input-group input-group">
                        <span class="input-group-addon">Complete Address</span>
                        <input id="AddEvacuationForm_ADDRESS1" name="ADDRESS" type="text" class="form-control">
                    </div>
                    <br />

                 
                    
                </div>
                <div class="modal-footer">
                 <button type="submit" id="AddEvacuationForm_SUBMIT" data-loading-text="Adding Evacuation..." class="btn btn-primary">Add Evacuation</button>
                <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                </div>
            </form> 
        </div>
    </div>
</div>
<!-- Content starts here -->
<?php include('library/html/navbar.php'); ?>

<div class="container">
    <div class="page-header">
        <button class="btn btn-basic pull-right" data-toggle="modal" data-target="#AddEvacuationModal">
            <span class="glyphicon glyphicon-plus"></span> Add Evacuation Center
        </button>
        <h1>Manage Evacuation Centers</h1>
    </div>
    
    <!-- Evacuation Center Search Bar -->
    <div class="row">
        <div class="col-md-6 col-md-offset-3">
            <form id="SearchForm" method="get">
                <div class="input-group">
                    <input id="SearchInput" name="search" type="text" class="form-control" placeholder="Search.." value="<?php echo $search; ?>" />
                    <span class="input-group-btn">
                        <button id="SearchSubmit" class="btn btn-secondary" type="submit"><span class="glyphicon glyphicon-search"></span>&nbsp Search</button>
                    </span>
                </div>
            </form>
        </div>
    </div>
    
    <!-- Disaster Type List -->
    <table class="table table-striped table-hover">
        <thead>
        <tr>
            <th>Evacuation Center</th>
            <th>Barangay</th>
            <th>Complete Address</th>
            <th>View Data </th>
            <th>Location </th>
            <th>Actions</th>
        </tr>
        </thead>
        <tbody id="PageComponent_ECLIST">
        </tbody>
    </table>
    <div id="pagemessagebox" tabindex="0"></div>
    
    <!-- Pagination -->
    <ul class="pager">
        <li style="<?php echo $bottom_page; ?>">
            <a href="evacManage.php?search=<?php echo $search; ?>&page=1" style=""><span class="glyphicon glyphicon-menu-left"></span>&nbsp 1</a>
        </li>
        <li class="<?php echo $disable_previous; ?>">
            <a href="evacManage.php?search=<?php echo $search; ?>&page=<?php echo $page - 1; ?>" style="<?php echo $disable_previous2; ?>"><span class="glyphicon glyphicon-menu-left"></span>&nbsp Previous</a>
        </li>
        <li class="disabled">
            <span><h4 style="margin-top: 0.3rem; margin-bottom: 0.3rem;">Page <?php echo $page; ?></h4></span>
        </li>
        <li class="<?php echo $disable_next; ?>">
            <a href="evacManage.php?search=<?php echo $search; ?>&page=<?php echo $page + 1; ?>" style="<?php echo $disable_next2; ?>">Next&nbsp <span class="glyphicon glyphicon-menu-right"></span></a>
        </li>
        <li style="<?php echo $top_page; ?>">
            <a href="evacManage.php?search=<?php echo $search; ?>&page=<?php echo $total_page; ?>" style=""><?php echo $total_page; ?>&nbsp <span class="glyphicon glyphicon-menu-right"></span></a>
        </li>
    </ul>
</div>
<?php include('library/html/footer.php'); ?>

<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
<script src="js/1.11.3_jquery.min.js"></script>
<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="js/bootstrap.min.js"></script>
<script src="js/app/mylibrary.js"></script>
<script src="js/app/messagealert.js"></script>
<script src="js/jquery.datetimepicker.full.min.js"></script>
<script src="js/jquery.form.min.js"></script>
<script src="https://unpkg.com/leaflet@1.0.3/dist/leaflet.js"
   integrity="sha512-A7vV8IFfih/D732iSSKi20u/ooOfj/AGehOKq0f4vLT1Zr2Y+RX7C+w8A1gaSasGtRUZpF/NZgzSAu4/Gc41Lg=="
   crossorigin=""></script>


<!-- Map Script -->


<script>
  var PageComponent = {
        eclist: document.getElementById('PageComponent_ECLIST')
    };
    
  var AEForm = {  //Add Evacuation Form
        form: document.getElementById('AddEvacuationForm'),
        name: document.getElementById('AddEvacuationForm_NAME'),
        address1: document.getElementById('AddEvacuationForm_ADDRESS1'),
        capacity: document.getElementById('AddEvacuationForm_CAPACITY'),
        lat: document.getElementById('AddEvacuationForm_LAT'),
        lng: document.getElementById('AddEvacuationForm_LNG'),
        submit: '#AddEvacuationForm_SUBMIT',
        modal: '#AddEvacuationModal',
        msgbox: 'AE_msgbox'
    };

    function ResetAEForm() 
    {
        AEForm.name.value = '';
        AEForm.address1.value = '';
    }

     var EEForm = {
        form: document.getElementById('EditEvacForm'),
        id: document.getElementById('EditEvacForm_ID'),
        name: document.getElementById('EditEvacForm_NAME'),
        address1: document.getElementById('EditEvacForm_ADDRESS1'),
        capacity: document.getElementById('AddEvacuationForm_CAPACITY'),
        brgy: document.getElementById('EditEvacForm_STATUS'),
        submit: '#EditEvacForm_SUBMIT',
        modal: '#EditEvacuationModal',
        msgbox: 'EE_msgbox'
    };

    function EditFill(id) {
        var name = document.getElementById('Evac_name_' + id).innerHTML;
        var barangay = document.getElementById('Evac_barangay_' + id).innerHTML;
        var address1 = document.getElementById('Evac_address1_' + id).innerHTML;

        EEForm.id.value = id;
        EEForm.name.value = name;
        EEForm.address1.value = address1;

        for(var i = 0; i < EEForm.brgy.options.length; i++) {
            if(EEForm.brgy.options[i].text == barangay) {
                EEForm.brgy.selectedIndex = i;
            }
        }
    }


   

    function EditEvac(id, name, barangay, address1) {
        document.getElementById('Evac_name_' + id).innerHTML = name;
        document.getElementById('Evac_barangay_' + id).innerHTML = barangay;
        address1 = document.getElementById('Evac_address1_' + id).innerHTML = address1;
    }

    EEForm.form.onsubmit = function (e) {
        e.preventDefault();
        $(this).ajaxSubmit({
            beforeSend:function()
            {
                $(EEForm.submit).button('loading');
            },
            uploadProgress:function(event,position,total,percentCompelete)
            {

            },
            success:function(data)
            {
                $(EEForm.submit).button('reset');
                var server_message = data.trim();
                if(!isWhitespace(GetSuccessMsg(server_message)))
                {
                    createmessagein(1, "Evacuation Center Successfully Edited!", EEForm.msgbox);
                    EditEvac(EEForm.id.value, EEForm.name.value, EEForm.brgy.options[EEForm.brgy.selectedIndex].text, EEForm.address1.value);
                }
                else if(!isWhitespace(GetWarningMsg(server_message)))
                {
                    createmessagein(2, GetWarningMsg(server_message), EEForm.msgbox);
                }
                else if(!isWhitespace(GetErrorMsg(server_message)))
                {
                    createmessagein(3, GetErrorMsg(server_message), EEForm.msgbox);
                }
                else if(!isWhitespace(GetServerMsg(server_message)))
                {
                    createmessagein(4, GetServerMsg(server_message), EEForm.msgbox);
                }
                else
                {
                    createmessagein(3, '<b>Oh Snap!</b> There is a problem with the server or your connection.', EEForm.msgbox);
                }
            }
        });
    };
    
    AEForm.form.onsubmit = function (e) {
        e.preventDefault();
        $(this).ajaxSubmit({
            beforeSend:function()
            {
                $(AEForm.submit).button('loading');
            },
            uploadProgress:function(event,position,total,percentCompelete)
            {

            },
            success:function(data)
            {
                $(AEForm.submit).button('reset');
                var server_message = data.trim();
                if(!isWhitespace(GetSuccessMsg(server_message)))
                {
                    createmessagein(1, "Evacuation Center Successfully Added!", AEForm.msgbox);
                    location.reload();
                    ResetAEForm();
                }
                else if(!isWhitespace(GetWarningMsg(server_message)))
                {
                    createmessagein(2, GetWarningMsg(server_message), AEForm.msgbox);
                }
                else if(!isWhitespace(GetErrorMsg(server_message)))
                {
                    createmessagein(3, GetErrorMsg(server_message), AEForm.msgbox);
                }
                else if(!isWhitespace(GetServerMsg(server_message)))
                {
                    createmessagein(4, GetServerMsg(server_message), AEForm.msgbox);
                }
                else
                {
                    createmessagein(3, '<b>Oh Snap!</b> There is a problem with the server or your connection.', AEForm.msgbox);
                }
            }
        });
    };

    // ADD EVAC
  function AddEvac(id, name, barangay, capacity, address1, lat, lng) {
        PageComponent.eclist.innerHTML = PageComponent.eclist.innerHTML +
            '<tr>' +
            '   <td id="Evac_name_' + id + '">' + name + '</td>'+
            '   <td id="Evac_barangay_' + id + '">' + barangay + '</td>'+
            '   <td id="Evac_address1_' + id + '">' + address1 + '</td>'+
            '   <td id="Evac_lat_' + id + '" style="display:none">' + lat + '</td>'+
            '   <td id="Evac_lng_' + id + '" style="display:none">' + lng + '</td>'+
            // '   <td id = "Evac_lng_' + id + '" style STOPPED HERE 6/26/2017
            '   <td><div class="btn-group"><button id="Barangay_BTN_' + id + '" value="' + id + '" class="btn btn-default" onclick="#"><span class="glyphicon glyphicon glyphicon-new-window"></span>&nbspView</button><input type="hidden" class="btn" /></div></td>'+
            '   <td><button id="EditEvac_BTN' + id + '" value="' + id + '" class="btn btn-default"  data-toggle="modal" data-target="#MapModal"><span class="glyphicon glyphicon-map-marker"></span>&nbspLocation</button></td>'+
            '   <td><button id="EditEvac_BTN' + id + '" value="' + id + '" class="btn btn-default" onclick="EditFill(' + id + ')" data-toggle="modal" data-target="#EditEvacuationModal"><span class="glyphicon glyphicon-pencil"></span>&nbspEdit</button></td>'+
            '</tr>';
            //onclick="UpdateFill(\'' + id + '\')"
    }

        <?php
    $list_sql = 'SELECT
                    el.ID AS ID,
                    b.NAME AS BARANGAY,
                    el.EVACNAME AS EVACNAME,
                    el.EVACADDRESS1 AS ADDRESS1,
                    el.CAPACITY AS CAPACITY,
                    el.LAT AS LAT,
                    el.LNG AS LNG
                FROM
                    (SELECT * FROM evacuation_list WHERE EVACNAME LIKE "%'. $search .'%") AS el 
                INNER JOIN
                    barangay AS b ON b.ID = el.BARANGAY
                ORDER BY
                    el.EVACNAME
                LIMIT 
                    ' .$limit. '
                OFFSET 
                    '.$offset;
                
    $list_result = $db->connection->query($list_sql);
    $list_count = mysqli_num_rows($list_result);
    
    if($list_count < 1) {
        echo 'createmessage(4, "No results found.", false);';
    }
    else {
        while ($list_row = $list_result->fetch_assoc()) {
            $result_ID = htmlspecialchars($list_row['ID']);
            $result_BARANGAY = htmlspecialchars($list_row['BARANGAY']);
            $result_EVACNAME = htmlspecialchars($list_row['EVACNAME']);
            $result_ADDRESS1 = htmlspecialchars($list_row['ADDRESS1']);
            $result_CAPACITY = htmlspecialchars($list_row['CAPACITY']);
            $result_LAT = htmlspecialchars($list_row['LAT']);
            $result_LNG = htmlspecialchars($list_row['LNG']);
    ?>
    
    AddEvac(<?php echo $result_ID; ?>,'<?php echo $result_EVACNAME; ?>','<?php echo $result_BARANGAY; ?>','<?php echo $result_CAPACITY; ?>','<?php echo $result_ADDRESS1; ?>',<?php echo $result_LAT; ?>,<?php echo $result_LNG; ?>);
    
    <?php
        }
    }
    ?>

    var lat;
    var lng;
    var mymap = L.map('mapid').setView([10.69306, 482.57259], 15);

    var popup = L.popup();
    
    function onMapClick(e) {popup
         .setLatLng(e.latlng)
         .setContent("You have succesfully chosen a location")
         .openOn(mymap);
         lat = e.latlng.lat.toString();
         lng = e.latlng.lng.toString();
    }

    mymap.on('click', onMapClick);

    L.tileLayer('https://api.mapbox.com/styles/v1/mapbox/streets-v10/tiles/256/{z}/{x}/{y}?access_token=pk.eyJ1IjoiY2Rycm1vIiwiYSI6ImNqMzBhZXQxNDAwYWszMnFuejIyNG80cDkifQ.HQTrzbN7u43NV496Hujsnw', {
        attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery © <a href="http://mapbox.com">Mapbox</a>',
        maxZoom: 18,
        id: 'mapbox.mapbox-streets-v7',
        accessToken: 'pk.eyJ1IjoiY2Rycm1vIiwiYSI6ImNqMzBhZXQxNDAwYWszMnFuejIyNG80cDkifQ.HQTrzbN7u43NV496Hujsnw'
    }).addTo(mymap);


</script>

</body>
</html>

************************

<?php
session_start();
include('library/form/connection.php');
include('library/function/functions.php');
$db = new db();

$search = isset($_GET['search']) ? $_GET['search'] : '';
$limit = 8;

$total_sql = 'SELECT 
barangay.ID, 
barangay.NAME,
district.NAME AS DISTRICT, 
city.NAME AS CITY, 
barangay_info.MEN AS MEN, 
barangay_info.WOMEN AS WOMEN
FROM (SELECT * FROM barangay WHERE barangay.NAME LIKE "%'.$search.'%") AS barangay
LEFT JOIN district ON barangay.DISTRICT = district.ID
LEFT JOIN city ON district.CITY = city.ID
LEFT JOIN barangay_info ON barangay.ID = barangay_info.BARANGAY
GROUP BY barangay.ID';

$total_result = $db->connection->query($total_sql);
$total_count = mysqli_num_rows($total_result);
$total_page = ceil($total_count/$limit);

$page = isset($_GET['page']) && $_GET['page'] > 0 && $_GET['page'] <= $total_page ? $_GET['page'] : '1';
$offset = ($page * $limit) - $limit;

if($page < 2) {
    $disable_previous = 'disabled';
    $disable_previous2 = 'pointer-events: none;';
    $bottom_page = 'display:none';
}
else {
    $disable_previous = '';
    $disable_previous2 = '';
    $bottom_page = '';
}
if($total_page < 2) {
    $top_page = 'display:none';
}
else {
    $top_page = '';
}
if($total_page == $page || $total_page < 1) {
    $disable_next = 'disabled';
    $disable_next2 = 'pointer-events: none;';
    $top_page = 'display:none';
}
else {
    $disable_next = '';
    $disable_next2 = '';
    $top_page = '';
}
?>

<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="th3515">
    <meta name="author" content="@pablongbuhaymo">

    <title>Archive | City Disaster Risk Management</title>    
    <link rel="icon" href="img/favicon.ico">

    <!-- Bootstrap Core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="css/app.css" rel="stylesheet">

   <link rel="stylesheet" href="https://unpkg.com/leaflet@1.0.3/dist/leaflet.css"
    integrity="sha512-07I2e+7D8p6he1SIM+1twR5TIrhUQn9+I6yjqD53JQjFiMf8EtC93ty0/5vJTZGF8aAocvHYNEDJajGdNx1IsQ=="
   crossorigin=""/>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>

<!-- The #page-top ID is part of the scrolling feature - the data-spy and data-target are part of the built-in Bootstrap scrollspy function -->

<body id="page-top" data-spy="scroll" data-target=".navbar-fixed-top">

<?php include('library/html/navbar.php');
       include('library/html/loginmodal.php');
    ?>

     <div class="container"> <!--Content starts here-->
        <div class="page-header">
        <div style="margin: auto; text-align: center;" class="pull-right">
            <div class="btn-group" role="group" aria-label="...">
                <a href="#" class="btn btn-secondary active">Overall</a>
                <a href="#" class="btn btn-secondary">District</a>   
                <a href="#" class="btn btn-secondary">Barangay</a>
            </div>
        </div>
        <h3>Disaster Archive <small>of Iloilo City</small></h3>
    </div>

        <div class="container-fluid">
            <div class="row">
                <div class="col-lg-9 col-md-10 col-sm-12 col-xs-12">
                    <div id="mapid" style="height: 70vh; width: 100%;" tabindex="0"> </div>
                </div>

                <div class = "col-lg-3 col-md-2 col-sm-12 col-xs-12">
                        <div class = "pull-right">
                              <a href = "#" style= "text-decoration: none; color: #777; font-size: 14px;"> Overall |</a>
                            <?php
                                $sql = 'SELECT * FROM disaster_type';
                                $result = $db->connection->query($sql);
                                while ($row = $result->fetch_assoc()){
                                    ?>
                                    <a href = "#" class="glyphicon glyphicon-stop" title = " <?php echo $row['NAME']; ?>" style="color: <?php echo $row['COLOR']; ?>; text-decoration: none;"></a>
                                    <?php
                                }
                                ?>
                            </div> 
                        <br /><br>
                        <form id="SearchForm" method="get">
                            <div class="input-group">
                                <input id="SearchInput" name="search" type="text" class="form-control" placeholder="Search.." value="<?php echo $search; ?>" />
                                <span class="input-group-btn">
                                    <button id="SearchSubmit" class="btn btn-secondary" type="submit"><span class="glyphicon glyphicon-search"></span>&nbsp Search</button>
                                </span>
                            </div>


                        <br />
              
                        <ul class="list-group" id = "PageComponent_ARCHIVELIST">

                         </ul>

                    <br />

                        </form>

                      

                    <ul class="pager" id = "pagerID">

                    <li class="<?php echo $disable_previous; ?>">
                        <a href="overview.php?search=<?php echo $search; ?>&page=<?php echo $page - 1; ?>" style="<?php echo $disable_previous2; ?> font-size: 10px;"><span class="glyphicon glyphicon-menu-left"></span>&nbsp Previous</a>
                    </li>
                    <li class="disabled">
                        <span><h4 style="margin-top: 0.3rem; margin-bottom: 0.3rem; font-size: 15px;">Page <?php echo $page; ?></h4></span>
                    </li>
                    <li class="<?php echo $disable_next; ?>">
                        <a href="overview.php?search=<?php echo $search; ?>&page=<?php echo $page + 1; ?>" style="<?php echo $disable_next2; ?>   font-size: 10px;">Next&nbsp <span class="glyphicon glyphicon-menu-right"></span></a>
                    </li>

    </ul>    
                </div>
            </div>
        </div>
    </div>
<br>

    <div class = "container">
    <div class = "row">
        <div class="panel panel-default">
            <div class="panel-heading">
            <span class="dropdown pull-right">
                        <button class="btn btn-default dropdown-toggle" type="button" data-toggle="dropdown">Overall
                        <span class="caret"></span></button>
                        <ul class="dropdown-menu" id = "declare_listHTML">
                          <li><a href="#">Overall</a></li>
                          <li class="divider"></li>
                          <li class="dropdown-header">Verified Disaster Report</li>
                          <li><a href="#">Example</a></li>
                          <li><a href="#">Example</a></li>
                          <li><a href="#">Example</a></li>
                        
                        </ul>
            </span>
                <h4 id = 'disasterTitleHTML'> Graph Details</h4>
            </div>

            <div class="panel-body">
            

                <div class = "col-lg-3 col-md-3 col-sm-6 col-xs-6">
                   <canvas id="cassualtiesChart" width="10" height="10"></canvas>
                   <center><h5><b> Cassualties </b></h5></center>                  
                </div>
                <div class = "col-lg-3 col-md-3 col-sm-6 col-xs-6">
                    <canvas id="damagedHouses" width="10" height="10"></canvas>                  
                    <center><h5><b> Damaged Houses </b></h5></center>
                </div>
                <div class = "col-lg-3 col-md-3 col-sm-6 col-xs-6">  
                    <canvas id="evacuees" width="10" height="10"></canvas>                  
                    <center><h5><b> Evacuees </b></h5></center>
                </div>                 
                <div class = "col-lg-3 col-md-3 col-sm-6 col-xs-6">    
                    <canvas id="costOfAssistance" width="10" height="10"></canvas>             
                    <center><h5><b> Cost of Assistance </b></h5></center>
                </div>

                <span class = "col-lg-12 col-md-12 col-sm-12 col-xs-12">
                           <br><br>
                            <h4> Evacuation Center used: </h4>
                           
                           <div class="list-group">
                                <div class="list-group" id="evacuation_list">
                                
                                        <a href="#" class="list-group-item"><h4 class="list-group-item-heading">Central Philippine University</h4><div class="list-group-item-text">Half Moon Dr, Lopez, Iloilo City, 5000 Iloilo, Philippines</div><small>Capacity: 350<span class = "pull-right"><small> Duration: 3/28/17 -  4/20/17 </small></span></small></a>
                                         <a href="#" class="list-group-item"><h4 class="list-group-item-heading">Ortiz Gym</h4><div class="list-group-item-text">San Isidro, Iloilo City, 5000 Iloilo, Philippines</div><small>Capacity: 350<span class = "pull-right"><small> Duration: 3/28/17 -  4/20/17 </small></span></small></a>
                                </div>
                            </div>
                </span>

                <span class = "col-lg-12 col-md-12 col-sm-12 col-xs-12">
                        <h4> Images taken: </h4>
                          <div class="list-group">
                                <div class="list-group" id="">
                                    <a href="#" class="list-group-item">
                                    
                                    <!-- conflict @ mobile. 

                                    3 images with both side toggle that slides from left to right width credits to user @ middle-->                         
                                    
                                    <img src = "img/slide1.jpg" title = "ur pussy after i do u" style = "width: 355px; height: 280px;">
                                    <img src = "img/slide2.jpg" title = "west side represent" style = "width: 355px; height: 280px;">
                                    <img src = "img/slide3.jpg" title = "us vs u" style = "width: 355px; height: 280px;">
                                    
                                </a>
                                </div>
                            </div>                        
                </span>

                                <span class = "col-lg-12 col-md-12 col-sm-12 col-xs-12">
                           <br>
                            <h4> News Article </h4>
                           
                           <div class="list-group">
                                <div class="list-group" id="evacuation_list">
                                
                                        <a href="#" class="list-group-item"><h4 class="list-group-item-heading">Super Typhoon Yolanda / Haiyan Aftermath</h4><div class="list-group-item-text">http://www.rappler.com/move-ph/issues/disasters/typhoon-yolanda</div><small>Source: Rappler</small></a>
                                        <a href="#" class="list-group-item"><h4 class="list-group-item-heading">Philippines remembers super typhoon 'Yolanda' disaster</h4><div class="list-group-item-text">http://news.abs-cbn.com/news/11/08/16/philippines-remembers-super-typhoon-yolanda-disaster</div><small>Source: ABS-CBN</small></a>

                                </div>
                            </div>
                </span>

           
            </div>
            
        </div>
    </div>
    </div>

<?php include('library/html/footer.php'); ?>

    <!-- jQuery -->
    <script src="js/jquery.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="js/bootstrap.min.js"></script>
    <script src="js/jquery.easing.min.js"></script>
    <script src="js/app/mylibrary.js"></script>
    <script src="js/app/loginscript.js"></script>

    <script src="js/chart.bundle.min.js"></script>
    <script src="https://unpkg.com/leaflet@1.0.3/dist/leaflet.js"
   integrity="sha512-A7vV8IFfih/D732iSSKi20u/ooOfj/AGehOKq0f4vLT1Zr2Y+RX7C+w8A1gaSasGtRUZpF/NZgzSAu4/Gc41Lg=="
   crossorigin=""></script>
    
</body>

</html>
<!-- MAP SCRIPTS -->

<script>
    
 var mymap = L.map('mapid').setView([10.70426, 482.56388], 14);

    var popup = L.popup();

    function onMapClick(e) {
        popup
            .setLatLng(e.latlng)
            .setContent("You clicked the map at " + e.latlng.toString())
            .openOn(mymap);
    }

    mymap.on('click', onMapClick);


L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png', {
   attribution: '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',
}).addTo(mymap);



</script>


<!-- Disaster Details Scripts -->

<script>

           
$('.list-group-item').on('click', function() {
    var $this = $(this);
    var $alias = $this.data('');

    $('.active').removeClass('active');
    $this.toggleClass('active')

    // Pass clicked link element to another function
    myfunction($this, $alias)
})

function myfunction($this) {
    console.log($this.text());  // Will log Paris | France | etc...

    console.log($alias);  // Will output whatever is in data-alias=""
}





// <!-- CHART SCRIPTS -->

var ctx = document.getElementById("cassualtiesChart");
var myChart = new Chart(ctx, {
    type: 'pie',
    data: {
        labels: ["Dead", "Injured", "Missing"],
        datasets: [{
            label: '# of Cassualties',
            data: [100,150,250],
            backgroundColor: [
            'rgba(237,153,91,0.8)',
            'rgba(245,79,85,0.8)',
            'rgba(203,80,80,0.8)'
           ],
            borderColor: [
            'rgba(237,153,91,1)',
            'rgba(245,79,85,1)',
            'rgba(203,80,80,1)'
            ],
            borderWidth: 1
        }]
    },
    options: {
                animation:{
                    animateScale:true
                }
            }
});

var ctx = document.getElementById("damagedHouses");
var myChart = new Chart(ctx, {
    type: 'pie',
    data: {
        labels: ["Totally Damaged", "Partially Damaged"],
        datasets: [{
            label: '# of Damaged Houses',
            data: [550,235],
            backgroundColor: [
                'rgba(203,80,80,0.8)',
                'rgba(232,226,214,0.8)'
            ],
            borderColor: [
                'rgba(203,80,80,1)',
                'rgba(232,226,214,1)'
            ],
            borderWidth: 1
        }]
    },
    options: {
                animation:{
                    animateScale:true
                }
            }
});


var ctx = document.getElementById("evacuees");
var myChart = new Chart(ctx, {
    type: 'pie',
    data: {
        labels: ["Evacuees", "Remaining Population"],
        datasets: [{
            label: '# of Votes',
            data: ['700', '5000'],
            backgroundColor: [
                'rgba(143,136,86,0.8)',
                'rgba(237,153,91,0.8)'
            
            ],
            borderColor: [
              'rgba(143,136,86,1)',
              'rgba(237,153,91,1)'
            
            ],
            borderWidth: 1
        }]
    },
    options: {
                animation:{
                    animateScale:true
                }
            }
});


var ctx = document.getElementById("costOfAssistance");
var myChart = new Chart(ctx, {
    type: 'polarArea',
    data: {
        datasets: [{
        data: ['355','235','1123'],
        
        backgroundColor: [

            'rgba(237,153,91,0.8)',
            'rgba(245,79,85,0.8)',
            'rgba(203,80,80,0.8)'
            ],
        
        borderColor: [
          
            'rgba(237,153,91,1)',
            'rgba(245,79,85,1)',
            'rgba(203,80,80,1)'
            ],
            borderWidth: 1
    }],

    labels: [
        'DSWD',
        'LGU',
        'NGO',
    ]

    },
    options: {
                animation:{
                    animateScale:true
                }
            }
});

 <?php
                             $sql = '';
                                $result = $db->connection->query($sql);
                                while ($row = $result->fetch_assoc()){
                                    ?>
                                     
                                    <?php
                                }
                                ?>
 <?php

    $list_sql='
    SELECT 
     disaster_profile.ID,
     disaster_profile.NAME, 
     disaster_type.COLOR 
    
    FROM (SELECT * FROM disaster_profile WHERE disaster_profile.NAME LIKE "%'.$search.'%")     
    LEFT JOIN disaster_type
    ON disaster_profile.TYPE = disaster_type.ID
    GROUP BY disaster_profile.ID
    ORDER BY disaster_profile.NAME
    LIMIT '.$limit.' OFFSET '.$offset;
    
    $list_result = $db->connection->query($list_sql);
    $list_count = mysqli_num_rows($list_result);
    
    if($list_count < 1) {
        echo 'createmessage(4, "No results found.", false);';
    }
    else {
        while ($list_row = $list_result->fetch_assoc()) {
            $result_ID = htmlspecialchars($list_row['ID']);
            $result_NAME = htmlspecialchars($list_row['NAME']);
            $result_COLOR = htmlspecialchars($list_row['COLOR']);
           
    ?>
    addArchive(<?php echo $result_ID; ?>, '<?php echo $result_NAME; ?>', '<?php echo $result_COLOR; ?>');
    <?php
        }
    }
    ?>

    var PageComponent = {
            archiveList: document.getElementById('PageComponent_ARCHIVELIST')
        };

    function addArchive(id, name, color) {
        PageComponent.archiveList.innerHTML = PageComponent.archiveList.innerHTML +
            '<a href = "#"  id="Archive_name" class = "list-group-item">'+name+' <span class = "glyphicon glyphicon-stop pull-right"  style = "color: '+color+'"> </span></a>'+
            '<a href = "#"  id="Archive_name'+id+'" class = "list-group-item hidden"</a>'
            
        }


</script>



*****************************************

<!DOCTYPE html>
<?php
session_start();
include('library/form/cswdonly.php');
include('library/form/connection.php');
include('library/function/functions.php');
$db = new db();

    $session_USER_FIRSTNAME = htmlspecialchars($_SESSION['USER_FIRSTNAME']);
    $session_USER_MIDDLENAME = htmlspecialchars($_SESSION['USER_MIDDLENAME']);
    $session_USER_LASTNAME = htmlspecialchars($_SESSION['USER_LASTNAME']);
    
    //query for the address
    // $sql = '
    //         SELECT  
    //                 barangay.NAME AS BRGYNAME,
    //                 district.NAME AS DISTRICTNAME,
    //                 city.NAME AS CITYNAME
    //         FROM 
    //                 barangay, 
    //                 district, 
    //                 city
    //         WHERE   
    //                 barangay.ID = ' . $_SESSION['USER_BRGY'] . '
    //         AND 
    //                 barangay.DISTRICT = district.ID
    //         AND 
    //                 district.CITY = city.ID
    //         ';
    // $result = $db->connection->query($sql);
    // $count = mysqli_num_rows($result);
    // $row = $result->fetch_assoc();

    // //variables for the address
    // $result_BRGYNAME = htmlspecialchars($row['BRGYNAME']);
    // $result_DISTRICTNAME = htmlspecialchars($row['DISTRICTNAME']);
    // $result_CITYNAME = htmlspecialchars($row['CITYNAME']);

    ?>
<!--This Page is for the admin only -->
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Disaster Risk Management</title>

    <!-- Bootstrap -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/app.css" rel="stylesheet">
    <link href="css/jquery.datetimepicker.css" rel="stylesheet">

</head>

<div class="modal fade" id="disasterAdd" tabindex="-1" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title">New Disaster Profile</h4>
            </div>
            
            <!-- Add Barangay Form -->
            <form id="disasterAddForm" method="post" action="library/form/disasterAddForm.php">
                <div class="modal-body">
                     <div id="disasterAdd_msgbox" tabindex="0"></div>
                    
                    <div class="panel panel-default">
                        <div class="panel-heading">Information</div>
                        <div class="panel-body">

                            <!-- Disaster Type -->
                            <div class="input-group">
                                <span class="input-group-addon" id="sizing-addon1">What Disaster?</span>
                                <select class="form-control" id="disasterAdd_DISASTER" name="DISASTER" required>
                                    <?php
                                    $sql = "SELECT * FROM disaster_type WHERE ENABLED=1 ORDER BY NAME ASC";
                                    $result = $db->connection->query($sql);
                                    while($row = $result->fetch_assoc()) {
                                    ?>
                                    <option value="<?php echo $row["ID"]; ?>" id="disaster_type_<?php echo $row["ID"]; ?>"><?php echo $row["NAME"]; ?></option>
                                    <?php
                                    }
                                    ?>
                                </select>
                            </div>
                            <br />


                        <div class="input-group input-group">
                          <span class="input-group-addon" id="sizing-addon1">Alias</span>
                          <input type="text" id="disasterAdd_NICKNAME" maxlength="50" name="NICKNAME" class="form-control" aria-describedby="sizing-addon1" required>
                            <span class="input-group-btn">
                                  <button class="btn btn-default" type="button" data-placement="bottom" data-toggle="popover" data-content="_____________________ This is just to differentiate disasters declared in your barangay. You can make any alias."><span class="glyphicon glyphicon-question-sign"></span> </button>
                            </span>
                        </div>                            

                        <br />

                        <div class="input-group">
                            <span class="input-group-addon" id="sizing-addon1">Select Barangay:</span>
                                <select class="form-control" id="disasterAdd_BARANGAY" name="BARANGAY" required>
                                    <?php
                                    $sql = "SELECT * FROM barangay ORDER BY NAME ASC";
                                    $result = $db->connection->query($sql);
                                    while($row = $result->fetch_assoc()) {
                                    ?>
                                    <option value="<?php echo $row["ID"]; ?>" id="disaster_type_<?php echo $row["ID"]; ?>"><?php echo $row["NAME"]; ?></option>
                                    <?php
                                    }
                                    ?>
                                </select>
                            </div>
                            <p> *soon to be changed as mapping identifies automatic all the barangay affected</p>
                            

                            <?php

                            date_default_timezone_set('Asia/Hong_Kong');
                            $time = time();

                            ?>

                            <div class="input-group input-group">
                              <span class="input-group-addon" id="sizing-addon1">When did it start?</span>
                              <input type="text" class="form-control" value="<?php echo date("Y/m/d H:i", $time); ?>" id="disasterAdd_STARTED" name="STARTED" required/>
                            </div>
                            
                            <br />


                            <div class="input-group input-group">
                              <span class="input-group-addon" id="sizing-addon1">When did it end?</span>
                              <input type="text" class="form-control" value="<?php echo date("Y/m/d H:i", $time); ?>" id="disasterAdd_ENDED" name="ENDED" required/>
                            </div>

                            <br />

                            <div class="input-group input-group">
                              <span class="input-group-addon" id="sizing-addon1">Note/Comment</span>
                              <textarea rows="5" class="form-control" id="disasterAdd_COMMENT" name="COMMENT" maxlength="300" placeholder="Place your note or comment here regarding to the disaster."></textarea>
                            </div>

                            <br />                            

                        </div>
                    </div>
                    

                    <div class="panel panel-default">
                        <div class="panel-heading">Location</div>
                        <div class="panel-body">
                                    
                    <div class="input-group">
                        <span class="input-group-addon" id="basicasdsaasdon1"><span class="glyphicon glyphicon-pushpin"></span></span>
                        <div class="form-control" style="width: 100%; height:300px;">
                            <div id="map"></div>
                        </div>
                        <!-- <input id="pac-input" class="controls" onkeydown="if(event.keyCode == 13) {event.preventDefault(); return false; }" type="text" placeholder="Search Box" /> -->
                    </div>

                        </div>
                    </div>
                    
                </div>
                
                <!-- Submission -->
                <div class="modal-footer">
                    <button type="submit" id="disasterAdd_SUBMIT" data-loading-text="Adding Disaster..." class="btn btn-primary">Add Disaster</button>
                    <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                </div>
                
            </form>
            
        </div>
    </div>
</div>
<?php include('library/html/navbar.php'); ?>

<body role="document">
<div class="container"> <!--Content starts here-->
    <div class="page-header">
        <h3>
           Manage Verified Disaster Profile 
           <span class = "pull-right">
                <div class="btn-group"><button id="Barangay_BTN_' + id + '" value="' + id + '" class="btn btn-secondary" data-toggle="modal" data-target="#disasterAdd" ><span class="glyphicon glyphicon-plus"></span> Add new Disaster Profile</button><input type="hidden" class="btn" /></div>
            </span>
        </h3>
    </div>
   

            <div class="list-group">
                <div class="row">
                 <?php

                        $sql = 'SELECT disaster_declare.NICKNAME, disaster_declare.STARTED, disaster_declare.ID, disaster_type.COLOR, disaster_type.NAME AS DISASTERNAME 
                                FROM disaster_declare, disaster_type 
                               
                                WHERE  
                                disaster_type.ID = disaster_declare.DISASTER
                                AND disaster_declare.ACCEPTED = 0
                                ORDER BY disaster_declare.STARTED DESC';
                        $result = $db->connection->query($sql);
                        $count = mysqli_num_rows($result);
                        while($row = $result->fetch_assoc()) {

                            $result_NICKNAME = htmlspecialchars($row['NICKNAME']);
                            $result_STARTED = htmlspecialchars($row['STARTED']);
                            $result_ID = htmlspecialchars($row['ID']);
                            $result_DISASTERNAME = htmlspecialchars($row['DISASTERNAME']);
                            $result_COLOR = $row['COLOR'];

                            ?>

                            <div class="col-lg-4">
                                <a href="confirmDisaster.php?id=<?php echo $row['ID']; ?>" class="list-group-item">
                                    <p class="list-group-item-text pull-right"><?php echo converttoformaldatetimestring($result_STARTED); ?></p>
                                    <h2 class="list-group-item-heading"><?php echo $result_NICKNAME; ?></h2>
                                    <h4><span class="glyphicon glyphicon-stop" style="color: <?php echo $result_COLOR;   ?>"></span> <?php echo $result_DISASTERNAME; ?></h4>

                                    <?php
                                    $sql2 = 'SELECT ID
                                                 FROM disaster_reports
                                                 WHERE ISVERIFIED = 0
                                                 AND DECLAREID = ' . $result_ID;
                                    $result2 = $db->connection->query($sql2);
                                    $count2 = mysqli_num_rows($result2);

                                    $sql2 = 'SELECT ID
                                                     FROM evacuation_report
                                                     WHERE ISVERIFIED = 0
                                                     AND DECLAREID = ' . $result_ID;
                                    $result2 = $db->connection->query($sql2);
                                    $count2 += mysqli_num_rows($result2);
                                    if($count2 > 0){
                                    ?>
                                    <h4><span class="label label-danger"><?php echo $count2; ?> Pending Report<?php if($count2 > 1) {echo 's';} ?></span></h4>
                                    <?php }  ?>
                                    <div style="clear: both;"></div>
                                </a>
                                <br/>
                            </div>
                            <?php
                        }
                        ?>
             



                </div>
            </div>

</div>
<!--FOOTER HERE-->
<?php include('library/html/footer.php'); ?>

<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
<script src="js/1.11.3_jquery.min.js"></script>
<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="js/bootstrap.min.js"></script>
<script src="js/app/mylibrary.js"></script>
<script src="js/app/messagealert.js"></script>
<script src="js/jquery.datetimepicker.full.min.js"></script>
<script src="js/jquery.form.min.js"></script>

</body>
</html>


<script>

    $(function () {
        $('[data-toggle="popover"]').popover()
    });

    $('#disasterAdd_STARTED').datetimepicker({
        mask:'9999/19/39 29:59'
    });

    $('#disasterAdd_ENDED').datetimepicker({
        mask:'9999/19/39 29:59'
    });

    var DAForm = {
        id: document.getElementById('disasterAddForm'),
        disaster: document.getElementById('disasterAdd_DISASTER'),
        nickname: document.getElementById('disasterAdd_NICKNAME'),
        started: document.getElementById('disasterAdd_STARTED'),
        ended: document.getElementById('disasterAdd_ENDED'),
        comment: document.getElementById('disasterAdd_COMMENT'),
        barangay: document.getElementById('disasterAdd_BARANGAY'),
        city: document.getElementById('disasterAdd_City'),
        submit: 'disasterAdd_SUBMIT',
        msgbox: 'disasterAdd_msgbox'
    };

    DAForm.id.onsubmit = function (e) {
        e.preventDefault();
        DAForm.nickname.value = DAForm.nickname.value.trim();

        if(isWhitespace(DAForm.disaster.value))
        {
            createmessage(3, 'Please select a disaster.',  false);
            return false;
        }
        else if(isWhitespace(DAForm.nickname.value))
        {
            createmessage(3, 'Nickname cannot be whitespace.',  false);
            return false;
        }
        else if(haswrongspaces(DAForm.nickname.value))
        {
            createmessage(3, 'Please Check your nickname. Double space or more is not allowed.', false);
            return false;
        }
        else if(isbelow(2, DAForm.nickname.value))
        {
            createmessage(3, 'Nickname must be at least 2 characters.',  false);
            return false;
        }
        else if(isWhitespace(DAForm.started.value))
        {
            createmessage(3, 'Please enter the date and time when the disaster happened',  false);
            return false;
        }
        else if(isWhitespace(DAForm.ended.value))
        {
            createmessage(3, 'Please enter the date and time when the disaster ended',  false);
            return false;
        }


        if (confirm('Please confirm the form to submit: \n' +
            '\nDisaster: ' + document.getElementById('disaster_type_' + DAForm.disaster.value).innerHTML +
            '\nNickname: ' + DAForm.nickname.value +
            '\nDate Started: ' + DAForm.started.value+
            '\nDate Ended: ' + DAForm.ended.value))
        {

        }
        else
        {
            return false;
        }

     
        e.preventDefault();
        $(this).ajaxSubmit({
            beforeSend:function()
            {
                $(DAForm.submit).button('loading');
            },
            uploadProgress:function(event,position,total,percentCompelete)
            {

            },
            success:function(data)
            {
                $(DAForm.submit).button('reset');
                var server_message = data.trim();
                
                if(!isWhitespace(GetSuccessMsg(server_message)))
                {
                    createmessagein(1, 'Successfully added barangay!', DAForm.msgbox);
                    
                    location.reload();
                    DAForm.id.reset();

                }
                else if(server_message == 'error')
                {
                    createmessage(3, 'There is a problem with submitting your report.',  DAForm.msgbox);
                }
                 else if(!isWhitespace(GetSuccessMsg(server_message)))
                {
                    createmessage(1, GetSuccessMsg(server_message),  DAForm.msgbox);
                }
                else if(!isWhitespace(GetWarningMsg(server_message)))
                {
                    createmessage(2, GetWarningMsg(server_message),  DAForm.msgbox);
                }
                else if(!isWhitespace(GetErrorMsg(server_message)))
                {
                    createmessage(3, GetErrorMsg(server_message),  DAForm.msgbox);
                }
                else if(!isWhitespace(GetServerMsg(server_message)))
                {
                    createmessage(4, GetServerMsg(server_message),  DAForm.msgbox);
                }
                else
                {
                    createmessage(3, '<b>Oh Snap!</b> There is a problem with the server or your connection.', DAForm.msgbox);
                }
            }
        }); 

    };
</script>


**************************************************

<!DOCTYPE html>
<?php
session_start();
include('library/form/cswdonly.php');
include('library/form/connection.php');
include('library/function/functions.php');
$db = new db();

    $session_USER_FIRSTNAME = htmlspecialchars($_SESSION['USER_FIRSTNAME']);
    $session_USER_MIDDLENAME = htmlspecialchars($_SESSION['USER_MIDDLENAME']);
    $session_USER_LASTNAME = htmlspecialchars($_SESSION['USER_LASTNAME']);
    
    //query for the address
    // $sql = '
    //         SELECT  
    //                 barangay.NAME AS BRGYNAME,
    //                 district.NAME AS DISTRICTNAME,
    //                 city.NAME AS CITYNAME
    //         FROM 
    //                 barangay, 
    //                 district, 
    //                 city
    //         WHERE   
    //                 barangay.ID = ' . $_SESSION['USER_BRGY'] . '
    //         AND 
    //                 barangay.DISTRICT = district.ID
    //         AND 
    //                 district.CITY = city.ID
    //         ';
    // $result = $db->connection->query($sql);
    // $count = mysqli_num_rows($result);
    // $row = $result->fetch_assoc();

    // //variables for the address
    // $result_BRGYNAME = htmlspecialchars($row['BRGYNAME']);
    // $result_DISTRICTNAME = htmlspecialchars($row['DISTRICTNAME']);
    // $result_CITYNAME = htmlspecialchars($row['CITYNAME']);

    ?>
<!--This Page is for the admin only -->
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Disaster Risk Management</title>

    <!-- Bootstrap -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/app.css" rel="stylesheet">
    <link href="css/jquery.datetimepicker.css" rel="stylesheet">

</head>

<div class="modal fade" id="disasterAdd" tabindex="-1" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title">New Disaster Profile</h4>
            </div>
            
            <!-- Add Barangay Form -->
            <form id="disasterAddForm" method="post" action="library/form/disasterAddForm.php">
                <div class="modal-body">
                     <div id="disasterAdd_msgbox" tabindex="0"></div>
                    
                    <div class="panel panel-default">
                        <div class="panel-heading">Information</div>
                        <div class="panel-body">

                            <!-- Disaster Type -->
                            <div class="input-group">
                                <span class="input-group-addon" id="sizing-addon1">What Disaster?</span>
                                <select class="form-control" id="disasterAdd_DISASTER" name="DISASTER" required>
                                    <?php
                                    $sql = "SELECT * FROM disaster_type WHERE ENABLED=1 ORDER BY NAME ASC";
                                    $result = $db->connection->query($sql);
                                    while($row = $result->fetch_assoc()) {
                                    ?>
                                    <option value="<?php echo $row["ID"]; ?>" id="disaster_type_<?php echo $row["ID"]; ?>"><?php echo $row["NAME"]; ?></option>
                                    <?php
                                    }
                                    ?>
                                </select>
                            </div>
                            <br />


                        <div class="input-group input-group">
                          <span class="input-group-addon" id="sizing-addon1">Alias</span>
                          <input type="text" id="disasterAdd_NICKNAME" maxlength="50" name="NICKNAME" class="form-control" aria-describedby="sizing-addon1" required>
                            <span class="input-group-btn">
                                  <button class="btn btn-default" type="button" data-placement="bottom" data-toggle="popover" data-content="_____________________ This is just to differentiate disasters declared in your barangay. You can make any alias."><span class="glyphicon glyphicon-question-sign"></span> </button>
                            </span>
                        </div>                            

                        <br />

                        <div class="input-group">
                            <span class="input-group-addon" id="sizing-addon1">Select Barangay:</span>
                                <select class="form-control" id="disasterAdd_BARANGAY" name="BARANGAY" required>
                                    <?php
                                    $sql = "SELECT * FROM barangay ORDER BY NAME ASC";
                                    $result = $db->connection->query($sql);
                                    while($row = $result->fetch_assoc()) {
                                    ?>
                                    <option value="<?php echo $row["ID"]; ?>" id="disaster_type_<?php echo $row["ID"]; ?>"><?php echo $row["NAME"]; ?></option>
                                    <?php
                                    }
                                    ?>
                                </select>
                            </div>
                            <p> *soon to be changed as mapping identifies automatic all the barangay affected</p>
                            

                            <?php

                            date_default_timezone_set('Asia/Hong_Kong');
                            $time = time();

                            ?>

                            <div class="input-group input-group">
                              <span class="input-group-addon" id="sizing-addon1">When did it start?</span>
                              <input type="text" class="form-control" value="<?php echo date("Y/m/d H:i", $time); ?>" id="disasterAdd_STARTED" name="STARTED" required/>
                            </div>
                            
                            <br />


                            <div class="input-group input-group">
                              <span class="input-group-addon" id="sizing-addon1">When did it end?</span>
                              <input type="text" class="form-control" value="<?php echo date("Y/m/d H:i", $time); ?>" id="disasterAdd_ENDED" name="ENDED" required/>
                            </div>

                            <br />

                            <div class="input-group input-group">
                              <span class="input-group-addon" id="sizing-addon1">Note/Comment</span>
                              <textarea rows="5" class="form-control" id="disasterAdd_COMMENT" name="COMMENT" maxlength="300" placeholder="Place your note or comment here regarding to the disaster."></textarea>
                            </div>

                            <br />                            

                        </div>
                    </div>
                    

                    <div class="panel panel-default">
                        <div class="panel-heading">Location</div>
                        <div class="panel-body">
                                    
                    <div class="input-group">
                        <span class="input-group-addon" id="basicasdsaasdon1"><span class="glyphicon glyphicon-pushpin"></span></span>
                        <div class="form-control" style="width: 100%; height:300px;">
                            <div id="map"></div>
                        </div>
                        <!-- <input id="pac-input" class="controls" onkeydown="if(event.keyCode == 13) {event.preventDefault(); return false; }" type="text" placeholder="Search Box" /> -->
                    </div>

                        </div>
                    </div>
                    
                </div>
                
                <!-- Submission -->
                <div class="modal-footer">
                    <button type="submit" id="disasterAdd_SUBMIT" data-loading-text="Adding Disaster..." class="btn btn-primary">Add Disaster</button>
                    <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                </div>
                
            </form>
            
        </div>
    </div>
</div>
<?php include('library/html/navbar.php'); ?>

<body role="document">
<div class="container"> <!--Content starts here-->
    <div class="page-header">
        <h3>
           Manage Verified Disaster Profile 
           <span class = "pull-right">
                <div class="btn-group"><button id="Barangay_BTN_' + id + '" value="' + id + '" class="btn btn-secondary" data-toggle="modal" data-target="#disasterAdd" ><span class="glyphicon glyphicon-plus"></span> Add new Disaster Profile</button><input type="hidden" class="btn" /></div>
            </span>
        </h3>
    </div>
   

            <div class="list-group">
                <div class="row">
                 <?php

                        $sql = 'SELECT disaster_declare.NICKNAME, disaster_declare.STARTED, disaster_declare.ID, disaster_type.COLOR, disaster_type.NAME AS DISASTERNAME 
                                FROM disaster_declare, disaster_type 
                               
                                WHERE  
                                disaster_type.ID = disaster_declare.DISASTER
                                AND disaster_declare.ACCEPTED = 0
                                ORDER BY disaster_declare.STARTED DESC';
                        $result = $db->connection->query($sql);
                        $count = mysqli_num_rows($result);
                        while($row = $result->fetch_assoc()) {

                            $result_NICKNAME = htmlspecialchars($row['NICKNAME']);
                            $result_STARTED = htmlspecialchars($row['STARTED']);
                            $result_ID = htmlspecialchars($row['ID']);
                            $result_DISASTERNAME = htmlspecialchars($row['DISASTERNAME']);
                            $result_COLOR = $row['COLOR'];

                            ?>

                            <div class="col-lg-4">
                                <a href="confirmDisaster.php?id=<?php echo $row['ID']; ?>" class="list-group-item">
                                    <p class="list-group-item-text pull-right"><?php echo converttoformaldatetimestring($result_STARTED); ?></p>
                                    <h2 class="list-group-item-heading"><?php echo $result_NICKNAME; ?></h2>
                                    <h4><span class="glyphicon glyphicon-stop" style="color: <?php echo $result_COLOR;   ?>"></span> <?php echo $result_DISASTERNAME; ?></h4>

                                    <?php
                                    $sql2 = 'SELECT ID
                                                 FROM disaster_reports
                                                 WHERE ISVERIFIED = 0
                                                 AND DECLAREID = ' . $result_ID;
                                    $result2 = $db->connection->query($sql2);
                                    $count2 = mysqli_num_rows($result2);

                                    $sql2 = 'SELECT ID
                                                     FROM evacuation_report
                                                     WHERE ISVERIFIED = 0
                                                     AND DECLAREID = ' . $result_ID;
                                    $result2 = $db->connection->query($sql2);
                                    $count2 += mysqli_num_rows($result2);
                                    if($count2 > 0){
                                    ?>
                                    <h4><span class="label label-danger"><?php echo $count2; ?> Pending Report<?php if($count2 > 1) {echo 's';} ?></span></h4>
                                    <?php }  ?>
                                    <div style="clear: both;"></div>
                                </a>
                                <br/>
                            </div>
                            <?php
                        }
                        ?>
             



                </div>
            </div>

</div>
<!--FOOTER HERE-->
<?php include('library/html/footer.php'); ?>

<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
<script src="js/1.11.3_jquery.min.js"></script>
<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="js/bootstrap.min.js"></script>
<script src="js/app/mylibrary.js"></script>
<script src="js/app/messagealert.js"></script>
<script src="js/jquery.datetimepicker.full.min.js"></script>
<script src="js/jquery.form.min.js"></script>

</body>
</html>


<script>

    $(function () {
        $('[data-toggle="popover"]').popover()
    });

    $('#disasterAdd_STARTED').datetimepicker({
        mask:'9999/19/39 29:59'
    });

    $('#disasterAdd_ENDED').datetimepicker({
        mask:'9999/19/39 29:59'
    });

    var DAForm = {
        id: document.getElementById('disasterAddForm'),
        disaster: document.getElementById('disasterAdd_DISASTER'),
        nickname: document.getElementById('disasterAdd_NICKNAME'),
        started: document.getElementById('disasterAdd_STARTED'),
        ended: document.getElementById('disasterAdd_ENDED'),
        comment: document.getElementById('disasterAdd_COMMENT'),
        barangay: document.getElementById('disasterAdd_BARANGAY'),
        city: document.getElementById('disasterAdd_City'),
        submit: 'disasterAdd_SUBMIT',
        msgbox: 'disasterAdd_msgbox'
    };

    DAForm.id.onsubmit = function (e) {
        e.preventDefault();
        DAForm.nickname.value = DAForm.nickname.value.trim();

        if(isWhitespace(DAForm.disaster.value))
        {
            createmessage(3, 'Please select a disaster.',  DAForm.msgbox);
            return false;
        }
        else if(isWhitespace(DAForm.nickname.value))
        {
            createmessage(3, 'Nickname cannot be whitespace.',  DAForm.msgbox);
            return false;
        }
        else if(haswrongspaces(DAForm.nickname.value))
        {
            createmessage(3, 'Please Check your nickname. Double space or more is not allowed.',  DAForm.msgbox);
            return false;
        }
        else if(isbelow(2, DAForm.nickname.value))
        {
            createmessage(3, 'Nickname must be at least 2 characters.',  DAForm.msgbox);
            return false;
        }
        else if(isWhitespace(DAForm.started.value))
        {
            createmessage(3, 'Please enter the date and time when the disaster happened',  DAForm.msgbox);
            return false;
        }
        else if(isWhitespace(DAForm.ended.value))
        {
            createmessage(3, 'Please enter the date and time when the disaster ended',  DAForm.msgbox);
            return false;
        }


        if (confirm('Please confirm the form to submit: \n' +
            '\nDisaster: ' + document.getElementById('disaster_type_' + DAForm.disaster.value).innerHTML +
            '\nNickname: ' + DAForm.nickname.value +
            '\nDate Started: ' + DAForm.started.value+
            '\nDate Ended: ' + DAForm.ended.value))
        {

        }
        else
        {
            return false;
        }

        $(this).ajaxSubmit({
            beforeSend:function()
            {
                $(DAForm.submit).button('loading');
            },
            uploadProgress:function(event,position,total,percentCompelete)
            {

            },
            success:function(data)
            {
                $(DAForm.submit).button('reset');
                var server_message = data.trim();
                if(!isWhitespace(GetSuccessMsg(server_message)))
                {
                    createmessage(1, 'You have successfully submitted the disaster. <a href="BrgyOnGoingDisasterList.php">Click Here to manage On-Going Disaster.</a>',  DAForm.msgbox);
                    location.reload();
                    DAForm.id.reset();
                    
                }
                else if(server_message == 'error')
                {
                    createmessage(3, 'There is a problem with submitting your report.',  DAForm.msgbox);
                }
                else if(!isWhitespace(GetSuccessMsg(server_message)))
                {
                    createmessage(1, GetSuccessMsg(server_message),  DAForm.msgbox);
                }
                else if(!isWhitespace(GetWarningMsg(server_message)))
                {
                    createmessage(2, GetWarningMsg(server_message),  DAForm.msgbox);
                }
                else if(!isWhitespace(GetErrorMsg(server_message)))
                {
                    createmessage(3, GetErrorMsg(server_message),  DAForm.msgbox);
                }
                else if(!isWhitespace(GetServerMsg(server_message)))
                {
                    createmessage(4, GetServerMsg(server_message),  DAForm.msgbox);
                }
                else
                {
                    createmessage(3, '<b>Oh Snap!</b> There is a problem with the server or your connection.', DAForm.msgbox);
                }
            }
        });
    };
</script>


************************************************



**************************************************************************************************************

<div class="modal fade" id="ConfirmDisasterModal" tabindex="-1" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
                <h4 class="modal-title">Complete Report</h4>
            </div>
            <form id="ConfirmDisasterForm" method="post" action="library/form/CswdConfirmDisasterForm.php">
                <div class="modal-body">
                    <div id="ConfirmDisasterForm_msgbox" tabindex="0"></div>
                    <input type="text" name="id" style="display: none;" value="<?php echo $result_ID; ?>" />
                    <p>
                        By confirming this disaster declare means every report and update was already encoded in the system, and you cannot encode report anymore.
                    </p>
                    <?php
                    $sql = "SELECT * FROM disaster_factors WHERE TYPE_ID=" . $result_DISASTERID;
                    $result = $db->connection->query($sql);
                    $count = mysqli_num_rows($result);
                    if($count > 0){
                        ?>
                        <br />
                        <p>Please enter the following info about the <?php echo $result_DISASTERNAME; ?>.</p>
                        <?php
                        while ($row = $result->fetch_assoc()){
                            ?>
                            <div class="input-group input-group">
                                <span class="input-group-addon" id="sizing-addon1"><?php echo $row['FACTOR_NAME']; ?>: </span>
                                <input type="number" name="FACTOR_<?php echo $row['ID']; ?>" value="0.00" step="0.1" min="0.00" class="form-control" required/>
                                <span class="input-group-addon" id="basic-addon2"><?php echo $row['UNIT']; ?></span>
                            </div>
                            <br />
                            <?php
                        }
                    }
                    ?>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Close</button>
                    <button type="submit" id="ConfirmDisasterForm_SUBMIT" class="btn btn-success" data-loading-text="Confirming..."><span class="glyphicon glyphicon-check"></span> Complete</button>
                </div>
            </form>
        </div>
    </div>
</div>

<!--Delete Cost of Assistance-->
<div class="modal fade" id="DeleteCOAModal" tabindex="-1" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
                <h4 class="modal-title">Delete Cost of Assistance</h4>
            </div>
            <form id="DeleteCOAForm" method="post" action="library/form/CswdDeleteCOAForm.php">
                <div class="modal-body">
                    <div id="DeleteCOAForm_msgbox" tabindex="0"></div>
                    <div><input type="text" id="DeleteCOAForm_ID" name="ID" style="display: none;"></div>
                    <p>Do you want to delete this record?:</p>
                    <table class="table">
                        <thead>
                        <tr>
                            <td></td>
                            <td><b>Cost of Assistance</b></td>
                        </tr>
                        </thead>
                        <tbody>
                        <tr>
                            <td>Date/Time Encoded: </td>
                            <td id="DeleteCOAForm_datetime"></td>
                        </tr>
                        <tr>
                            <td>DSWD: </td>
                            <td id="DeleteCOAForm_DSWD"></td>
                        </tr>
                        <tr>
                            <td>LGUs: </td>
                            <td id="DeleteCOAForm_LGU"></td>
                        </tr>
                        <tr>
                            <td>NGOs/Other GOs: </td>
                            <td id="DeleteCOAForm_NGO"></td>
                        </tr>
                        <tr>
                            <td>Total: </td>
                            <td id="DeleteCOAForm_total"></td>
                        </tr>
                        </tbody>
                    </table>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Close</button>
                    <button type="submit" id="DeleteCOAForm_SUBMIT" class="btn btn-danger" data-loading-text="Deleting..."><span class="glyphicon glyphicon-trash"></span> Delete</button>
                </div>
            </form>
        </div>
    </div>
</div>

<!--Update Cost Of Assistance-->
<div class="modal fade" id="UpdateCOAModal" tabindex="-1" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title">Update Cost Of Assistance</h4>
            </div>
            <form id="UpdateCOAForm" method="post" action="library/form/CswdUpdateCOAForm.php">
                <div class="modal-body">
                    <div id="UpdateCOA_msgbox" tabindex="0"></div>
                    <input type="text" name="DECLAREID" style="display: none;" value="<?php echo $result_ID; ?>">
                    <div class="input-group input-group">
                        <span class="input-group-addon" id="sizing-addon1">DSWD: ₱</span>
                        <input type="number" id="UpdateCOAForm_DSWD" name="DSWD" value="" min="0" class="form-control">
                    </div>
                    <br />
                    <div class="input-group input-group">
                        <span class="input-group-addon" id="sizing-addon1">LGUs: ₱</span>
                        <input type="number" id="UpdateCOAForm_LGU" name="LGU" value="" min="0" class="form-control">
                    </div>
                    <br />
                    <div class="input-group input-group">
                        <span class="input-group-addon" id="sizing-addon1">NGOs/Other GOs: ₱</span>
                        <input type="number" id="UpdateCOAForm_NGO" name="NGO" value="" min="0" class="form-control">
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                    <button type="submit" id="UpdateCOAForm_SUBMIT" data-loading-text="Updating..." class="btn btn-primary">Update</button>
                </div>
            </form>
        </div>
    </div>
</div>

<!--Accept Evacuation Report Modal-->
<div class="modal fade" id="AcceptEvacReportModal" tabindex="-1" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title">Accept a Report</b></h4>
            </div>
            <form id="AcceptEvacForm" method="post" action="library/form/CswdAcceptEvacReportForm.php">
                <input type="text" id="AcceptEvacForm_ID" name="ID" style="display: none;" />
                <div class="modal-body">
                    <div id="AcceptEvacForm_msgbox" tabindex="0"></div>
                    <p>Please review the report of <b id="AcceptEvacForm_REPORTER"></b> before accepting it.</p>
                    <table class="table">
                        <tr>
                            <td><b>Persons Served: </b></td>
                            <td id="AcceptEvacForm_PERSONS"></td>
                        </tr>
                        <tr>
                            <td><b>Families Served: </b></td>
                            <td id="AcceptEvacForm_FAMILIES"></td>
                        </tr>
                        <tr>
                            <td><b>Date Time: </b></td>
                            <td id="AcceptEvacForm_DATETIME"></td>
                        </tr>
                    </table>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                    <button type="submit" id="AcceptEvacForm_SUBMIT" data-loading-text="Accepting..." class="btn btn-success">Accept</button>
                </div>
            </form>
        </div>
    </div>
</div>

<!--Update Evacuation Reports Modal or Send Update-->
<div class="modal fade" id="UpdateEvacuationModal" tabindex="-1" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title">Send an Evacuation Report for: <b id="UpdateEvacuationModalLabel_Name"></b></h4>
            </div>
            <form id="EvacuationReportForm" method="post" action="library/form/CswdEvacuationReportForm.php">
                <div class="modal-body">
                    <div id="ER_msgbox" tabindex="0"></div>
                    <input type="text" id="EvacuationReportForm_DECLAREID" name="DECLAREID" style="display: none;" value="<?php echo $result_ID; ?>">
                    <input type="text" id="EvacuationReportForm_EVACID" name="EVACID" style="display: none;" />
                    <div class="input-group input-group">
                        <span class="input-group-addon" id="sizing-addon1">Persons Served: </span>
                        <input type="number" id="EvacuationReportForm_PERSONS" name="PERSONS" value="" min="0" class="form-control">
                    </div>
                    <br />
                    <div class="input-group input-group">
                        <span class="input-group-addon" id="sizing-addon1">Families Served: </span>
                        <input type="number" id="EvacuationReportForm_FAMILIES" name="FAMILIES" value="" min="0" class="form-control">
                    </div>
                    <br />
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                    <button type="submit" id="EvacuationReportForm_SUBMIT" data-loading-text="Sending Report..." class="btn btn-primary">Send Update</button>
                </div>
            </form>
        </div>
    </div>
</div>

<!--Add Evacuation Modal-->
<div class="modal fade" id="AddEvacuationModal" tabindex="-1" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title">Add Evacuation Center for <b><?php echo $result_NICKNAME; ?></b></h4>
            </div>
            <form id="AddEvacuationForm" method="post" action="library/form/CswdAddEvacuationForm.php">
                <div class="modal-body">
                    <div id="AE_msgbox" tabindex="0"></div>
                    <p>Select Evacuation Center in the map.</p>
                    <div class="input-group">
                        <span class="input-group-addon" id="basicasdsaasdon1"><span class="glyphicon glyphicon-map-marker"></span> </span>
                        <div class="form-control" style="height: 300px; text-align: center;">
                            <div id="map" style="height: 100%; width: 100%;" tabindex="0"> </div>
                        </div>
                    </div>
                    <br />
                    <input type="text" id="AddEvacuationForm_DECLAREID" name="DECLAREID" value="<?php echo $result_ID; ?>" style="display: none;">
                    <input type="text" id="AddEvacuationForm_EVACID" name="EVACID" style="display: none;">
                    <table class="table">
                        <tr>
                            <th>Name:</th>
                            <td id="S_EvacName"></td>
                        </tr>
                        <tr>
                            <th>Address:</th>
                            <td id="S_EvacAddress"></td>
                        </tr>
                        <tr>
                            <th>Barangay:</th>
                            <td id="S_EvacBrgy"></td>
                        </tr>
                    </table>
                    <br />
                    <div class="input-group input-group">
                        <span class="input-group-addon" id="sizing-addon1">Persons Served: </span>
                        <input type="number" id="AddEvacuationForm_PERSONS" name="PERSONS" value="" min="0" class="form-control">
                    </div>
                    <br />
                    <div class="input-group input-group">
                        <span class="input-group-addon" id="sizing-addon1">Families Served: </span>
                        <input type="number" id="AddEvacuationForm_FAMILIES" name="FAMILIES" value="" min="0" class="form-control">
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                    <button type="submit" id="AddEvacuationForm_SUBMIT" data-loading-text="Adding Evacuation..." class="btn btn-primary">Add</button>
                </div>
            </form>
        </div>
    </div>
</div>

<!--Disaster Report Modal-->
<div class="modal fade" id="DisasterReportModal" tabindex="-1" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title">Add a Verified Disaster Report for <b><?php echo $result_NICKNAME; ?></b></h4>
            </div>
            <form id="DisasterReportForm" method="post" action="library/form/CswdDisasterReportForm.php">
                <div class="modal-body">
                    <div id="DR_msgbox" tabindex="0"></div>
                    <div class="panel panel-default">
                        <input type="text" value="<?php echo $result_ID; ?>" name="DECLARE" style="display: none;" />
                        <input type="text" value="<?php echo $brgy_id; ?>" name="BARANGAY" style="display: none;" />
                        <div class="panel-heading">Casualties</div>
                        <div class="panel-body">
                            <div class="input-group input-group">
                                <span class="input-group-addon" id="sizing-addon1">Dead</span>
                                <input type="number" id="DisasterReportForm_DEAD" name="DEAD" value="" min="0" class="form-control" aria-describedby="sizing-addon1">
                            </div>

                            <br />

                            <div class="input-group input-group">
                                <span class="input-group-addon" id="sizing-addon1">Injured</span>
                                <input type="number" id="DisasterReportForm_INJURED" name="INJURED" value="" min="0" class="form-control" aria-describedby="sizing-addon1">
                            </div>

                            <br />

                            <div class="input-group input-group">
                                <span class="input-group-addon" id="sizing-addon1">Missing</span>
                                <input type="number" id="DisasterReportForm_MISSING" name="MISSING" value="" min="0" class="form-control" aria-describedby="sizing-addon1">
                            </div>
                        </div>
                    </div>

                    <br />

                    <div class="panel panel-default">
                        <div class="panel-heading">Damages</div>
                        <div class="panel-body">
                            <div class="input-group input-group">
                                <span class="input-group-addon" id="sizing-addon1">Totally</span>
                                <input type="number" id="DisasterReportForm_TOTALLY" name="TOTALLY" value="" min="0" class="form-control" aria-describedby="sizing-addon1">
                            </div>

                            <br />

                            <div class="input-group input-group">
                                <span class="input-group-addon" id="sizing-addon1">Partially</span>
                                <input type="number" id="DisasterReportForm_PARTIALLY" name="PARTIALLY" value="" min="0" class="form-control" aria-describedby="sizing-addon1">
                            </div>

                            <br />
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                    <button type="submit" id="DisasterReportForm_SUBMIT" data-loading-text="Sending Report" class="btn btn-primary">Send</button>
                </div>
            </form>
        </div>
    </div>
</div>

<!--Accept Report Modal-->
<div class="modal fade" id="AcceptReportModal" tabindex="-1" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title">Accept a Report</b></h4>
            </div>
            <form id="AcceptForm" method="post" action="library/form/CswdAcceptReportForm.php">
                <input type="text" id="AcceptForm_ID" name="ID" style="display: none;" />
                <div class="modal-body">
                    <div id="AcceptModal_msgbox" tabindex="0"></div>
                    <p>Please review the report of <b id="AcceptForm_REPORTER"></b> before accepting it.</p>
                    <table class="table">
                        <tr>
                            <td><b>Dead: </b></td>
                            <td id="AcceptForm_DEAD"></td>
                        </tr>
                        <tr>
                            <td><b>Injured: </b></td>
                            <td id="AcceptForm_INJURED"></td>
                        </tr>
                        <tr>
                            <td><b>Missing: </b></td>
                            <td id="AcceptForm_MISSING"></td>
                        </tr>
                        <tr>
                            <td><b>Totally Damaged: </b></td>
                            <td id="AcceptForm_TOTALLY"></td>
                        </tr>
                        <tr>
                            <td><b>Partially Damaged: </b></td>
                            <td id="AcceptForm_PARTIALLY"></td>
                        </tr>
                        <tr>
                            <td><b>Date Time: </b></td>
                            <td id="AcceptForm_DATETIME"></td>
                        </tr>
                    </table>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                    <button type="submit" id="AcceptForm_SUBMIT" data-loading-text="Accepting..." class="btn btn-success">Accept</button>
                </div>
            </form>
        </div>
    </div>
</div>

<!--End Disaster Modal-->
<div class="modal fade" id="EndDisasterModal" tabindex="-1" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title">End <b><?php echo $result_NICKNAME; ?></b></h4>
            </div>
            <form id="EndDisasterForm" method="post" action="library/form/BrgyEndDisasterForm.php">
                <div class="modal-body">
                    <div id="ED_msgbox" tabindex="0"></div>
                    <?php
                    date_default_timezone_set('Asia/Hong_Kong');
                    $time = time();
                    ?>
                    <input type="text" name="DECLARE" value="<?php echo $result_ID; ?>" style="display: none;" />
                    <div class="input-group input-group">
                        <span class="input-group-addon" id="sizing-addon1">When did the disaster ended?</span>
                        <input type="text" id="EndDisasterForm_ENDED" name="ENDED" class="form-control" value="<?php echo date("Y/m/d H:i", $time); ?>" required/>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                    <button type="submit" id="EndDisasterForm_SUBMIT" data-loading-text="Ending Disaster..." class="btn btn-danger">End Disaster</button>
                </div>
            </form>
        </div>
    </div>
</div>
*<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<

<?php

    session_start();
    include('library/form/connection.php');
    include('library/function/functions.php');
    $db = new db();

?>


<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="th3515">
    <meta name="author" content="">

    <title>Disaster History | Disaster Risk Management</title>
    <link rel="icon" href="img/favicon.ico">

    <!-- Bootstrap Core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="css/app.css" rel="stylesheet">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.0.3/dist/leaflet.css"
    integrity="sha512-07I2e+7D8p6he1SIM+1twR5TIrhUQn9+I6yjqD53JQjFiMf8EtC93ty0/5vJTZGF8aAocvHYNEDJajGdNx1IsQ=="
   crossorigin=""/>
   

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>

<!-- The #page-top ID is part of the scrolling feature - the data-spy and data-target are part of the built-in Bootstrap scrollspy function -->

<body id="page-top" data-spy="scroll" data-target=".navbar-fixed-top">

   <?php 

include('library/html/navbar.php'); 
include('library/html/loginmodal.php');
   
?>

<!--Site Content-->
<div class="container"> <!--Content starts here-->
<div class = "row">
    <div class="page-header">
        <div style="margin: auto; text-align: center;" class="pull-right">
            <div class="btn-group" role="group" aria-label="...">
                <a href="#" class="btn btn-secondary active">Overall</a>
                <a href="#" class="btn btn-secondary">Per District</a>
                <a href="#" class="btn btn-secondary">Per Barangay</a>
            </div>
        </div>
        <h3>Disaster Archive<small> of the City of Iloilo</small></h3>
    </div>
    <div class="col-lg-8">
            <div id="mapid" style="height: 70vh; width: 100%;" tabindex="0"> </div>
        </div>
    

        <div class="col-lg-4">
        
            <div class="panel panel-default">
                <div class="panel-heading">
            
                <p class= "panel-title" 
                    <span class = "pull-right">

                        <a href = "#" style= "text-decoration: none; color: #777; font-size: 14px;"> Overall </a>
                            |
                            <?php
                                $sql = 'SELECT * FROM disaster_type';
                                $result = $db->connection->query($sql);
                                while ($row = $result->fetch_assoc()){
                                    ?>
                                    <a href = "#" class="glyphicon glyphicon-stop" title = " <?php echo $row['NAME']; ?>" style="color: <?php echo $row['COLOR']; ?>; text-decoration: none;"></a>
                                    <?php
                                }
                                ?>
                    </span>
                 </p>

            </div>
             <div class="panel-body">
                <ul class="list-group" id = "disasterListHTML">
                
                </ul>                    
            </div>
            </div>
            </div>
    
    </div>
    
    <br>

    <div class = "row">
        <div class="panel panel-default">
            <div class="panel-heading">
            <span class="dropdown pull-right">
                        <button class="btn btn-default dropdown-toggle" type="button" data-toggle="dropdown">Overall
                        <span class="caret"></span></button>
                        <ul class="dropdown-menu" id = "declare_listHTML">
                          <li><a href="#">Overall</a></li>
                          <li class="divider"></li>
                          <li class="dropdown-header">Verified Disaster Report</li>
                          <li><a href="#">Example</a></li>
                          <li><a href="#">Example</a></li>
                          <li><a href="#">Example</a></li>
                        
                        </ul>
            </span>
                <h4 id = 'disasterTitleHTML'> Graph Details</h4>
            </div>

            <div class="panel-body">
            

                <div class = "col-lg-3 col-md-3 col-sm-6 col-xs-6">
                   <canvas id="cassualtiesChart" width="10" height="10"></canvas>
                   <center><h5><b> Cassualties </b></h5></center>                  
                </div>
                <div class = "col-lg-3 col-md-3 col-sm-6 col-xs-6">
                    <canvas id="damagedHouses" width="10" height="10"></canvas>                  
                    <center><h5><b> Damaged Houses </b></h5></center>
                </div>
                <div class = "col-lg-3 col-md-3 col-sm-6 col-xs-6">  
                    <canvas id="evacuees" width="10" height="10"></canvas>                  
                    <center><h5><b> Evacuees </b></h5></center>
                </div>                 
                <div class = "col-lg-3 col-md-3 col-sm-6 col-xs-6">    
                    <canvas id="costOfAssistance" width="10" height="10"></canvas>             
                    <center><h5><b> Cost of Assistance </b></h5></center>
                </div>

                <span class = "col-lg-12 col-md-12 col-sm-12 col-xs-12">
                           <br><br>
                            <h4> Evacuation Center used: </h4>
                           
                           <div class="list-group">
                                <div class="list-group" id="evacuation_list">
                                
                                        <a href="#" class="list-group-item"><h4 class="list-group-item-heading">Central Philippine University</h4><div class="list-group-item-text">Half Moon Dr, Lopez, Iloilo City, 5000 Iloilo, Philippines</div><small>Capacity: 350<span class = "pull-right"><small> Duration: 3/28/17 -  4/20/17 </small></span></small></a>
                                         <a href="#" class="list-group-item"><h4 class="list-group-item-heading">Ortiz Gym</h4><div class="list-group-item-text">San Isidro, Iloilo City, 5000 Iloilo, Philippines</div><small>Capacity: 350<span class = "pull-right"><small> Duration: 3/28/17 -  4/20/17 </small></span></small></a>
                                </div>
                            </div>
                </span>

                <span class = "col-lg-12 col-md-12 col-sm-12 col-xs-12">
                        <h4> Images taken: </h4>
                          <div class="list-group">
                                <div class="list-group" id="">
                                    <a href="#" class="list-group-item">
                                    
                                    <!-- conflict @ mobile. 

                                    3 images with both side toggle that slides from left to right width credits to user @ middle-->                         
                                    
                                    <img src = "img/slide1.jpg" title = "ur pussy after i do u" style = "width: 355px; height: 280px;">
                                    <img src = "img/slide2.jpg" title = "west side represent" style = "width: 355px; height: 280px;">
                                    <img src = "img/slide3.jpg" title = "us vs u" style = "width: 355px; height: 280px;">
                                    
                                </a>
                                </div>
                            </div>                        
                </span>
           
            </div>
            
        </div>
    </div>
    </div>

<?php include('library/html/footer.php'); ?>

    <!-- jQuery -->
    <script src="js/jquery.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="js/bootstrap.min.js"></script>
    <script src="js/jquery.easing.min.js"></script>
    <script src="js/app/mylibrary.js"></script>
    <script src="js/app/loginscript.js"></script>

    <script src="js/chart.bundle.min.js"></script>
    <script src="https://unpkg.com/leaflet@1.0.3/dist/leaflet.js"
   integrity="sha512-A7vV8IFfih/D732iSSKi20u/ooOfj/AGehOKq0f4vLT1Zr2Y+RX7C+w8A1gaSasGtRUZpF/NZgzSAu4/Gc41Lg=="
   crossorigin=""></script>
    
</body>

</html>
<!-- MAP SCRIPTS -->

<script>
    
 var mymap = L.map('mapid').setView([10.69306, 482.57259], 15);

    var popup = L.popup();

    function onMapClick(e) {
        popup
            .setLatLng(e.latlng)
            .setContent("You clicked the map at " + e.latlng.toString())
            .openOn(mymap);
    }

    mymap.on('click', onMapClick);


    L.tileLayer('https://api.mapbox.com/styles/v1/mapbox/streets-v10/tiles/256/{z}/{x}/{y}?access_token=pk.eyJ1IjoiY2Rycm1vIiwiYSI6ImNqMzBhZXQxNDAwYWszMnFuejIyNG80cDkifQ.HQTrzbN7u43NV496Hujsnw', {
        attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery © <a href="http://mapbox.com">Mapbox</a>',
        maxZoom: 18,
        id: 'mapbox.mapbox-streets-v7',
        accessToken: 'pk.eyJ1IjoiY2Rycm1vIiwiYSI6ImNqMzBhZXQxNDAwYWszMnFuejIyNG80cDkifQ.HQTrzbN7u43NV496Hujsnw'
    }).addTo(mymap);

</script>


<!-- Disaster Details Scripts -->

<script>

           
$('.list-group-item').on('click', function() {
    var $this = $(this);
    var $alias = $this.data('');

    $('.active').removeClass('active');
    $this.toggleClass('active')

    // Pass clicked link element to another function
    myfunction($this, $alias)
})

function myfunction($this) {
    console.log($this.text());  // Will log Paris | France | etc...

    console.log($alias);  // Will output whatever is in data-alias=""
}





// <!-- CHART SCRIPTS -->

var ctx = document.getElementById("cassualtiesChart");
var myChart = new Chart(ctx, {
    type: 'pie',
    data: {
        labels: ["Dead", "Injured", "Missing"],
        datasets: [{
            label: '# of Cassualties',
            data: [100,150,250],
            backgroundColor: [
            'rgba(237,153,91,0.8)',
            'rgba(245,79,85,0.8)',
            'rgba(203,80,80,0.8)'
           ],
            borderColor: [
            'rgba(237,153,91,1)',
            'rgba(245,79,85,1)',
            'rgba(203,80,80,1)'
            ],
            borderWidth: 1
        }]
    },
    options: {
                animation:{
                    animateScale:true
                }
            }
});

var ctx = document.getElementById("damagedHouses");
var myChart = new Chart(ctx, {
    type: 'pie',
    data: {
        labels: ["Totally Damaged", "Partially Damaged"],
        datasets: [{
            label: '# of Damaged Houses',
            data: [550,235],
            backgroundColor: [
                'rgba(203,80,80,0.8)',
                'rgba(232,226,214,0.8)'
            ],
            borderColor: [
                'rgba(203,80,80,1)',
                'rgba(232,226,214,1)'
            ],
            borderWidth: 1
        }]
    },
    options: {
                animation:{
                    animateScale:true
                }
            }
});


var ctx = document.getElementById("evacuees");
var myChart = new Chart(ctx, {
    type: 'pie',
    data: {
        labels: ["Evacuees", "Remaining Population"],
        datasets: [{
            label: '# of Votes',
            data: ['700', '5000'],
            backgroundColor: [
                'rgba(143,136,86,0.8)',
                'rgba(237,153,91,0.8)'
            
            ],
            borderColor: [
              'rgba(143,136,86,1)',
              'rgba(237,153,91,1)'
            
            ],
            borderWidth: 1
        }]
    },
    options: {
                animation:{
                    animateScale:true
                }
            }
});


var ctx = document.getElementById("costOfAssistance");
var myChart = new Chart(ctx, {
    type: 'polarArea',
    data: {
        datasets: [{
        data: ['355','235','1123'],
        
        backgroundColor: [

            'rgba(237,153,91,0.8)',
            'rgba(245,79,85,0.8)',
            'rgba(203,80,80,0.8)'
            ],
        
        borderColor: [
          
            'rgba(237,153,91,1)',
            'rgba(245,79,85,1)',
            'rgba(203,80,80,1)'
            ],
            borderWidth: 1
    }],

    labels: [
        'DSWD',
        'LGU',
        'NGO',
    ]

    },
    options: {
                animation:{
                    animateScale:true
                }
            }
});
</script>




**************************************************************

<?php
session_start();
include ('library/form/CdrrmoOnly.php');
include('library/form/connection.php');
include('library/function/functions.php');
$db = new db();

$search = isset($_GET['search']) ? $_GET['search'] : '';
$limit = 10;

$total_sql = 'SELECT 
barangay.ID, 
barangay.NAME,
district.NAME AS DISTRICT, 
city.NAME AS CITY, 
barangay_info.AREA AS AREA
FROM (SELECT * FROM barangay WHERE barangay.NAME LIKE "%'.$search.'%") AS barangay
LEFT JOIN district ON barangay.DISTRICT = district.ID
LEFT JOIN city ON district.CITY = city.ID
LEFT JOIN barangay_info ON barangay.ID = barangay_info.BARANGAY
GROUP BY barangay.ID';

$total_result = $db->connection->query($total_sql);
$total_count = mysqli_num_rows($total_result);
$total_page = ceil($total_count/$limit);

$page = isset($_GET['page']) && $_GET['page'] > 0 && $_GET['page'] <= $total_page ? $_GET['page'] : '1';
$offset = ($page * $limit) - $limit;

if($page < 2) {
	$disable_previous = 'disabled';
	$disable_previous2 = 'pointer-events: none;';
	$bottom_page = 'display:none';
}
else {
	$disable_previous = '';
	$disable_previous2 = '';
	$bottom_page = '';
}
if($total_page < 2) {
	$top_page = 'display:none';
}
else {
	$top_page = '';
}
if($total_page == $page || $total_page < 1) {
	$disable_next = 'disabled';
	$disable_next2 = 'pointer-events: none;';
	$top_page = 'display:none';
}
else {
	$disable_next = '';
	$disable_next2 = '';
	$top_page = '';
}
?>

<html lang="en">
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="th3515">
    <meta name="author" content="@pablongbuhaymo">

    <title>Manage Barangays | City Disaster Risk Management</title>    
    <link rel="icon" href="img/favicon.ico">

    <!-- Bootstrap Core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="css/app.css" rel="stylesheet">

   <link rel="stylesheet" href="https://unpkg.com/leaflet@1.0.3/dist/leaflet.css"
    integrity="sha512-07I2e+7D8p6he1SIM+1twR5TIrhUQn9+I6yjqD53JQjFiMf8EtC93ty0/5vJTZGF8aAocvHYNEDJajGdNx1IsQ=="
   crossorigin=""/>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>
<body role="document">

<!-- Modals -->

<!-- Add Barangay Modal -->
<div class="modal fade" id="AddBarangayModal" tabindex="-1" role="dialog">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
				<h4 class="modal-title">Add New Barangay</h4>
			</div>
			
			<!-- Add Barangay Form -->
			<form id="AddBarangayForm" method="post" action="library/form/AddBarangayForm.php">
				<div class="modal-body">
					<div id="AB_msgbox" tabindex="0"></div>
					
					<!-- MAP SOON HERE-->
					
					
					<!-- Infomation -->
					<div class="panel panel-default">
						<div class="panel-heading">Information</div>
						<div class="panel-body">
						
							<!-- Name -->
							<div class="input-group">
								<span class="input-group-addon" id="sizing-addon1">Name: </span>
								<input type="text" id="AddBarangayForm_NAME" name="NAME" maxlength="50" class="form-control" required />
							</div>
							<br />
							
							<!-- District -->
							<div class="input-group">
								<span class="input-group-addon" id="sizing-addon1">District: </span>
								<select class="form-control" id="AddBarangayForm_DISTRICT" name="DISTRICT">
									<?php
									$district_sql = "SELECT * FROM district ORDER BY NAME";
									$district_result = $db->connection->query($district_sql);
									while($district_row = $district_result->fetch_assoc()) {
										?>
										<option value="<?php echo $district_row["ID"]; ?>" id="add_district_<?php echo $district_row["ID"]; ?>"><?php echo $district_row["NAME"]; ?></option>
										<?php
									}
									?>
								</select>
							</div>
							<br />
							
						</div>
					</div>
					
					<!-- Population -->
					<div class="panel panel-default">
						<div class="panel-heading">Details</div>
						<div class="panel-body">
						
							<!-- Men -->
							<div class="input-group">
								<span class="input-group-addon" id="sizing-addon1">Men: </span>
								<input type="number" id="AddBarangayForm_MEN" name="MEN" value=0 maxlength="5" class="form-control" />
							</div>
							<br />
							
							<!-- Women -->
							<div class="input-group">
								<span class="input-group-addon" id="sizing-addon1">Women: </span>
								<input type="number" id="AddBarangayForm_WOMEN" name="WOMEN" value=0 maxlength="5" class="form-control" />
							</div>
							<br />
							
							<!-- Minors -->
							<div class="input-group">
								<span class="input-group-addon" id="sizing-addon1">Minors: </span>
								<input type="number" id="AddBarangayForm_MINORS" name="MINORS" value=0 maxlength="5" class="form-control" />
							</div>
							<br />
							
							<!-- Adults -->
							<div class="input-group">
								<span class="input-group-addon" id="sizing-addon1">Adults: </span>
								<input type="number" id="AddBarangayForm_ADULTS" name="ADULTS" value=0 maxlength="5" class="form-control" />
							</div>
							<br />
						
							<!-- PWD -->
							<div class="input-group">
								<span class="input-group-addon" id="sizing-addon1">PWDs: </span>
								<input type="number" id="AddBarangayForm_PWD" name="PWD" value=0 maxlength="5" class="form-control" />
							</div>
							<br />

							<!-- Concrete Houses -->
							<div class="input-group">
								<span class="input-group-addon" id="sizing-addon1">Concrete: </span>
								<input type="number" id="AddBarangayForm_CONCRETE" name="CONCRETE" value=0 maxlength="5" class="form-control" />
							</div>
							<br />

							<!-- Light Houses -->
							<div class="input-group">
								<span class="input-group-addon" id="sizing-addon1">Light: </span>
								<input type="number" id="AddBarangayForm_LIGHT" name="LIGHT" value=0 maxlength="5" class="form-control" />
							</div>
							<br />

							<!-- Both Houses -->
							<div class="input-group">
								<span class="input-group-addon" id="sizing-addon1">Both: </span>
								<input type="number" id="AddBarangayForm_BOTH" name="BOTH" value=0 maxlength="5" class="form-control" />
							</div>
							<br />

							<!-- Area -->
							<div class="input-group">
								<span class="input-group-addon" id="sizing-addon1">Area: </span>
								<input type="number" id="AddBarangayForm_AREA" name="AREA" value=0 maxlength="5" step="0.01" class="form-control" />
							</div>
							<br />

						</div>
					</div>
					
				</div>
				
				<!-- Submission -->
				<div class="modal-footer">
					<button type="submit" id="AddBarangayForm_SUBMIT" data-loading-text="Adding Barangay..." class="btn btn-primary">Add Barangay</button>
					<button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
				</div>
				
			</form>
			
		</div>
	</div>
</div>

<!-- Update Barrangay Modal -->
<div class="modal fade" id="UpdateBarangayModal" tabindex="-1" role="dialog">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
				<h4 class="modal-title">Update Barangay</h4>
			</div>

			<!-- Update Barangay Form -->
			<form id="UpdateBarangayForm" method="post" action="library/form/UpdateBarangayForm.php">
				<div class="modal-body">
					<div id="UB_msgbox" tabindex="0"></div>
					
					<input type="hidden" id="UpdateBarangayForm_ID" name="ID" required />
					<!-- Infomation -->
					<div class="panel panel-default">
						<div class="panel-heading">Information</div>
						<div class="panel-body">
						
							<!-- Name -->
							<div class="input-group">
								<span class="input-group-addon" id="sizing-addon1">Name: </span>
								<input type="text" id="UpdateBarangayForm_NAME" name="NAME" maxlength="50" class="form-control" required />
							</div>
							<br />
							
							<!-- District -->
							<div class="input-group">
								<span class="input-group-addon" id="sizing-addon1">District: </span>
								<select class="form-control" id="UpdateBarangayForm_DISTRICT" name="DISTRICT">
									<?php
									$district_sql = "SELECT * FROM district ORDER BY NAME";
									$district_result = $db->connection->query($district_sql);
									while($district_row = $district_result->fetch_assoc()) {
										?>
										<option value="<?php echo $district_row["ID"]; ?>" id="add_district_<?php echo $district_row["ID"]; ?>"><?php echo $district_row["NAME"]; ?></option>
										<?php
									}
									?>
								</select>
							</div>
							<br />
						</div>
					</div>
						
				</div>
					
				<!-- Submission -->
				<div class="modal-footer">
					<button type="submit" id="UpdateBarangayForm_SUBMIT" data-loading-text="Updating Barangay..." class="btn btn-primary">Update Barangay</button>
					<button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
				</div>
			</form>
		</div>
	</div>
</div>

<!-- Update Barrangay Info Modal -->
<div class="modal fade" id="UpdateBarangayModal2" tabindex="-1" role="dialog">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
				<h4 class="modal-title">Update Barangay Information</h4>
			</div>
				
			<!-- Update Barangay Form 2-->
			<form id="UpdateBarangayForm2" method="post" action="library/form/UpdateBarangayForm2.php">
				<div class="modal-body">
					<div id="UB_msgbox2" tabindex="0"></div>
					
					<!-- ID -->
					<input type="hidden" id="UpdateBarangayForm2_ID" name="ID" required />					
					
					<!-- Men -->
					<div class="input-group">
						<span class="input-group-addon" id="sizing-addon1">Men: </span>
						<input type="number" id="UpdateBarangayForm_MEN" name="MEN" value=0 maxlength="5" class="form-control" />
					</div>
					<br />
					
					<!-- Women -->
					<div class="input-group">
						<span class="input-group-addon" id="sizing-addon1">Women: </span>
						<input type="number" id="UpdateBarangayForm_WOMEN" name="WOMEN" value=0 maxlength="5" class="form-control" />
					</div>
					<br />
					
					<!-- Minors -->
					<div class="input-group">
						<span class="input-group-addon" id="sizing-addon1">Minors: </span>
						<input type="number" id="UpdateBarangayForm_MINORS" name="MINORS" value=0 maxlength="5" class="form-control" />
					</div>
					<br />
					
					<!-- Adults -->
					<div class="input-group">
						<span class="input-group-addon" id="sizing-addon1">Adults: </span>
						<input type="number" id="UpdateBarangayForm_ADULTS" name="ADULTS" value=0 maxlength="5" class="form-control" />
					</div>
					<br />
				
					<!-- PWD -->
					<div class="input-group">
						<span class="input-group-addon" id="sizing-addon1">PWDs: </span>
						<input type="number" id="UpdateBarangayForm_PWD" name="PWD" value=0 maxlength="5" class="form-control" />
					</div>
					<br />
							
					<!-- Concrete Houses -->
					<div class="input-group">
						<span class="input-group-addon" id="sizing-addon1">Concrete: </span>
						<input type="number" id="UpdateBarangayForm_CONCRETE" name="CONCRETE" value=0 maxlength="5" class="form-control" />
					</div>
					<br />

					<!-- Light Houses -->
					<div class="input-group">
						<span class="input-group-addon" id="sizing-addon1">Light: </span>
						<input type="number" id="UpdateBarangayForm_LIGHT" name="LIGHT" value=0 maxlength="5" class="form-control" />
					</div>
					<br />

					<!-- Both Houses -->
					<div class="input-group">
						<span class="input-group-addon" id="sizing-addon1">Both: </span>
						<input type="number" id="UpdateBarangayForm_BOTH" name="BOTH" value=0 maxlength="5" class="form-control" />
					</div>
					<br />

					<!-- Area -->
					<div class="input-group">
						<span class="input-group-addon" id="sizing-addon1">Area: </span>
						<input type="double" id="UpdateBarangayForm_AREA" name="AREA" value=0 maxlength="30"  class="form-control" />
					</div>
					<br />
				</div>
				
				<!-- Submission -->
				<div class="modal-footer">
					<button type="submit" id="UpdateBarangayForm_SUBMIT2" data-loading-text="Updating Barangay..." class="btn btn-primary">Update Barangay</button>
					<button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
				</div>
			
			</form>
		</div>
	</div>
</div>

<!-- View Barrangay Info Modal -->
<div class="modal fade" id="ViewBarangayModal" tabindex="-1" role="dialog">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
				<h4 class="modal-title">Barangay Information Overview</h4>
			</div>
				
			<!-- View Barangay Modal-->
			<div class="modal-body">
					<!-- ID -->
					<input type="hidden" id="UpdateBarangayForm2_ID" name="ID" required />					
					<h1 class = "text-center" id = "viewModalBrgy"></h1>
					<h5 class = "text-center greyFont" style = "font-size:18px;" id = "viewModalArea"></h5>	
					<br />

						<span class = "col-lg-4">
						<h4> Gender</h4><hr>
					   <canvas id="cassualtiesChart" width="55" height="100%"></canvas>
						<h6 id = "viewModalPopulation"></h6>
						</span>					
											
						<span class = "col-lg-4">
							<h4> Age Group</h4><hr>
					   <canvas id="ageDifference" width="55" height="100%"></canvas>
						<h6 id = "viewModalPWD"></h6>
						</span>					
											
						<span class = "col-lg-4">
						<h4> House Type </h4><hr>
					   <canvas id="houseType" width="55" height="100%"></canvas>
						<h6 id = "viewModalHouseTotal"></h6>
						<br />
						</span>					

				</div>
				
				<!-- Submission -->
				<div class="modal-footer">
					<a href="overview.php" class="btn btn-success">Location</a>
					<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
				</div>
			
			</form>
		</div>
	</div>
</div>



<!-- Content starts here -->
<?php include('library/html/navbar.php'); ?>

<div class="container">
    <div class="page-header">
		<button class="btn btn-secondary pull-right" data-toggle="modal" data-target="#AddBarangayModal">
			<span class="glyphicon glyphicon-plus"></span> Add New Barangay
		</button>
        <h3>Barangay Management</h3>
    </div>
	
	<!-- Barangay Search Bar -->
	<div class="row">
		<div class="col-md-6 col-md-offset-3">
			<form id="SearchForm" method="get">
				<div class="input-group">
					<input id="SearchInput" name="search" type="text" class="form-control" placeholder="Search.." value="<?php echo $search; ?>" />
					<span class="input-group-btn">
						<button id="SearchSubmit" class="btn btn-secondary" type="submit"><span class="glyphicon glyphicon-search"></span>&nbsp Search</button>
					</span>
				</div>
			</form>
		</div>
	</div>
	
	<!-- Barangay List -->
	<table class="table table-striped table-hover">
		<thead>
		<tr>
			<th>Name</th>
			<th>District</th>
			<th>City</th>
			<th>Area</th>
			<th>Overview</th>
			<th>Actions</th>
		</tr>
		</thead>
		<tbody id="PageComponent_BRLIST">
		</tbody>
	</table>
	<div id="pagemessagebox" tabindex="0"></div>
	
	<!-- Pagination -->
	<ul class="pager">
		<li style="<?php echo $bottom_page; ?>">
			<a href="BarangayManagement.php?search=<?php echo $search; ?>&page=1" style=""><span class="glyphicon glyphicon-menu-left"></span>&nbsp 1</a>
		</li>
		<li class="<?php echo $disable_previous; ?>">
			<a href="BarangayManagement.php?search=<?php echo $search; ?>&page=<?php echo $page - 1; ?>" style="<?php echo $disable_previous2; ?>"><span class="glyphicon glyphicon-menu-left"></span>&nbsp Previous</a>
		</li>
		<li class="disabled">
			<span><h4 style="margin-top: 0.3rem; margin-bottom: 0.3rem;">Page <?php echo $page; ?></h4></span>
		</li>
		<li class="<?php echo $disable_next; ?>">
			<a href="BarangayManagement.php?search=<?php echo $search; ?>&page=<?php echo $page + 1; ?>" style="<?php echo $disable_next2; ?>">Next&nbsp <span class="glyphicon glyphicon-menu-right"></span></a>
		</li>
		<li style="<?php echo $top_page; ?>">
			<a href="BarangayManagement.php?search=<?php echo $search; ?>&page=<?php echo $total_page; ?>" style=""><?php echo $total_page; ?>&nbsp <span class="glyphicon glyphicon-menu-right"></span></a>
		</li>
	</ul>
</div>


<?php include('library/html/footer.php'); ?>

<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
<script src="js/1.11.3_jquery.min.js"></script>
<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="js/bootstrap.min.js"></script>
<script src="js/app/mylibrary.js"></script>
<script src="js/app/messagealert.js"></script>
<script src="js/jquery.datetimepicker.full.min.js"></script>
<script src="js/jquery.form.min.js"></script>
<script src="js/chart.bundle.min.js"></script>


<!-- Page Script -->
<script>
    var PageComponent = {
        brlist: document.getElementById('PageComponent_BRLIST')
    };
	
	var ABForm = { 
        form: document.getElementById('AddBarangayForm'),
		name: document.getElementById('AddBarangayForm_NAME'),
		district: document.getElementById('AddBarangayForm_DISTRICT'),
		men: document.getElementById('AddBarangayForm_MEN'),
		women: document.getElementById('AddBarangayForm_WOMEN'),
		minors: document.getElementById('AddBarangayForm_MINORS'),
		adults: document.getElementById('AddBarangayForm_ADULTS'),
		pwd: document.getElementById('AddBarangayForm_PWD'),
		light: document.getElementById('AddBarangayForm_LIGHT'),
		concrete: document.getElementById('AddBarangayForm_CONCRETE'),
		both: document.getElementById('AddBarangayForm_BOTH'),
		area: document.getElementById('AddBarangayForm_AREA'),
        submit : '#AddBarangayForm_SUBMIT',
        modal: '#AddBarangayModal',
        msgbox: 'AB_msgbox'
    };
		
	function ResetABForm() {
		ABForm.name.value = '';
		ABForm.district.selectedIndex = 0;
		ABForm.men.value = 0;
		ABForm.women.value = 0;
		ABForm.minors.value = 0;
		ABForm.adults.value = 0;
		ABForm.pwd.value = 0;
	}

	//Async New Barangay Submit 
	ABForm.form.onsubmit = function(e) {
		e.preventDefault();
		$(this).ajaxSubmit({
			beforeSend:function()
			{
				$(ABForm.submit).button('loading');
			},
			uploadProgress:function(event,position,total,percentCompelete)
			{

			},
			success:function(data)
			{
				$(ABForm.submit).button('reset');
				var server_message = data.trim();
				
				if(!isWhitespace(GetSuccessMsg(server_message)))
				{
					createmessagein(1, 'Successfully added barangay!', ABForm.msgbox);
					
					AddBarangay(server_message, ABForm.name.value, ABForm.district.options[ABForm.district.selectedIndex].text, 'Iloilo City', ABFORM.area);
					ResetABForm();
				}
				else if(!isWhitespace(GetWarningMsg(server_message)))
				{
					createmessagein(2, GetWarningMsg(server_message), ABForm.msgbox);
				}
				else if(!isWhitespace(GetErrorMsg(server_message)))
				{
					createmessagein(3, GetErrorMsg(server_message), ABForm.msgbox);
				}
				else if(!isWhitespace(GetServerMsg(server_message)))
				{
					createmessagein(4, GetServerMsg(server_message), ABForm.msgbox);
				}
				else
				{
					createmessagein(3, '<b>Oh Snap!</b> There is a problem with the server or your connection.', ABForm.msgbox);
				}
			}
		});
	};


	
	//Add barangay to list. 

	// *** i added aditional area2 value to successfully pass value in update form 2. notice barangay_area2
	
	function AddBarangay(id, name, district, city, men, women, population, minors, adults, pwd, t_houses, c_houses, l_houses, cl_houses, area) {
        PageComponent.brlist.innerHTML = PageComponent.brlist.innerHTML +
            '<tr>' +
            '   <td id="Barangay_name_' + id + '">' + name + '</td>'+
			'   <td id="Barangay_district_' + id + '">' + district + '</td>'+
			'   <td id="Barangay_city_' + id + '">' + city + '</td>'+
			'	<td class = "hidden" id="Barangay_men_' + id + '">' + men + '</td>'+
			'	<td class = "hidden" id="Barangay_women_' + id + '">' + women + '</td>'+
			'	<td class = "hidden" id="Barangay_population_' + id + '">' + population + '</td>'+
			'	<td class = "hidden" id="Barangay_minors_' + id + '">' + minors + '</td>'+
			'	<td class = "hidden" id="Barangay_adults_' + id + '">' + adults + '</td>'+
			'	<td class = "hidden" id="Barangay_pwd_' + id + '">' + pwd + '</td>'+
			'	<td class = "hidden" id="Barangay_t_houses_' + id + '">' + t_houses + '</td>'+
			'	<td class = "hidden" id="Barangay_c_houses_' + id + '">' + c_houses + '</td>'+
			'	<td class = "hidden" id="Barangay_l_houses_' + id + '">' + l_houses + '</td>'+
			'	<td class = "hidden" id="Barangay_cl_houses_' + id + '">' + cl_houses + '</td>'+ 			
			'   <td id="Barangay_area_' + id + '" value="' + id + '">' + area +'</td>'+
			'   <td><div class="btn-group"><button id="Barangay_BTN_' + id + '" value="' + id + '" class="btn btn-default" data-toggle="modal" data-target="#ViewBarangayModal" onclick="viewChart(\'' + id + '\')"><span class="glyphicon glyphicon-eye-open"></span>&nbspView</button><input type="hidden" class="btn" /></div></td>'+
			'   <td><div class="btn-group"><button id="Barangay_BTN_' + id + '" value="' + id + '" class="btn btn-default" data-toggle="modal" data-target="#UpdateBarangayModal" onclick="UpdateFill(\'' + id + '\')"><span class="glyphicon glyphicon-pencil"></span>&nbspEdit</button><input type="hidden" class="btn" /></div>'+
			'   <div class="btn-group"><input type="hidden" class="btn" /><button id="Barangay_BTN_' + id + '2" value="' + id + '" class="btn btn-default" data-toggle="modal" data-target="#UpdateBarangayModal2" onclick="UpdateFill2(\'' + id + '\')"><span class="glyphicon glyphicon-list-alt"></span>&nbspUpdate Info</button><input type="hidden" class="btn" /></div>'+
			'  	<form style="margin:0px" class="btn-group" id="UpdateBarangayMapForm" method="post" action="#"><input type="hidden" class="btn" name="BARANGAY" value="'+id+'" /><button type="submit" value="'+id+'" id="UpdateBarangayMapForm_SUBMIT" class="btn btn-default"><span class="glyphicon glyphicon-map-marker"></span>&nbspUpdate Map</button></form></td>'+
            '</tr>';
    }

	
		
	//Fill disaster type table
	<?php
	$list_sql='SELECT 
	barangay.ID, 
	barangay.NAME,
	district.NAME AS DISTRICT, 
	city.NAME AS CITY, 
	barangay_info.MEN AS MEN, 
	barangay_info.WOMEN AS WOMEN,
	barangay_info.AREA AS AREA,
	barangay_info.MINORS AS MINORS,
	barangay_info.ADULTS AS ADULTS,
	barangay_info.PWD AS PWD,
	barangay_info.T_HOUSES AS T_HOUSES,
	barangay_info.C_HOUSES AS C_HOUSES,
	barangay_info.L_HOUSES AS L_HOUSES,
	barangay_info.CL_HOUSES AS CL_HOUSES
	FROM (SELECT * FROM barangay WHERE barangay.NAME LIKE "%'.$search.'%") AS barangay
	LEFT JOIN barangay_info ON barangay_info.BARANGAY = barangay.ID
	LEFT JOIN district ON barangay.DISTRICT = district.ID 
	LEFT JOIN city ON district.CITY = city.ID
	GROUP BY barangay.ID
	ORDER BY barangay.NAME
	LIMIT '.$limit.' OFFSET '.$offset;
	
	$list_result = $db->connection->query($list_sql);
	$list_count = mysqli_num_rows($list_result);
	
	if($list_count < 1) {
		echo 'createmessage(4, "No results found.", false);';
	}
	else {
		while ($list_row = $list_result->fetch_assoc()) {
			$result_ID = htmlspecialchars($list_row['ID']);
			$result_NAME = htmlspecialchars($list_row['NAME']);
			$result_DISTRICT = htmlspecialchars($list_row['DISTRICT']);
			$result_CITY = htmlspecialchars($list_row['CITY']);
			$result_MEN = htmlspecialchars($list_row['MEN']);
			$result_WOMEN = htmlspecialchars($list_row['WOMEN']);
			$result_POPULATION = $result_MEN + $result_WOMEN;
			$result_AREA = htmlspecialchars($list_row['AREA']);
			$result_MINORS = htmlspecialchars($list_row['MINORS']);
			$result_ADULTS = htmlspecialchars($list_row['ADULTS']);
			$result_PWD = htmlspecialchars($list_row['PWD']);
			$result_T_HOUSES = htmlspecialchars($list_row['T_HOUSES']);
			$result_C_HOUSES = htmlspecialchars($list_row['C_HOUSES']);
			$result_L_HOUSES = htmlspecialchars($list_row['L_HOUSES']);
			$result_CL_HOUSES = htmlspecialchars($list_row['CL_HOUSES']);
	?>
	AddBarangay(<?php echo $result_ID; ?>, '<?php echo $result_NAME; ?>', '<?php echo $result_DISTRICT; ?>', '<?php echo $result_CITY; ?>', '<?php echo $result_MEN; ?>', '<?php echo $result_WOMEN; ?>', '<?php echo $result_POPULATION; ?>', '<?php echo $result_MINORS; ?>', '<?php echo $result_ADULTS; ?>', '<?php echo $result_PWD; ?>', '<?php echo $result_T_HOUSES; ?>', '<?php echo $result_C_HOUSES; ?>', '<?php echo $result_L_HOUSES; ?>', '<?php echo $result_CL_HOUSES; ?>', <?php echo $result_AREA; ?>);
	<?php
		}
	}
	?>
</script>



<!-- UPDATE BARANGAY -->

<script>

	var UBForm = {
        form: document.getElementById('UpdateBarangayForm'),
		id: document.getElementById('UpdateBarangayForm_ID'),
		name: document.getElementById('UpdateBarangayForm_NAME'),
		district: document.getElementById('UpdateBarangayForm_DISTRICT'),
        submit : '#UpdateBarangayForm_SUBMIT',
        modal: '#UpdateBarangayModal',
        msgbox: 'UB_msgbox'
    };

	var UBForm2 = {
		form: document.getElementById('UpdateBarangayForm2'),
		id: document.getElementById('UpdateBarangayForm2_ID'),
		men: document.getElementById('UpdateBarangayForm_MEN'),
		women: document.getElementById('UpdateBarangayForm_WOMEN'),
		minors: document.getElementById('UpdateBarangayForm_MINORS'),
		adults: document.getElementById('UpdateBarangayForm_ADULTS'),
		pwd: document.getElementById('UpdateBarangayForm_PWD'),
		light: document.getElementById('UpdateBarangayForm_LIGHT'),
		concrete: document.getElementById('UpdateBarangayForm_CONCRETE'),
		both: document.getElementById('UpdateBarangayForm_BOTH'),
		area: document.getElementById('UpdateBarangayForm_AREA'),
		infoBtn: document.getElementById('UpdateBarangayForm_INFO'),
		submit : '#UpdateBarangayForm_SUBMIT2',
        modal: '#UpdateBarangayModal2',
        msgbox: 'UB_msgbox2'
	};


	function UpdateBarangay(id, name, district) {
		document.getElementById('Barangay_name_' + id).innerHTML = name;
		document.getElementById('Barangay_district_' + id).innerHTML = district;
	}

	function UpdateBarangay2(id, area)
	{
		document.getElementById('Barangay_area_'+id).innerHTML = area;
	}

	//Fills forms when edit buttons are clicked
	function UpdateFill(id) {
		var name = document.getElementById('Barangay_name_' + id).innerHTML;
		var district = document.getElementById('Barangay_district_' + id).innerHTML;
		for(var i = 0; i < UBForm.district.options.length; i++) {
			if(UBForm.district.options[i].text == district) {
				UBForm.district.selectedIndex = i;
			}
		}
		UBForm.name.value = name;
		UBForm.id.value = id;
	}


	// UBFORM2 HERE

	// Fills Form of UBPForm2. notice area2 
	function UpdateFill2(id) {
		var currentBarangay = document.getElementById('Barangay_name_' + id).innerHTML;
		var currentDistrict = document.getElementById('Barangay_district_' + id).innerHTML;
		var currentCity = document.getElementById('Barangay_city_' + id).innerHTML;
		var currentMen = document.getElementById('Barangay_men_' + id).innerHTML;
		var currentWomen = document.getElementById('Barangay_women_' + id).innerHTML;
		var currentArea = document.getElementById('Barangay_area_' + id).innerHTML;
		var currentPopulation = document.getElementById('Barangay_population_' + id).innerHTML;
		var currentMinors = document.getElementById('Barangay_minors_' + id).innerHTML;
		var currentAdults = document.getElementById('Barangay_adults_' + id).innerHTML;
		var currentPWD = document.getElementById('Barangay_pwd_' + id).innerHTML;
		var currentT_houses = document.getElementById('Barangay_t_houses_' + id).innerHTML;
		var currentC_houses = document.getElementById('Barangay_c_houses_' + id).innerHTML;
		var currentL_houses = document.getElementById('Barangay_l_houses_' + id).innerHTML;
		var currentCL_houses = document.getElementById('Barangay_cl_houses_' + id).innerHTML;

		UBForm2.id.value = id;
		UBForm2.men.value = currentMen;
		UBForm2.women.value = currentWomen;
		UBForm2.minors.value = currentMinors;
		UBForm2.adults.value = currentAdults;
		UBForm2.pwd.value = currentPWD;
		UBForm2.light.value = currentL_houses;
		UBForm2.concrete.value = currentC_houses;
		UBForm2.both.value = currentCL_houses;
		UBForm2.area.value = currentArea;
	}



		//Async Update Barangay Submit 
	UBForm.form.onsubmit = function(e) {
		e.preventDefault();
		
		$(this).ajaxSubmit({
			beforeSend:function()
			{
				$(UBForm.submit).button('loading');
			},
			uploadProgress:function(event,position,total,percentCompelete)
			{

			},
			success:function(data)
			{
				$(UBForm.submit).button('reset');
				var server_message = data.trim();
				
				if(!isWhitespace(GetSuccessMsg(server_message)))
				{
					createmessagein(1, 'Successfully updated barangay!', UBForm.msgbox);
					
					UpdateBarangay(GetSuccessMsg(server_message), UBForm.name.value, UBForm.district.options[UBForm.district.selectedIndex].text);
				}
				else if(!isWhitespace(GetWarningMsg(server_message)))
				{
					createmessagein(2, GetWarningMsg(server_message), UBForm.msgbox);
				}
				else if(!isWhitespace(GetErrorMsg(server_message)))
				{
					createmessagein(3, GetErrorMsg(server_message), UBForm.msgbox);
				}
				else if(!isWhitespace(GetServerMsg(server_message)))
				{
					createmessagein(4, GetServerMsg(server_message), UBForm.msgbox);
				}
				else
				{
					createmessagein(3, '<b>Oh Snap!</b> There is a problem with the server or your connection.', UBForm.msgbox);
				}
			}
		});
	};

		//Async Update Barangay 2 Submit 
	UBForm2.form.onsubmit = function(e) {
		e.preventDefault();
		
		$(this).ajaxSubmit({
			beforeSend:function()
			{
				$(UBForm2.submit).button('loading');
			},
			uploadProgress:function(event,position,total,percentCompelete)
			{

			},
			success:function(data)
			{
				$(UBForm2.submit).button('reset');
				var server_message = data.trim();
				
				if(!isWhitespace(GetSuccessMsg(server_message)))
				{
					createmessagein(1, 'Successfully updated barangay info!', UBForm2.msgbox);
				
					UpdateBarangay2(GetSuccessMsg(server_message), UBForm2.area.value);
				}
				else if(!isWhitespace(GetWarningMsg(server_message)))
				{
					createmessagein(2, GetWarningMsg(server_message), UBForm2.msgbox);
				}
				else if(!isWhitespace(GetErrorMsg(server_message)))
				{
					createmessagein(3, GetErrorMsg(server_message), UBForm2.msgbox);
				}
				else if(!isWhitespace(GetServerMsg(server_message)))
				{
					createmessagein(4, GetServerMsg(server_message), UBForm2.msgbox);
				}
				else
				{
					createmessagein(3, '<b>Oh Snap!</b> There is a problem with the server or your connection.', UBForm2.msgbox);
				}
			}
		});
	};


</script>



	function AddBarangay(id, name, district, city, population, minors, adults, pwd, t_houses, c_houses, l_houses, 

<!-- OVERVIEW BARANGAY AND CHART -->
<script>


function viewChart(id) {

		var currentBarangay = document.getElementById('Barangay_name_' + id).innerHTML;
		var currentDistrict = document.getElementById('Barangay_district_' + id).innerHTML;
		var currentCity = document.getElementById('Barangay_city_' + id).innerHTML;
		var currentMen = document.getElementById('Barangay_men_' + id).innerHTML;
		var currentWomen = document.getElementById('Barangay_women_' + id).innerHTML;
		var currentArea = document.getElementById('Barangay_area_' + id).innerHTML;
		var currentPopulation = document.getElementById('Barangay_population_' + id).innerHTML;
		var currentMinors = document.getElementById('Barangay_minors_' + id).innerHTML;
		var currentAdults = document.getElementById('Barangay_adults_' + id).innerHTML;
		var currentPWD = document.getElementById('Barangay_pwd_' + id).innerHTML;
		var currentT_houses = document.getElementById('Barangay_t_houses_' + id).innerHTML;
		var currentC_houses = document.getElementById('Barangay_c_houses_' + id).innerHTML;
		var currentL_houses = document.getElementById('Barangay_l_houses_' + id).innerHTML;
		var currentCL_houses = document.getElementById('Barangay_cl_houses_' + id).innerHTML;



		document.getElementById("viewModalBrgy").innerHTML = currentBarangay + ', <small>' + currentDistrict+' '+currentCity+'</small>';
		document.getElementById("viewModalArea").innerHTML = currentArea;		
		document.getElementById("viewModalPopulation").innerHTML = 'Total Population: '+currentPopulation;		
		document.getElementById("viewModalPWD").innerHTML = 'Persons With Disabilities: '+ currentPWD;		
		document.getElementById("viewModalHouseTotal").innerHTML = 'Total Houses: '+ currentT_houses;		

		chartResponse(currentMen, currentWomen, currentMinors, currentAdults, currentT_houses, currentC_houses, currentL_houses, currentCL_houses);
}


// PROBABLY MUST BE EVENT 

function chartResponse(men,women,minors,adults,thouse,chouse,lhouse,clhouse)
{
		var ctx = document.getElementById("cassualtiesChart");
		var myChart = new Chart(ctx, {
		    type: 'pie',
		    data: {
		        labels: ["Men", "Women"],
		        datasets: [{
		            label: 'Gender',
		            data: [men,women],
		            backgroundColor: [
		            'rgba(237,153,91,0.8)',
		            'rgba(245,79,85,0.8)'
		           ],
		            borderColor: [
		            'rgba(237,153,91,1)',
		            'rgba(245,79,85,1)',
		            ],
		            borderWidth: 1
		        }]
		    },
		    options: {
		                animation:{
		                    animateScale:true
		                }
		            }
		});


	
		var ctx = document.getElementById("houseType");
		var myChart = new Chart(ctx, {
		    type: 'pie',
		    data: {
		        labels: ["Light", "Concrete", "Both"],
		        datasets: [{
		            label: 'House Type',
		            data: [lhouse, chouse,clhouse],
		            backgroundColor: [
		                'rgba(203,80,80,0.8)',
			            'rgba(237,153,91,0.8)',
			            'rgba(245,79,85,0.8)'
		  ],
		            borderColor: [
		                'rgba(203,80,80,1)',
			            'rgba(237,153,91,1)',
			            'rgba(245,79,85,1)'
			
			  ],
		            borderWidth: 1
		        }]
		    },
		    options: {
		                animation:{
		                    animateScale:true
		                }
		            }
		});

		var ctx = document.getElementById("ageDifference");
		var myChart = new Chart(ctx, {
		    type: 'pie',
		    data: {
		        labels: ["Minor", "Adults"],
		        datasets: [{
		            label: 'Age Difference',
		            data: [minors,adults],
		            backgroundColor: [
		                'rgba(203,80,80,0.8)',
			            'rgba(237,153,91,0.8)'

		     ],
		            borderColor: [
		                'rgba(203,80,80,1)',
			            'rgba(237,153,91,1)'

		            ],
		            borderWidth: 1
		        }]
		    },
		    options: {
		                animation:{
		                    animateScale:true
		                }
		            }
		});

	}




</script>

</body>
</html>


********************************************************

<?php
session_start();
include ('library/form/CdrrmoOnly.php');
include('library/form/connection.php');
include('library/function/functions.php');
$db = new db();

$search = isset($_GET['search']) ? $_GET['search'] : '';
$limit = 10;

$total_sql = 'SELECT 
barangay.ID, 
barangay.NAME,
district.NAME AS DISTRICT, 
city.NAME AS CITY, 
barangay_info.MEN AS MEN, 
barangay_info.WOMEN AS WOMEN
FROM (SELECT * FROM barangay WHERE barangay.NAME LIKE "%'.$search.'%") AS barangay
LEFT JOIN district ON barangay.DISTRICT = district.ID
LEFT JOIN city ON district.CITY = city.ID
LEFT JOIN barangay_info ON barangay.ID = barangay_info.BARANGAY
GROUP BY barangay.ID';

$total_result = $db->connection->query($total_sql);
$total_count = mysqli_num_rows($total_result);
$total_page = ceil($total_count/$limit);

$page = isset($_GET['page']) && $_GET['page'] > 0 && $_GET['page'] <= $total_page ? $_GET['page'] : '1';
$offset = ($page * $limit) - $limit;

if($page < 2) {
	$disable_previous = 'disabled';
	$disable_previous2 = 'pointer-events: none;';
	$bottom_page = 'display:none';
}
else {
	$disable_previous = '';
	$disable_previous2 = '';
	$bottom_page = '';
}
if($total_page < 2) {
	$top_page = 'display:none';
}
else {
	$top_page = '';
}
if($total_page == $page || $total_page < 1) {
	$disable_next = 'disabled';
	$disable_next2 = 'pointer-events: none;';
	$top_page = 'display:none';
}
else {
	$disable_next = '';
	$disable_next2 = '';
	$top_page = '';
}
?>

<html lang="en">
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="th3515">
    <meta name="author" content="@pablongbuhaymo">

    <title>Manage Barangays | City Disaster Risk Management</title>    
    <link rel="icon" href="img/favicon.ico">

    <!-- Bootstrap Core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="css/app.css" rel="stylesheet">

   <link rel="stylesheet" href="https://unpkg.com/leaflet@1.0.3/dist/leaflet.css"
    integrity="sha512-07I2e+7D8p6he1SIM+1twR5TIrhUQn9+I6yjqD53JQjFiMf8EtC93ty0/5vJTZGF8aAocvHYNEDJajGdNx1IsQ=="
   crossorigin=""/>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>
<body role="document">

<!-- Modals -->

<!-- Add Barangay Modal -->
<div class="modal fade" id="AddBarangayModal" tabindex="-1" role="dialog">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
				<h4 class="modal-title">Add New Barangay</h4>
			</div>
			
			<!-- Add Barangay Form -->
			<form id="AddBarangayForm" method="post" action="library/form/AddBarangayForm.php">
				<div class="modal-body">
					<div id="AB_msgbox" tabindex="0"></div>
					
					<!-- MAP SOON HERE-->
					
					
					<!-- Infomation -->
					<div class="panel panel-default">
						<div class="panel-heading">Information</div>
						<div class="panel-body">
						
							<!-- Name -->
							<div class="input-group">
								<span class="input-group-addon" id="sizing-addon1">Name: </span>
								<input type="text" id="AddBarangayForm_NAME" name="NAME" maxlength="50" class="form-control" required />
							</div>
							<br />
							
							<!-- District -->
							<div class="input-group">
								<span class="input-group-addon" id="sizing-addon1">District: </span>
								<select class="form-control" id="AddBarangayForm_DISTRICT" name="DISTRICT">
									<?php
									$district_sql = "SELECT * FROM district ORDER BY NAME";
									$district_result = $db->connection->query($district_sql);
									while($district_row = $district_result->fetch_assoc()) {
										?>
										<option value="<?php echo $district_row["ID"]; ?>" id="add_district_<?php echo $district_row["ID"]; ?>"><?php echo $district_row["NAME"]; ?></option>
										<?php
									}
									?>
								</select>
							</div>
							<br />
							
						</div>
					</div>
					
					<!-- Population -->
					<div class="panel panel-default">
						<div class="panel-heading">Details</div>
						<div class="panel-body">
						
							<!-- Men -->
							<div class="input-group">
								<span class="input-group-addon" id="sizing-addon1">Men: </span>
								<input type="number" id="AddBarangayForm_MEN" name="MEN" value=0 maxlength="5" class="form-control" />
							</div>
							<br />
							
							<!-- Women -->
							<div class="input-group">
								<span class="input-group-addon" id="sizing-addon1">Women: </span>
								<input type="number" id="AddBarangayForm_WOMEN" name="WOMEN" value=0 maxlength="5" class="form-control" />
							</div>
							<br />
							
							<!-- Minors -->
							<div class="input-group">
								<span class="input-group-addon" id="sizing-addon1">Minors: </span>
								<input type="number" id="AddBarangayForm_MINORS" name="MINORS" value=0 maxlength="5" class="form-control" />
							</div>
							<br />
							
							<!-- Adults -->
							<div class="input-group">
								<span class="input-group-addon" id="sizing-addon1">Adults: </span>
								<input type="number" id="AddBarangayForm_ADULTS" name="ADULTS" value=0 maxlength="5" class="form-control" />
							</div>
							<br />
						
							<!-- PWD -->
							<div class="input-group">
								<span class="input-group-addon" id="sizing-addon1">PWDs: </span>
								<input type="number" id="AddBarangayForm_PWD" name="PWD" value=0 maxlength="5" class="form-control" />
							</div>
							<br />

							<!-- Concrete Houses -->
							<div class="input-group">
								<span class="input-group-addon" id="sizing-addon1">Concrete: </span>
								<input type="number" id="AddBarangayForm_CONCRETE" name="CONCRETE" value=0 maxlength="5" class="form-control" />
							</div>
							<br />

							<!-- Light Houses -->
							<div class="input-group">
								<span class="input-group-addon" id="sizing-addon1">Light: </span>
								<input type="number" id="AddBarangayForm_LIGHT" name="LIGHT" value=0 maxlength="5" class="form-control" />
							</div>
							<br />

							<!-- Both Houses -->
							<div class="input-group">
								<span class="input-group-addon" id="sizing-addon1">Both: </span>
								<input type="number" id="AddBarangayForm_BOTH" name="BOTH" value=0 maxlength="5" class="form-control" />
							</div>
							<br />

							<!-- Area -->
							<div class="input-group">
								<span class="input-group-addon" id="sizing-addon1">Area: </span>
								<input type="number" id="AddBarangayForm_AREA" name="AREA" value=0 maxlength="5" step="0.01" class="form-control" />
							</div>
							<br />

						</div>
					</div>
					
				</div>
				
				<!-- Submission -->
				<div class="modal-footer">
					<button type="submit" id="AddBarangayForm_SUBMIT" data-loading-text="Adding Barangay..." class="btn btn-primary">Add Barangay</button>
					<button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
				</div>
				
			</form>
			
		</div>
	</div>
</div>

<!-- Update Barrangay Modal -->
<div class="modal fade" id="UpdateBarangayModal" tabindex="-1" role="dialog">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
				<h4 class="modal-title">Update Barangay</h4>
			</div>

			<!-- Update Barangay Form -->
			<form id="UpdateBarangayForm" method="post" action="library/form/UpdateBarangayForm.php">
				<div class="modal-body">
					<div id="UB_msgbox" tabindex="0"></div>
					
					<input type="hidden" id="UpdateBarangayForm_ID" name="ID" required />
					<!-- Infomation -->
					<div class="panel panel-default">
						<div class="panel-heading">Information</div>
						<div class="panel-body">
						
							<!-- Name -->
							<div class="input-group">
								<span class="input-group-addon" id="sizing-addon1">Name: </span>
								<input type="text" id="UpdateBarangayForm_NAME" name="NAME" maxlength="50" class="form-control" required />
							</div>
							<br />
							
							<!-- District -->
							<div class="input-group">
								<span class="input-group-addon" id="sizing-addon1">District: </span>
								<select class="form-control" id="UpdateBarangayForm_DISTRICT" name="DISTRICT">
									<?php
									$district_sql = "SELECT * FROM district ORDER BY NAME";
									$district_result = $db->connection->query($district_sql);
									while($district_row = $district_result->fetch_assoc()) {
										?>
										<option value="<?php echo $district_row["ID"]; ?>" id="add_district_<?php echo $district_row["ID"]; ?>"><?php echo $district_row["NAME"]; ?></option>
										<?php
									}
									?>
								</select>
							</div>
							<br />
						</div>
					</div>
						
				</div>
					
				<!-- Submission -->
				<div class="modal-footer">
					<button type="submit" id="UpdateBarangayForm_SUBMIT" data-loading-text="Updating Barangay..." class="btn btn-primary">Update Barangay</button>
					<button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
				</div>
			</form>
		</div>
	</div>
</div>

<!-- Update Barrangay Info Modal -->
<div class="modal fade" id="UpdateBarangayModal2" tabindex="-1" role="dialog">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
				<h4 class="modal-title">Update Barangay Information</h4>
			</div>
				
			<!-- Update Barangay Form 2-->
			<form id="UpdateBarangayForm2" method="post" action="library/form/UpdateBarangayForm2.php">
				<div class="modal-body">
					<div id="UB_msgbox2" tabindex="0"></div>
					
					<!-- ID -->
					<input type="hidden" id="UpdateBarangayForm2_ID" name="ID" required />					
					
					<!-- Men -->
					<div class="input-group">
						<span class="input-group-addon" id="sizing-addon1">Men: </span>
						<input type="number" id="UpdateBarangayForm_MEN" name="MEN" value=0 maxlength="5" class="form-control" />
					</div>
					<br />
					
					<!-- Women -->
					<div class="input-group">
						<span class="input-group-addon" id="sizing-addon1">Women: </span>
						<input type="number" id="UpdateBarangayForm_WOMEN" name="WOMEN" value=0 maxlength="5" class="form-control" />
					</div>
					<br />
					
					<!-- Minors -->
					<div class="input-group">
						<span class="input-group-addon" id="sizing-addon1">Minors: </span>
						<input type="number" id="UpdateBarangayForm_MINORS" name="MINORS" value=0 maxlength="5" class="form-control" />
					</div>
					<br />
					
					<!-- Adults -->
					<div class="input-group">
						<span class="input-group-addon" id="sizing-addon1">Adults: </span>
						<input type="number" id="UpdateBarangayForm_ADULTS" name="ADULTS" value=0 maxlength="5" class="form-control" />
					</div>
					<br />
				
					<!-- PWD -->
					<div class="input-group">
						<span class="input-group-addon" id="sizing-addon1">PWDs: </span>
						<input type="number" id="UpdateBarangayForm_PWD" name="PWD" value=0 maxlength="5" class="form-control" />
					</div>
					<br />
							
					<!-- Concrete Houses -->
					<div class="input-group">
						<span class="input-group-addon" id="sizing-addon1">Concrete: </span>
						<input type="number" id="UpdateBarangayForm_CONCRETE" name="CONCRETE" value=0 maxlength="5" class="form-control" />
					</div>
					<br />

					<!-- Light Houses -->
					<div class="input-group">
						<span class="input-group-addon" id="sizing-addon1">Light: </span>
						<input type="number" id="UpdateBarangayForm_LIGHT" name="LIGHT" value=0 maxlength="5" class="form-control" />
					</div>
					<br />

					<!-- Both Houses -->
					<div class="input-group">
						<span class="input-group-addon" id="sizing-addon1">Both: </span>
						<input type="number" id="UpdateBarangayForm_BOTH" name="BOTH" value=0 maxlength="5" class="form-control" />
					</div>
					<br />

					<!-- Area -->
					<div class="input-group">
						<span class="input-group-addon" id="sizing-addon1">Area: </span>
						<input type="number" id="UpdateBarangayForm_AREA" name="AREA" value=0 maxlength="5" step="0.01" class="form-control" />
					</div>
					<br />
				</div>
				
				<!-- Submission -->
				<div class="modal-footer">
					<button type="submit" id="UpdateBarangayForm_SUBMIT2" data-loading-text="Updating Barangay..." class="btn btn-primary">Update Barangay</button>
					<button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
				</div>
			
			</form>
		</div>
	</div>
</div>

<!-- View Barrangay Info Modal -->
<div class="modal fade" id="ViewBarangayModal" tabindex="-1" role="dialog">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
				<h4 class="modal-title">Barangay Information Overview</h4>
			</div>
				
			<!-- View Barangay Modal-->
			<div class="modal-body">
				<div id="UB_msgbox2" tabindex="0"></div>
					
					<!-- ID -->
					<input type="hidden" id="UpdateBarangayForm2_ID" name="ID" required />					
					<h1 class = "text-center" id = "viewModalBrgy"></h1>
					<h5 class = "text-center greyFont" style = "font-size:18px;" id = "viewModalArea"></h5>	
					<br />

						<span class = "col-lg-4">
						<h4> Gender</h4><hr>
					   <canvas id="cassualtiesChart" width="50" height="100%"></canvas>
						<hr>
						</span>					
											
						<span class = "col-lg-4">
							<h4> Age Group</h4><hr>
					   <canvas id="ageDifference" width="50" height="100%"></canvas>
						<hr>
						</span>					
											
						<span class = "col-lg-4">
						<h4> House Type </h4><hr>
					   <canvas id="houseType" width="50" height="100%"></canvas>
						<hr>
						</span>					
											

				</div>
				
				<!-- Submission -->
				<div class="modal-footer">
					<a href="overview.php" class="btn btn-success">Location</a>
					<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
				</div>
			
			</form>
		</div>
	</div>
</div>



<!-- Content starts here -->
<?php include('library/html/navbar.php'); ?>

<div class="container">
    <div class="page-header">
		<button class="btn btn-secondary pull-right" data-toggle="modal" data-target="#AddBarangayModal">
			<span class="glyphicon glyphicon-plus"></span> Add New Barangay
		</button>
        <h3>Barangay Management</h3>
    </div>
	
	<!-- Barangay Search Bar -->
	<div class="row">
		<div class="col-md-6 col-md-offset-3">
			<form id="SearchForm" method="get">
				<div class="input-group">
					<input id="SearchInput" name="search" type="text" class="form-control" placeholder="Search.." value="<?php echo $search; ?>" />
					<span class="input-group-btn">
						<button id="SearchSubmit" class="btn btn-secondary" type="submit"><span class="glyphicon glyphicon-search"></span>&nbsp Search</button>
					</span>
				</div>
			</form>
		</div>
	</div>
	
	<!-- Barangay List -->
	<table class="table table-striped table-hover">
		<thead>
		<tr>
			<th>Name</th>
			<th>District</th>
			<th>City</th>
			<th>Area</th>
			<th>Overview</th>
			<th>Actions</th>
		</tr>
		</thead>
		<tbody id="PageComponent_BRLIST">
		</tbody>
	</table>
	<div id="pagemessagebox" tabindex="0"></div>
	
	<!-- Pagination -->
	<ul class="pager">
		<li style="<?php echo $bottom_page; ?>">
			<a href="BarangayManagement.php?search=<?php echo $search; ?>&page=1" style=""><span class="glyphicon glyphicon-menu-left"></span>&nbsp 1</a>
		</li>
		<li class="<?php echo $disable_previous; ?>">
			<a href="BarangayManagement.php?search=<?php echo $search; ?>&page=<?php echo $page - 1; ?>" style="<?php echo $disable_previous2; ?>"><span class="glyphicon glyphicon-menu-left"></span>&nbsp Previous</a>
		</li>
		<li class="disabled">
			<span><h4 style="margin-top: 0.3rem; margin-bottom: 0.3rem;">Page <?php echo $page; ?></h4></span>
		</li>
		<li class="<?php echo $disable_next; ?>">
			<a href="BarangayManagement.php?search=<?php echo $search; ?>&page=<?php echo $page + 1; ?>" style="<?php echo $disable_next2; ?>">Next&nbsp <span class="glyphicon glyphicon-menu-right"></span></a>
		</li>
		<li style="<?php echo $top_page; ?>">
			<a href="BarangayManagement.php?search=<?php echo $search; ?>&page=<?php echo $total_page; ?>" style=""><?php echo $total_page; ?>&nbsp <span class="glyphicon glyphicon-menu-right"></span></a>
		</li>
	</ul>
</div>


<?php include('library/html/footer.php'); ?>

<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
<script src="js/1.11.3_jquery.min.js"></script>
<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="js/bootstrap.min.js"></script>
<script src="js/app/mylibrary.js"></script>
<script src="js/app/messagealert.js"></script>
<script src="js/jquery.datetimepicker.full.min.js"></script>
<script src="js/jquery.form.min.js"></script>
<script src="js/chart.bundle.min.js"></script>


<!-- Page Script -->
<script>
    var PageComponent = {
        brlist: document.getElementById('PageComponent_BRLIST')
    };
	
	var ABForm = { 
        form: document.getElementById('AddBarangayForm'),
		name: document.getElementById('AddBarangayForm_NAME'),
		district: document.getElementById('AddBarangayForm_DISTRICT'),
		men: document.getElementById('AddBarangayForm_MEN'),
		women: document.getElementById('AddBarangayForm_WOMEN'),
		minors: document.getElementById('AddBarangayForm_MINORS'),
		adults: document.getElementById('AddBarangayForm_ADULTS'),
		pwd: document.getElementById('AddBarangayForm_PWD'),
		light: document.getElementById('AddBarangayForm_LIGHT'),
		concrete: document.getElementById('AddBarangayForm_CONCRETE'),
		both: document.getElementById('AddBarangayForm_BOTH'),
		area: document.getElementById('AddBarangayForm_AREA'),
        submit : '#AddBarangayForm_SUBMIT',
        modal: '#AddBarangayModal',
        msgbox: 'AB_msgbox'
    };
		
	function ResetABForm() {
		ABForm.name.value = '';
		ABForm.district.selectedIndex = 0;
		ABForm.men.value = 0;
		ABForm.women.value = 0;
		ABForm.minors.value = 0;
		ABForm.adults.value = 0;
		ABForm.pwd.value = 0;
	}

	//Async New Barangay Submit 
	ABForm.form.onsubmit = function(e) {
		e.preventDefault();
		$(this).ajaxSubmit({
			beforeSend:function()
			{
				$(ABForm.submit).button('loading');
			},
			uploadProgress:function(event,position,total,percentCompelete)
			{

			},
			success:function(data)
			{
				$(ABForm.submit).button('reset');
				var server_message = data.trim();
				
				if(!isWhitespace(GetSuccessMsg(server_message)))
				{
					createmessagein(1, 'Successfully added barangay!', ABForm.msgbox);
					
					AddBarangay(server_message, ABForm.name.value, ABForm.district.options[ABForm.district.selectedIndex].text, 'Iloilo City', ABFORM.area);
					ResetABForm();
				}
				else if(!isWhitespace(GetWarningMsg(server_message)))
				{
					createmessagein(2, GetWarningMsg(server_message), ABForm.msgbox);
				}
				else if(!isWhitespace(GetErrorMsg(server_message)))
				{
					createmessagein(3, GetErrorMsg(server_message), ABForm.msgbox);
				}
				else if(!isWhitespace(GetServerMsg(server_message)))
				{
					createmessagein(4, GetServerMsg(server_message), ABForm.msgbox);
				}
				else
				{
					createmessagein(3, '<b>Oh Snap!</b> There is a problem with the server or your connection.', ABForm.msgbox);
				}
			}
		});
	};
	
	
	//Add barangay to list
	
	function AddBarangay(id, name, district, city, area) {
        PageComponent.brlist.innerHTML = PageComponent.brlist.innerHTML +
            '<tr>' +
            '   <td id="Barangay_name_' + id + '">' + name + '</td>'+
			'   <td id="Barangay_district_' + id + '">' + district + '</td>'+
			'   <td id="Barangay_city_' + id + '">' + city + '</td>'+
			'   <td id="Barangay_area_' + id + '">' + area + ' sqm</td>'+
			'   <td><div class="btn-group"><button id="Barangay_BTN_' + id + '" value="' + id + '" class="btn btn-default" data-toggle="modal" data-target="#ViewBarangayModal" onclick="viewChart(\'' + id + '\')"><span class="glyphicon glyphicon-eye-open"></span>&nbspView</button><input type="hidden" class="btn" /></div></td>'+
			'   <td><div class="btn-group"><button id="Barangay_BTN_' + id + '" value="' + id + '" class="btn btn-default" data-toggle="modal" data-target="#UpdateBarangayModal" onclick="UpdateFill(\'' + id + '\')"><span class="glyphicon glyphicon-pencil"></span>&nbspEdit</button><input type="hidden" class="btn" /></div>'+
			'   <div class="btn-group"><input type="hidden" class="btn" /><button id="Barangay_BTN_' + id + '2" value="' + id + '" class="btn btn-default" data-toggle="modal" data-target="#UpdateBarangayModal2" onclick="UpdateFill2(\'' + id + '\')"><span class="glyphicon glyphicon-list-alt"></span>&nbspUpdate Info</button><input type="hidden" class="btn" /></div>'+
			'  	<form style="margin:0px" class="btn-group" id="UpdateBarangayMapForm" method="post" action="#"><input type="hidden" class="btn" name="BARANGAY" value="'+id+'" /><button type="submit" value="'+id+'" id="UpdateBarangayMapForm_SUBMIT" class="btn btn-default"><span class="glyphicon glyphicon-map-marker"></span>&nbspUpdate Map</button></form></td>'+
            '</tr>';
    }
	
		
	//Fill disaster type table
	<?php
	$list_sql='SELECT 
	barangay.ID, 
	barangay.NAME,
	district.NAME AS DISTRICT, 
	city.NAME AS CITY, 
	barangay_info.MEN AS MEN, 
	barangay_info.WOMEN AS WOMEN,
	barangay_info.AREA AS AREA
	FROM (SELECT * FROM barangay WHERE barangay.NAME LIKE "%'.$search.'%") AS barangay
	LEFT JOIN barangay_info ON barangay_info.BARANGAY = barangay.ID
	LEFT JOIN district ON barangay.DISTRICT = district.ID 
	LEFT JOIN city ON district.CITY = city.ID
	GROUP BY barangay.ID
	ORDER BY barangay.NAME
	LIMIT '.$limit.' OFFSET '.$offset;
	
	$list_result = $db->connection->query($list_sql);
	$list_count = mysqli_num_rows($list_result);
	
	if($list_count < 1) {
		echo 'createmessage(4, "No results found.", false);';
	}
	else {
		while ($list_row = $list_result->fetch_assoc()) {
			$result_ID = htmlspecialchars($list_row['ID']);
			$result_NAME = htmlspecialchars($list_row['NAME']);
			$result_DISTRICT = htmlspecialchars($list_row['DISTRICT']);
			$result_CITY = htmlspecialchars($list_row['CITY']);
			$result_MEN = htmlspecialchars($list_row['MEN']);
			$result_WOMEN = htmlspecialchars($list_row['WOMEN']);
			$result_POPULATION = $result_MEN + $result_WOMEN;
			$result_AREA = htmlspecialchars($list_row['AREA']);
	?>
	AddBarangay(<?php echo $result_ID; ?>, '<?php echo $result_NAME; ?>', '<?php echo $result_DISTRICT; ?>', '<?php echo $result_CITY; ?>', <?php echo $result_AREA; ?>);
	<?php
		}
	}
	?>
</script>



<!-- UPDATE BARANGAY -->

<script>

	var UBForm = {
        form: document.getElementById('UpdateBarangayForm'),
		id: document.getElementById('UpdateBarangayForm_ID'),
		name: document.getElementById('UpdateBarangayForm_NAME'),
		district: document.getElementById('UpdateBarangayForm_DISTRICT'),
        submit : '#UpdateBarangayForm_SUBMIT',
        modal: '#UpdateBarangayModal',
        msgbox: 'UB_msgbox'
    };

	var UBForm2 = {
		form: document.getElementById('UpdateBarangayForm2'),
		id: document.getElementById('UpdateBarangayForm2_ID'),
		men: document.getElementById('UpdateBarangayForm_MEN'),
		women: document.getElementById('UpdateBarangayForm_WOMEN'),
		minors: document.getElementById('UpdateBarangayForm_MINORS'),
		adults: document.getElementById('UpdateBarangayForm_ADULTS'),
		pwd: document.getElementById('UpdateBarangayForm_PWD'),
		light: document.getElementById('UpdateBarangayForm_LIGHT'),
		concrete: document.getElementById('UpdateBarangayForm_CONCRETE'),
		both: document.getElementById('UpdateBarangayForm_BOTH'),
		area: document.getElementById('UpdateBarangayForm_AREA'),
		infoBtn: document.getElementById('UpdateBarangayForm_INFO'),
		submit : '#UpdateBarangayForm_SUBMIT2',
        modal: '#UpdateBarangayModal2',
        msgbox: 'UB_msgbox2'
	};


	function UpdateBarangay(id, name, district) {
		document.getElementById('Barangay_name_' + id).innerHTML = name;
		document.getElementById('Barangay_district_' + id).innerHTML = district;
	}

	//Fills forms when edit buttons are clicked
	function UpdateFill(id) {
		var name = document.getElementById('Barangay_name_' + id).innerHTML;
		var district = document.getElementById('Barangay_district_' + id).innerHTML;
		for(var i = 0; i < UBForm.district.options.length; i++) {
			if(UBForm.district.options[i].text == district) {
				UBForm.district.selectedIndex = i;
			}
		}
		UBForm.name.value = name;
		UBForm.id.value = id;
	}

		//Async Update Barangay Submit 
	UBForm.form.onsubmit = function(e) {
		e.preventDefault();
		
		$(this).ajaxSubmit({
			beforeSend:function()
			{
				$(UBForm.submit).button('loading');
			},
			uploadProgress:function(event,position,total,percentCompelete)
			{

			},
			success:function(data)
			{
				$(UBForm.submit).button('reset');
				var server_message = data.trim();
				
				if(!isWhitespace(GetSuccessMsg(server_message)))
				{
					createmessagein(1, 'Successfully updated barangay!', UBForm.msgbox);
					
					UpdateBarangay(GetSuccessMsg(server_message), UBForm.name.value, UBForm.district.options[UBForm.district.selectedIndex].text);
				}
				else if(!isWhitespace(GetWarningMsg(server_message)))
				{
					createmessagein(2, GetWarningMsg(server_message), UBForm.msgbox);
				}
				else if(!isWhitespace(GetErrorMsg(server_message)))
				{
					createmessagein(3, GetErrorMsg(server_message), UBForm.msgbox);
				}
				else if(!isWhitespace(GetServerMsg(server_message)))
				{
					createmessagein(4, GetServerMsg(server_message), UBForm.msgbox);
				}
				else
				{
					createmessagein(3, '<b>Oh Snap!</b> There is a problem with the server or your connection.', UBForm.msgbox);
				}
			}
		});
	};


</script>





<!-- OVERVIEW BARANGAY AND CHART -->
<script>

function viewChart(id) {
		var currentBarangay = document.getElementById('Barangay_name_' + id).innerHTML;
		var currentDistrict = document.getElementById('Barangay_district_' + id).innerHTML;
		var currentCity = document.getElementById('Barangay_city_' + id).innerHTML;
		var currentArea = document.getElementById('Barangay_area_' + id).innerHTML;
		document.getElementById("viewModalBrgy").innerHTML = currentBarangay + ', <small>' + currentDistrict+' '+currentCity+'</small>';
		document.getElementById("viewModalArea").innerHTML = currentArea;		
	}


var ctx = document.getElementById("cassualtiesChart");
var myChart = new Chart(ctx, {
    type: 'pie',
    data: {
        labels: ["Men", "Women"],
        datasets: [{
            label: 'Gender',
            data: [

                           <?php                   
                    // DISASTER CASSUALTIES

                    $sql ='SELECT MEN, WOMEN FROM barangay_info';

                    $result = $db->connection->query($sql);
                    $count = mysqli_num_rows($result);
                    $MENTOTAL = 0;
                    $WMNTOTAL = 0;

                    while($row = $result->fetch_assoc())
                    {
                        $MENTOTAL += $row['MEN'];
                        $WMNTOTAL += $row['WOMEN'];
                    }
                    ?>

                        '<?php echo($MENTOTAL); ?>','<?php echo($WMNTOTAL); ?>'],
            backgroundColor: [
            'rgba(237,153,91,0.8)',
            'rgba(245,79,85,0.8)'
           ],
            borderColor: [
            'rgba(237,153,91,1)',
            'rgba(245,79,85,1)',
            ],
            borderWidth: 1
        }]
    },
    options: {
                animation:{
                    animateScale:true
                }
            }
});



var ctx = document.getElementById("houseType");
var myChart = new Chart(ctx, {
    type: 'pie',
    data: {
        labels: ["Light", "Concrete", "Both"],
        datasets: [{
            label: 'House Type',
            data: [

                <?php                   
                    
                    $sql ='SELECT L_HOUSES, C_HOUSES, CL_HOUSES FROM barangay_info';

                    $result = $db->connection->query($sql);
                    $count = mysqli_num_rows($result);
                    $LHOUSETOTAL = 0;
                    $CHOUSETOTAL = 0;
                    $CLHOUSETOTAL = 0;
                    
                    while($row = $result->fetch_assoc())
                    {
                        $LHOUSETOTAL += $row['L_HOUSES'];
                        $CHOUSETOTAL += $row['C_HOUSES'];
             		    $CLHOUSETOTAL += $row['CL_HOUSES'];
                   
                    }
                    ?>

                        '<?php echo($LHOUSETOTAL); ?>','<?php echo($CHOUSETOTAL); ?>','<?php echo($CLHOUSETOTAL); ?>'

            ],
            backgroundColor: [
                'rgba(203,80,80,0.8)',
	            'rgba(237,153,91,0.8)',
	            'rgba(245,79,85,0.8)'
  ],
            borderColor: [
                'rgba(203,80,80,1)',
	            'rgba(237,153,91,1)',
	            'rgba(245,79,85,1)'
	
	  ],
            borderWidth: 1
        }]
    },
    options: {
                animation:{
                    animateScale:true
                }
            }
});

var ctx = document.getElementById("ageDifference");
var myChart = new Chart(ctx, {
    type: 'pie',
    data: {
        labels: ["Minor", "Adults"],
        datasets: [{
            label: 'Age Difference',
            data: [

                <?php                   
                    
                    $sql ='SELECT MINORS, ADULTS FROM barangay_info';

                    $result = $db->connection->query($sql);
                    $count = mysqli_num_rows($result);
                    $MINORSTOTAL = 0;
                    $ADULTSTOTAL = 0;
                    
                    while($row = $result->fetch_assoc())
                    {
                        $MINORSTOTAL += $row['MINORS'];
                        $ADULTSTOTAL += $row['ADULTS'];
                    }
                    ?>

                        '<?php echo($MINORSTOTAL); ?>','<?php echo($ADULTSTOTAL); ?>'

            ],
            backgroundColor: [
                'rgba(203,80,80,0.8)',
	            'rgba(237,153,91,0.8)'

     ],
            borderColor: [
                'rgba(203,80,80,1)',
	            'rgba(237,153,91,1)'

            ],
            borderWidth: 1
        }]
    },
    options: {
                animation:{
                    animateScale:true
                }
            }
});


</script>

</body>
</html>